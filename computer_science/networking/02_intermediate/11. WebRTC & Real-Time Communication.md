---
number: 11
title: "WebRTC & Real-Time Communication"
slug: "webrtc-real-time-communication"
level: "intermediate"
tags: ["networking", "webrtc", "real-time", "p2p", "video", "audio"]
prerequisites: ["network-security-advanced-firewalls-ids-ips"]
estimated_minutes: 130
contributors: []
diagrams: []
examples: []
canonical_id: "cs-net-11"
---

# WebRTC & Real-Time Communication

## Overview

WebRTC enables real-time peer-to-peer communication in web browsers. Understanding WebRTC architecture, signaling, NAT traversal (ICE/STUN/TURN), and media handling is essential for building real-time communication applications like video conferencing and voice calls.

## Table of Contents

1. [What is WebRTC?](#what-is-webrtc)
2. [WebRTC Architecture](#architecture)
3. [Signaling](#signaling)
4. [NAT Traversal - ICE/STUN/TURN](#nat-traversal)
5. [Media Capture](#media-capture)
6. [Peer Connection](#peer-connection)
7. [Data Channels](#data-channels)
8. [Real-World Applications](#applications)

## What is WebRTC?

### Definition

**WebRTC**: Web Real-Time Communication

**Purpose**: Enable real-time P2P communication

**Features**:
- **Audio/Video**: Real-time media
- **Data**: Data channels
- **P2P**: Peer-to-peer communication

**Use**: Video calls, voice calls, screen sharing

### WebRTC Benefits

**1. Browser Native**:
```
Built into browsers
No plugins needed
```

**2. P2P**:
```
Direct peer-to-peer connection
Low latency
```

**3. Standards-Based**:
```
Open standards
Interoperable
```

**4. Secure**:
```
Encrypted by default
```

## WebRTC Architecture

### Components

**1. Media Capture**:
```
Capture audio/video from devices
```

**2. Media Encoding**:
```
Encode media streams
```

**3. Peer Connection**:
```
Establish P2P connection
```

**4. Signaling**:
```
Exchange connection information
```

**5. NAT Traversal**:
```
Traverse NATs and firewalls
```

## Signaling

### What is Signaling?

**Signaling**: Exchange connection information

**Purpose**: Establish peer connection

**Information**:
- **SDP**: Session Description Protocol
- **ICE Candidates**: Network candidates

**Method**: Not part of WebRTC (use WebSocket, etc.)

### Signaling Process

**Process**:
```
1. Offerer creates offer (SDP)
2. Send offer to answerer
3. Answerer creates answer (SDP)
4. Send answer to offerer
5. Exchange ICE candidates
6. Establish connection
```

### SDP (Session Description Protocol)

**SDP**: Describes media session

**Information**:
- **Media Types**: Audio, video
- **Codecs**: Supported codecs
- **Network**: Network information

**Use**: Negotiate media capabilities

## NAT Traversal - ICE/STUN/TURN

### The NAT Problem

**Problem**: NATs prevent direct P2P

**Challenge**: Find direct path between peers

**Solution**: ICE (Interactive Connectivity Establishment)

### ICE Process

**ICE**: Find best path between peers

**Process**:
```
1. Gather candidates (host, server-reflexive, relayed)
2. Exchange candidates via signaling
3. Test connectivity
4. Select best candidate pair
5. Establish connection
```

### STUN (Session Traversal Utilities for NAT)

**STUN**: Discover public IP

**Purpose**: Get server-reflexive candidate

**Process**:
```
1. Send STUN request to STUN server
2. STUN server responds with public IP
3. Use as candidate
```

**Use**: Most connections

### TURN (Traversal Using Relays around NAT)

**TURN**: Relay server

**Purpose**: Relay traffic when direct connection fails

**Process**:
```
1. Connect to TURN server
2. Relay traffic through TURN server
3. Use as fallback
```

**Use**: When direct connection impossible

## Media Capture

### Media Capture API

**getUserMedia**: Capture media

**Example**:
```javascript
navigator.mediaDevices.getUserMedia({
    video: true,
    audio: true
}).then(stream => {
    // Use stream
});
```

**Capabilities**: 
- **Video**: Camera
- **Audio**: Microphone
- **Screen**: Screen sharing

### Media Streams

**MediaStream**: Represents media stream

**Tracks**: 
- **VideoTrack**: Video track
- **AudioTrack**: Audio track

**Use**: Add to peer connection

## Peer Connection

### RTCPeerConnection

**RTCPeerConnection**: Represents peer connection

**Process**:
```
1. Create RTCPeerConnection
2. Add media tracks
3. Create offer/answer
4. Set local/remote description
5. Add ICE candidates
6. Connection established
```

### Peer Connection Example

```javascript
const pc = new RTCPeerConnection({
    iceServers: [
        { urls: 'stun:stun.l.google.com:19302' },
        { urls: 'turn:turnserver.com', username: 'user', credential: 'pass' }
    ]
});

// Add local stream
stream.getTracks().forEach(track => {
    pc.addTrack(track, stream);
});

// Handle ICE candidates
pc.onicecandidate = event => {
    if (event.candidate) {
        // Send candidate to peer
    }
};

// Handle connection
pc.onconnectionstatechange = () => {
    console.log(pc.connectionState);
};
```

## Data Channels

### What are Data Channels?

**Data Channels**: Send arbitrary data

**Purpose**: P2P data communication

**Features**:
- **Reliable**: Reliable delivery
- **Ordered**: Ordered delivery
- **Low Latency**: Low latency

**Use**: File transfer, gaming, chat

### Data Channel Example

```javascript
const dc = pc.createDataChannel('chat');

dc.onopen = () => {
    console.log('Data channel open');
    dc.send('Hello!');
};

dc.onmessage = event => {
    console.log('Received:', event.data);
};
```

## Real-World Applications

### Application 1: Video Conferencing

**Use**: Zoom, Google Meet alternatives

**Features**: 
- **Video**: Multiple participants
- **Audio**: High-quality audio
- **Screen Sharing**: Share screen

**Benefit**: Browser-based, no installation

### Application 2: Voice Calls

**Use**: Voice communication

**Features**: 
- **Audio**: High-quality audio
- **Low Latency**: Real-time communication

**Benefit**: P2P, low latency

### Application 3: Screen Sharing

**Use**: Share screen

**Features**: 
- **Screen Capture**: Capture screen
- **Streaming**: Stream to peer

**Benefit**: Real-time screen sharing

## Common Pitfalls

### Problem: NAT Traversal Failures

```javascript
// BAD: No TURN server
// May fail behind restrictive NATs

// GOOD: Include TURN server
// Fallback for difficult NATs
```

### Problem: Signaling Issues

```javascript
// BAD: Unreliable signaling
// Connection may fail

// GOOD: Reliable signaling
// Use WebSocket with reconnection
```

## Quiz

1. What is WebRTC?
   - **A)** Web server
   - **B)** Web Real-Time Communication enabling P2P communication in browsers
   - **C)** Web framework
   - **D)** Web protocol

2. What is ICE?
   - **A)** Internet Connection
   - **B)** Interactive Connectivity Establishment - protocol for NAT traversal
   - **C)** Internet Control
   - **D)** Internet Communication

3. What is the purpose of TURN?
   - **A)** Turn around
   - **B)** Relay traffic when direct P2P connection fails
   - **C)** Turn off
   - **D)** Turn on

**Answers:**
1. **B** - WebRTC (Web Real-Time Communication) is a set of APIs and protocols that enable real-time peer-to-peer communication (audio, video, data) directly in web browsers without plugins
2. **B** - ICE (Interactive Connectivity Establishment) is a protocol that finds the best network path between peers by gathering candidates (host, server-reflexive via STUN, relayed via TURN) and testing connectivity
3. **B** - TURN (Traversal Using Relays around NAT) servers relay traffic between peers when direct peer-to-peer connections are impossible due to restrictive NATs or firewalls

## Next Steps

- [Network Function Virtualization](../networking/12.%20Network%20Function%20Virtualization.md) - NFV
- [Software-Defined Networking](../networking/13.%20Software-Defined%20Networking.md) - SDN

