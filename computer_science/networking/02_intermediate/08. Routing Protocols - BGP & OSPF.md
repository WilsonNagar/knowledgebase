---
number: 8
title: "Routing Protocols - BGP & OSPF"
slug: "routing-protocols-bgp-ospf"
level: "intermediate"
tags: ["networking", "routing", "bgp", "ospf", "internet", "protocols"]
prerequisites: ["load-balancing-high-availability"]
estimated_minutes: 120
contributors: []
diagrams: []
examples: []
canonical_id: "cs-net-08"
---

# Routing Protocols - BGP & OSPF

## Overview

Routing protocols determine how packets are forwarded through networks. Understanding OSPF for intra-domain routing and BGP for inter-domain routing is essential for understanding how the Internet works and how networks communicate.

## Table of Contents

1. [Routing Overview](#routing-overview)
2. [Routing Algorithms](#routing-algorithms)
3. [OSPF - Open Shortest Path First](#ospf)
4. [BGP - Border Gateway Protocol](#bgp)
5. [OSPF vs BGP](#comparison)
6. [Route Selection](#route-selection)
7. [Convergence](#convergence)
8. [Real-World Examples](#examples)

## Routing Overview

### What is Routing?

**Routing**: Process of selecting path for packets

**Router**: Device that forwards packets

**Routing Table**: Maps destinations to next hops

**Goal**: Find best path to destination

### Routing Types

**1. Static Routing**:
```
Manually configured routes
Simple, but doesn't adapt
```

**2. Dynamic Routing**:
```
Routes learned automatically
Adapts to changes
```

**3. Default Routing**:
```
Catch-all route
Used when no specific route
```

## Routing Algorithms

### Distance Vector

**Algorithm**: Bellman-Ford

**Process**:
```
1. Each router knows distance to neighbors
2. Exchange distance vectors
3. Update routing table
4. Repeat
```

**Example**: RIP (Routing Information Protocol)

**Problems**: Slow convergence, count-to-infinity

### Link State

**Algorithm**: Dijkstra's shortest path

**Process**:
```
1. Each router knows local links
2. Flood link state information
3. Build complete topology
4. Compute shortest paths
```

**Example**: OSPF, IS-IS

**Benefits**: Fast convergence, no loops

## OSPF - Open Shortest Path First

### What is OSPF?

**OSPF**: Link-state routing protocol

**Use**: Intra-domain routing (within AS)

**Standard**: IETF RFC 2328

**Algorithm**: Dijkstra's shortest path

### OSPF Areas

**Area**: Subdivision of OSPF network

**Backbone Area**: Area 0 (connects all areas)

**Regular Areas**: Connect to backbone

**Benefits**: 
- **Scalability**: Limits flooding
- **Hierarchy**: Better organization

### OSPF Process

**1. Neighbor Discovery**:
```
Hello packets
Discover neighbors
```

**2. Link State Advertisement (LSA)**:
```
Advertise local links
Flood throughout area
```

**3. Database Synchronization**:
```
Exchange LSAs
Build Link State Database (LSDB)
```

**4. Shortest Path Calculation**:
```
Run Dijkstra's algorithm
Build routing table
```

### OSPF Metrics

**Cost**: Based on link bandwidth

**Formula**: Cost = Reference_Bandwidth / Link_Bandwidth

**Lower Cost**: Better path

**Example**: 100 Mbps link â†’ Cost = 1

## BGP - Border Gateway Protocol

### What is BGP?

**BGP**: Path-vector routing protocol

**Use**: Inter-domain routing (between ASes)

**Standard**: IETF RFC 4271

**Purpose**: Exchange routes between autonomous systems

### Autonomous System (AS)

**AS**: Network under single administration

**AS Number**: Unique identifier (16-bit or 32-bit)

**Types**:
- **Stub AS**: Single connection
- **Multi-homed AS**: Multiple connections, no transit
- **Transit AS**: Provides transit service

### BGP Process

**1. BGP Session**:
```
Establish TCP connection (port 179)
Exchange BGP messages
```

**2. Route Advertisement**:
```
Advertise routes to neighbors
Include AS path
```

**3. Route Selection**:
```
Choose best route based on policies
```

**4. Route Propagation**:
```
Propagate routes throughout Internet
```

### BGP Attributes

**1. AS Path**:
```
List of ASes route traversed
Used for loop detection
```

**2. Next Hop**:
```
IP address of next router
```

**3. Local Preference**:
```
Preference for route (higher better)
```

**4. MED** (Multi-Exit Discriminator):
```
Hint for external AS
Lower is better
```

**5. Origin**:
```
How route originated
IGP, EGP, or Incomplete
```

## OSPF vs BGP

### Comparison

| Aspect | OSPF | BGP |
|--------|------|-----|
| **Scope** | Intra-domain | Inter-domain |
| **Algorithm** | Link-state | Path-vector |
| **Convergence** | Fast | Slower |
| **Policy** | Limited | Extensive |
| **Scale** | Single AS | Entire Internet |

### When to Use What

**OSPF**: 
- **Within organization**: Single AS
- **Fast convergence**: Needed
- **Simple policies**: Sufficient

**BGP**:
- **Between organizations**: Multiple ASes
- **Policy control**: Important
- **Internet routing**: Required

## Route Selection

### OSPF Route Selection

**Criteria**:
1. **Intra-area**: Prefer over inter-area
2. **Cost**: Lower cost preferred
3. **Type**: Prefer OSPF routes

### BGP Route Selection

**Criteria** (in order):
1. **Local Preference**: Higher preferred
2. **AS Path**: Shorter preferred
3. **Origin**: IGP > EGP > Incomplete
4. **MED**: Lower preferred
5. **Router ID**: Lower preferred

## Convergence

### What is Convergence?

**Convergence**: All routers agree on routes

**Time**: Time to reach consistent state

**Goal**: Fast convergence

### OSPF Convergence

**Fast**: O(log n) with Dijkstra's

**Factors**:
- **Hello interval**: How often hello sent
- **Dead interval**: When neighbor considered dead
- **LSA flooding**: How fast LSAs propagate

### BGP Convergence

**Slower**: Path-vector propagation

**Factors**:
- **Update messages**: How often sent
- **Route flap damping**: Suppress unstable routes
- **Policy changes**: May cause churn

## Real-World Examples

### Example 1: Enterprise Network

**Use**: OSPF

**Structure**: 
```
Multiple areas
Backbone area (Area 0)
Regular areas connect to backbone
```

**Benefits**: Fast convergence, scalable

### Example 2: Internet Routing

**Use**: BGP

**Structure**:
```
ASes exchange routes via BGP
Routes propagate throughout Internet
```

**Benefits**: Policy control, scalable

## Common Pitfalls

### Problem: OSPF Area Design

```c
// BAD: All routers in single area
// Doesn't scale, too much flooding

// GOOD: Hierarchical design
// Backbone area + regular areas
```

### Problem: BGP Policy Misconfiguration

```c
// BAD: Incorrect local preference
// Routes may not follow intended path

// GOOD: Careful policy configuration
// Test policies before deployment
```

## Quiz

1. What is OSPF used for?
   - **A)** Inter-domain routing
   - **B)** Intra-domain routing within an autonomous system
   - **C)** Internet routing
   - **D)** Wireless routing

2. What is BGP used for?
   - **A)** Intra-domain routing
   - **B)** Inter-domain routing between autonomous systems
   - **C)** Local routing
   - **D)** Static routing

3. What is the main difference between OSPF and BGP?
   - **A)** No difference
   - **B)** OSPF is link-state for intra-domain, BGP is path-vector for inter-domain
   - **C)** OSPF is faster
   - **D)** BGP is simpler

**Answers:**
1. **B** - OSPF (Open Shortest Path First) is a link-state routing protocol used for routing within a single autonomous system (intra-domain routing)
2. **B** - BGP (Border Gateway Protocol) is a path-vector routing protocol used for routing between different autonomous systems (inter-domain routing), essentially how the Internet routes traffic
3. **B** - OSPF uses link-state algorithm (Dijkstra's) for intra-domain routing with fast convergence, while BGP uses path-vector algorithm for inter-domain routing with extensive policy control

## Next Steps

- [CDN Architecture](../networking/09.%20CDN%20Architecture.md) - Content delivery networks
- [Network Security](../networking/10.%20Network%20Security.md) - Network-level security

