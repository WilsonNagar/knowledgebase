---
number: 8
title: "Advanced Graph Algorithms - Max Flow, Min Cut"
slug: "advanced-graph-algorithms-max-flow-min-cut"
level: "intermediate"
tags: ["data-structures", "graph-algorithms", "max-flow", "min-cut", "network-flow"]
prerequisites: ["graph-algorithms-dijkstra-astar"]
estimated_minutes: 130
contributors: []
diagrams: []
examples: []
canonical_id: "cs-dsa-08"
---

# Advanced Graph Algorithms - Max Flow, Min Cut

## Overview

Maximum flow and minimum cut are fundamental graph algorithms with applications in network optimization, matching problems, and resource allocation. Understanding Ford-Fulkerson, Edmonds-Karp, Dinic's algorithm, and the max-flow min-cut theorem is essential for solving complex network problems.

## Table of Contents

1. [Network Flow Problem](#network-flow)
2. [Max Flow Problem](#max-flow)
3. [Ford-Fulkerson Algorithm](#ford-fulkerson)
4. [Edmonds-Karp Algorithm](#edmonds-karp)
5. [Dinic's Algorithm](#dinic)
6. [Min Cut Problem](#min-cut)
7. [Max-Flow Min-Cut Theorem](#theorem)
8. [Applications](#applications)

## Network Flow Problem

### Flow Network

**Definition**: Directed graph with capacities

**Components**:
- **Source (s)**: Produces flow
- **Sink (t)**: Consumes flow
- **Edges**: Have capacity (maximum flow)
- **Flow**: Actual flow through edge

### Flow Properties

**1. Capacity Constraint**:
```
0 ≤ flow(e) ≤ capacity(e)
```

**2. Flow Conservation**:
```
Incoming flow = Outgoing flow (except source/sink)
```

**3. Skew Symmetry**:
```
flow(u,v) = -flow(v,u)
```

## Max Flow Problem

### Problem Statement

**Goal**: Find maximum flow from source to sink

**Constraints**: 
- Flow ≤ capacity
- Flow conservation

**Example**:
```
Source → A (capacity 10) → Sink
Source → B (capacity 5) → Sink
A → B (capacity 3)

Max flow: 15 (10 from A, 5 from B)
```

## Ford-Fulkerson Algorithm

### Algorithm

**Process**:
```
1. Initialize flow to 0
2. While augmenting path exists:
   a. Find augmenting path (path with residual capacity)
   b. Augment flow along path
3. Return flow
```

### Residual Graph

**Residual Capacity**:
```
residual(u,v) = capacity(u,v) - flow(u,v)
```

**Residual Graph**: Graph with residual capacities

**Backward Edges**: Allow flow reduction

### Ford-Fulkerson Example

**Network**:
```
s → A (10) → t
s → B (5) → t
A → B (3)
```

**Step 1**: Path s→A→t, flow = 10
**Step 2**: Path s→B→t, flow = 5
**Total**: 15

### Complexity

**Time**: O(E × max_flow)

**Problem**: May be slow if max flow large

**Improvement**: Use better path finding

## Edmonds-Karp Algorithm

### Algorithm

**Improvement**: Use BFS for augmenting paths

**Process**:
```
1. Initialize flow to 0
2. While augmenting path exists:
   a. Find shortest augmenting path (BFS)
   b. Augment flow
3. Return flow
```

### Benefits

**1. Polynomial Time**: O(V × E²)

**2. Shortest Path**: Always finds shortest augmenting path

**3. Guaranteed Termination**: Finite number of augmentations

### Edmonds-Karp Example

**Same network as before**

**BFS finds**: Shortest paths first

**Result**: Same max flow, but more efficient

## Dinic's Algorithm

### Algorithm

**Improvement**: Use layered graph

**Process**:
```
1. Build layered graph (BFS from source)
2. Find blocking flow in layered graph
3. Augment flow
4. Repeat until no augmenting path
```

### Blocking Flow

**Definition**: Flow that saturates at least one edge in each path

**Finding**: Use DFS in layered graph

### Complexity

**Time**: O(V² × E)

**Better**: Than Edmonds-Karp for dense graphs

**Use**: When need better performance

## Min Cut Problem

### Problem Statement

**Goal**: Find minimum cut separating source and sink

**Cut**: Partition vertices into two sets (S containing s, T containing t)

**Capacity**: Sum of capacities of edges from S to T

**Min Cut**: Cut with minimum capacity

### Min Cut Example

**Network**:
```
s → A (10) → t
s → B (5) → t
A → B (3)
```

**Cut**: S={s}, T={A,B,t}
**Capacity**: 10 + 5 = 15

**Min Cut**: 15 (equals max flow!)

## Max-Flow Min-Cut Theorem

### Theorem

**Statement**: Maximum flow = Minimum cut capacity

**Proof**: 
- Max flow ≤ Min cut (obvious)
- Max flow = Min cut (by construction)

**Significance**: Solves both problems simultaneously

### Finding Min Cut

**Method**: 
1. Find max flow
2. Find reachable vertices from source in residual graph
3. Cut = edges from reachable to non-reachable

## Applications

### Application 1: Bipartite Matching

**Problem**: Maximum matching in bipartite graph

**Reduction**: Convert to max flow

**Process**:
```
1. Add source connected to left vertices
2. Add sink connected to right vertices
3. Find max flow
4. Max flow = max matching
```

### Application 2: Image Segmentation

**Problem**: Segment image into regions

**Method**: Min cut in graph

**Graph**: Pixels = vertices, edges = similarity

**Cut**: Separates regions

### Application 3: Network Reliability

**Problem**: Minimum edges to disconnect network

**Method**: Min cut

**Result**: Weakest links in network

## Real-World Examples

### Example 1: Transportation Network

**Problem**: Maximum goods transported

**Solution**: Max flow

**Network**: Cities = vertices, roads = edges

### Example 2: Job Assignment

**Problem**: Assign jobs to workers

**Solution**: Bipartite matching via max flow

**Network**: Workers → Jobs → Sink

## Common Pitfalls

### Problem: Not Handling Backward Edges

```c
// BAD: Only forward edges
// May miss optimal flow

// GOOD: Use residual graph
// Include backward edges
```

### Problem: Infinite Loop

```c
// BAD: Poor augmenting path selection
// May loop infinitely

// GOOD: Use BFS (Edmonds-Karp)
// Or use Dinic's algorithm
```

## Quiz

1. What is the max flow problem?
   - **A)** Find shortest path
   - **B)** Find maximum flow from source to sink respecting capacity constraints
   - **C)** Find minimum spanning tree
   - **D)** Find all paths

2. What is the max-flow min-cut theorem?
   - **A)** Max flow equals min cut capacity
   - **B)** Max flow equals max cut
   - **C)** Min flow equals min cut
   - **D)** No relationship

3. What is Dinic's algorithm advantage?
   - **A)** Simpler
   - **B)** Faster (O(V²E)) than Edmonds-Karp for dense graphs
   - **C)** Uses less memory
   - **D)** Easier to implement

**Answers:**
1. **B** - The max flow problem finds the maximum amount of flow that can be sent from a source to a sink in a flow network while respecting edge capacity constraints
2. **A** - The max-flow min-cut theorem states that the maximum flow equals the minimum cut capacity, meaning both problems can be solved simultaneously
3. **B** - Dinic's algorithm uses layered graphs and blocking flows to achieve O(V²E) time complexity, which is better than Edmonds-Karp's O(VE²) for dense graphs

## Next Steps

- [LRU & LFU Cache Algorithms](../data_structures_algorithms/09.%20LRU%20%26%20LFU%20Caches.md) - Cache algorithms
- [Disjoint Set Union](../data_structures_algorithms/10.%20Disjoint%20Set%20Union.md) - Union-Find

