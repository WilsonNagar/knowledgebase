---
number: 9
title: "CDN Architecture"
slug: "cdn-architecture"
level: "intermediate"
tags: ["networking", "cdn", "content-delivery", "caching", "performance"]
prerequisites: ["load-balancing-high-availability"]
estimated_minutes: 115
contributors: []
diagrams: []
examples: []
canonical_id: "cs-net-09"
---

# CDN Architecture

## Overview

Content Delivery Networks (CDNs) distribute content geographically to reduce latency and improve performance. Understanding CDN architecture, caching strategies, edge servers, and how CDNs work is essential for building scalable, high-performance web applications.

## Table of Contents

1. [What is a CDN?](#what-is-cdn)
2. [CDN Benefits](#benefits)
3. [CDN Architecture](#architecture)
4. [Caching Strategies](#caching)
5. [Edge Servers](#edge-servers)
6. [Cache Invalidation](#cache-invalidation)
7. [CDN Providers](#providers)
8. [Best Practices](#best-practices)

## What is a CDN?

### Definition

**CDN**: Content Delivery Network

**Purpose**: Distribute content geographically

**Method**: Cache content at edge servers

**Goal**: Reduce latency, improve performance

### How CDN Works

**Process**:
```
1. User requests content
2. Request routed to nearest edge server
3. If cached: Return from edge (fast)
4. If not cached: Fetch from origin, cache, return
```

**Result**: Faster content delivery

## CDN Benefits

### Performance Benefits

**1. Reduced Latency**:
```
Content served from nearby edge
Lower round-trip time
```

**2. Higher Throughput**:
```
Distributed load
More bandwidth
```

**3. Better Availability**:
```
Multiple edge servers
Redundancy
```

### Cost Benefits

**1. Reduced Origin Load**:
```
Less traffic to origin server
Lower bandwidth costs
```

**2. Scalability**:
```
Handle traffic spikes
No need to scale origin
```

## CDN Architecture

### Components

**1. Origin Server**:
```
Original content source
```

**2. Edge Servers**:
```
Distributed cache servers
Located near users
```

**3. DNS**:
```
Route requests to nearest edge
```

**4. Cache**:
```
Store content at edge
```

### Architecture Flow

```
User → DNS → Nearest Edge Server
              ↓
         Cache Hit? → Yes → Return Content
              ↓ No
         Origin Server → Cache → Return Content
```

## Caching Strategies

### Cache-Control Headers

**max-age**: How long to cache

**Example**:
```
Cache-Control: max-age=3600
Cache for 1 hour
```

**no-cache**: Revalidate before serving

**no-store**: Don't cache

**public/private**: Who can cache

### TTL (Time To Live)

**TTL**: How long content cached

**Static Content**: Long TTL (days/weeks)

**Dynamic Content**: Short TTL (minutes/hours)

**Trade-off**: Freshness vs performance

### Cache Levels

**1. Browser Cache**:
```
User's browser
```

**2. Edge Cache**:
```
CDN edge servers
```

**3. Origin Cache**:
```
Origin server cache
```

## Edge Servers

### What are Edge Servers?

**Edge Servers**: CDN servers near users

**Location**: Distributed globally

**Purpose**: Serve cached content

**Benefit**: Low latency

### Edge Server Selection

**Method**: 
- **Geographic**: Nearest to user
- **Latency**: Lowest latency
- **Load**: Least loaded

**DNS**: Routes to appropriate edge

### Edge Server Operations

**1. Cache Lookup**:
```
Check if content cached
```

**2. Cache Miss**:
```
Fetch from origin
Cache for future
```

**3. Cache Hit**:
```
Serve from cache
```

## Cache Invalidation

### Invalidation Methods

**1. TTL Expiration**:
```
Content expires after TTL
```

**2. Manual Purge**:
```
Manually invalidate cache
```

**3. Versioning**:
```
URL versioning
New version = new URL
```

**4. Cache Tags**:
```
Tag-based invalidation
Invalidate by tags
```

### Purge Strategies

**Full Purge**: Clear all cache

**Selective Purge**: Clear specific content

**Wildcard Purge**: Clear by pattern

**Use Case**: Choose based on needs

## CDN Providers

### Major Providers

**1. Cloudflare**:
```
Global CDN
DDoS protection
```

**2. AWS CloudFront**:
```
Amazon's CDN
Integrated with AWS
```

**3. Fastly**:
```
Edge computing
Real-time purging
```

**4. Akamai**:
```
Largest CDN
Enterprise focus
```

### Choosing a CDN

**Factors**:
- **Coverage**: Geographic coverage
- **Performance**: Latency, throughput
- **Features**: DDoS, WAF, etc.
- **Cost**: Pricing model
- **Integration**: Ease of integration

## Best Practices

### CDN Best Practices

**1. Cache Static Content**:
```
Images, CSS, JS
Long TTL
```

**2. Don't Cache Dynamic Content**:
```
User-specific content
Short TTL or no-cache
```

**3. Use Versioning**:
```
Version URLs for cache busting
```

**4. Monitor Performance**:
```
Track cache hit ratio
Monitor latency
```

**5. Optimize Content**:
```
Compress content
Optimize images
```

## Real-World Examples

### Example 1: Static Website

**Content**: HTML, CSS, JS, images

**CDN**: Cache all static content

**Benefit**: Fast loading worldwide

### Example 2: Video Streaming

**Content**: Video files

**CDN**: Cache videos at edge

**Benefit**: Smooth streaming, reduced bandwidth

### Example 3: API Responses

**Content**: API responses

**CDN**: Cache public API responses

**Benefit**: Reduced origin load

## Common Pitfalls

### Problem: Caching Dynamic Content

```http
# BAD: Cache user-specific content
Cache-Control: public, max-age=3600
# Users see wrong content!

# GOOD: Don't cache or use short TTL
Cache-Control: private, max-age=60
```

### Problem: Not Invalidating Cache

```bash
# BAD: Update content but cache still old
# Users see stale content

# GOOD: Invalidate cache on update
curl -X PURGE "https://cdn.example.com/content"
```

## Quiz

1. What is a CDN?
   - **A)** Database
   - **B)** Content Delivery Network - geographically distributed cache servers
   - **C)** Load balancer
   - **D)** Firewall

2. What are edge servers?
   - **A)** Origin servers
   - **B)** CDN servers located near users for low-latency content delivery
   - **C)** Database servers
   - **D)** Application servers

3. What is cache invalidation?
   - **A)** Adding to cache
   - **B)** Removing or updating cached content when it changes
   - **C)** Checking cache
   - **D)** Clearing all cache

**Answers:**
1. **B** - A CDN (Content Delivery Network) is a network of geographically distributed servers that cache and serve content from locations near users to reduce latency
2. **B** - Edge servers are CDN servers distributed globally near end users, serving cached content to minimize latency and improve performance
3. **B** - Cache invalidation is the process of removing or updating cached content when the original content changes, ensuring users receive fresh content

## Next Steps

- [Network Security Advanced](../networking/10.%20Network%20Security%20Advanced.md) - Advanced security
- [WebRTC & Real-Time Communication](../networking/11.%20WebRTC.md) - Real-time protocols

