---
number: 4
title: "Infrastructure as Code - Terraform, Pulumi"
slug: "infrastructure-as-code-terraform-pulumi"
level: "intermediate"
tags: ["cloud", "iac", "terraform", "pulumi", "infrastructure", "devops"]
prerequisites: ["service-meshes-istio"]
estimated_minutes: 140
contributors: []
diagrams: []
examples: []
canonical_id: "cs-cloud-04"
---

# Infrastructure as Code - Terraform, Pulumi

## Overview

Infrastructure as Code (IaC) enables managing infrastructure through code rather than manual processes. Understanding Terraform, Pulumi, IaC principles, state management, and best practices is essential for modern cloud infrastructure management and DevOps practices.

## Table of Contents

1. [What is Infrastructure as Code?](#what-is-iac)
2. [IaC Benefits](#benefits)
3. [Terraform Fundamentals](#terraform)
4. [Terraform Advanced](#terraform-advanced)
5. [Pulumi Fundamentals](#pulumi)
6. [Pulumi vs Terraform](#pulumi-vs-terraform)
7. [IaC Best Practices](#best-practices)
8. [Real-World Examples](#examples)

## What is Infrastructure as Code?

### Definition

**IaC**: Infrastructure as Code

**Purpose**: Manage infrastructure through code

**Method**: Define infrastructure in code

**Benefit**: Version control, automation, consistency

### Traditional vs IaC

**Traditional**:
- **Manual**: Manual configuration
- **Inconsistent**: Inconsistent environments
- **Slow**: Slow provisioning
- **Error-Prone**: Human errors

**IaC**:
- **Automated**: Automated provisioning
- **Consistent**: Consistent environments
- **Fast**: Fast provisioning
- **Reliable**: Repeatable

## IaC Benefits

### Key Benefits

**1. Version Control**:
```
Track infrastructure changes
```

**2. Consistency**:
```
Consistent environments
```

**3. Automation**:
```
Automate provisioning
```

**4. Documentation**:
```
Code is documentation
```

**5. Collaboration**:
```
Team collaboration
```

**6. Disaster Recovery**:
```
Quick recovery
```

## Terraform Fundamentals

### What is Terraform?

**Terraform**: Infrastructure as Code tool

**Provider**: HashiCorp

**Language**: HCL (HashiCorp Configuration Language)

**State**: State management

**Use**: Multi-cloud infrastructure

### Terraform Basics

**Configuration File**:
```hcl
provider "aws" {
  region = "us-west-2"
}

resource "aws_instance" "web" {
  ami           = "ami-0c55b159cbfafe1f0"
  instance_type = "t2.micro"
  
  tags = {
    Name = "WebServer"
  }
}
```

**Commands**:
```bash
terraform init      # Initialize
terraform plan      # Preview changes
terraform apply     # Apply changes
terraform destroy   # Destroy infrastructure
```

### Terraform State

**State**: Current infrastructure state

**Purpose**: Track resources

**Backend**: Store state remotely

**Locking**: Prevent concurrent modifications

## Terraform Advanced

### Terraform Modules

**Modules**: Reusable components

**Example**:
```hcl
module "vpc" {
  source = "./modules/vpc"
  
  vpc_cidr = "10.0.0.0/16"
  environment = "production"
}
```

**Benefit**: Reusability, organization

### Terraform Workspaces

**Workspaces**: Multiple environments

**Use**: 
```
terraform workspace new dev
terraform workspace new prod
terraform workspace select dev
```

**Benefit**: Manage multiple environments

### Terraform Variables

**Variables**: Parameterize configurations

**Example**:
```hcl
variable "instance_type" {
  description = "EC2 instance type"
  type        = string
  default     = "t2.micro"
}

resource "aws_instance" "web" {
  instance_type = var.instance_type
}
```

**Use**: Make configurations flexible

## Pulumi Fundamentals

### What is Pulumi?

**Pulumi**: Infrastructure as Code tool

**Language**: General-purpose languages

**Languages**: TypeScript, Python, Go, C#, Java

**State**: State management

**Use**: Multi-cloud infrastructure

### Pulumi Basics

**TypeScript Example**:
```typescript
import * as aws from "@pulumi/aws";

const instance = new aws.ec2.Instance("web", {
    ami: "ami-0c55b159cbfafe1f0",
    instanceType: "t2.micro",
    tags: {
        Name: "WebServer"
    }
});

export const instanceId = instance.id;
```

**Python Example**:
```python
import pulumi
import pulumi_aws as aws

instance = aws.ec2.Instance("web",
    ami="ami-0c55b159cbfafe1f0",
    instance_type="t2.micro",
    tags={
        "Name": "WebServer"
    }
)

pulumi.export("instance_id", instance.id)
```

### Pulumi State

**State**: Current infrastructure state

**Backend**: Pulumi Cloud or self-hosted

**Locking**: Prevent concurrent modifications

## Pulumi vs Terraform

### Comparison

| Aspect | Terraform | Pulumi |
|--------|-----------|--------|
| **Language** | HCL | General-purpose |
| **Learning Curve** | Moderate | Depends on language |
| **Ecosystem** | Large | Growing |
| **State Management** | Terraform state | Pulumi state |
| **Provider Support** | Extensive | Extensive |

### When to Use Terraform

**Use Terraform When**:
- **HCL Familiar**: Team familiar with HCL
- **Mature Ecosystem**: Need mature ecosystem
- **Simple Configs**: Simple configurations

### When to Use Pulumi

**Use Pulumi When**:
- **Language Preference**: Prefer general-purpose language
- **Complex Logic**: Need complex logic
- **Type Safety**: Want type safety

## IaC Best Practices

### Practice 1: Version Control

**Version Control**: 
```
Store IaC in version control
Git, GitLab, GitHub
```

**Benefit**: Track changes, collaboration

### Practice 2: Modularize

**Modules**: 
```
Create reusable modules
Organize code
```

**Benefit**: Reusability, maintainability

### Practice 3: State Management

**State**: 
```
Store state remotely
Use state locking
```

**Benefit**: Team collaboration, safety

### Practice 4: Testing

**Testing**: 
```
Test infrastructure code
Unit tests, integration tests
```

**Benefit**: Catch errors early

### Practice 5: Documentation

**Documentation**: 
```
Document infrastructure
Code comments, README
```

**Benefit**: Understandability

## Real-World Examples

### Example 1: Multi-Environment Setup

**Use**: Dev, staging, production

**Method**: 
```
Use workspaces (Terraform)
Or stacks (Pulumi)
```

**Benefit**: Consistent environments

### Example 2: Module Library

**Use**: Reusable modules

**Method**: 
```
Create module library
Share across projects
```

**Benefit**: Consistency, speed

### Example 3: CI/CD Integration

**Use**: Automated deployment

**Method**: 
```
Run terraform/pulumi in CI/CD
Automate infrastructure changes
```

**Benefit**: Automation, reliability

## Common Pitfalls

### Problem: State Drift

```c
// BAD: Manual changes outside IaC
// State drift, inconsistencies

// GOOD: All changes through IaC
// No manual changes
```

### Problem: Hardcoded Values

```c
// BAD: Hardcoded values
// Not reusable

// GOOD: Use variables
// Parameterize configurations
```

## Quiz

1. What is Infrastructure as Code?
   - **A)** Manual infrastructure
   - **B)** Managing infrastructure through code rather than manual processes
   - **C)** Infrastructure documentation
   - **D)** Infrastructure monitoring

2. What is Terraform?
   - **A)** Cloud provider
   - **B)** Infrastructure as Code tool using HCL language
   - **C)** Programming language
   - **D)** Container platform

3. What is the main advantage of Pulumi over Terraform?
   - **A)** Simpler syntax
   - **B)** Uses general-purpose programming languages
   - **C)** Faster execution
   - **D)** Better documentation

**Answers:**
1. **B** - Infrastructure as Code (IaC) manages infrastructure through code, enabling version control, automation, and consistency
2. **B** - Terraform is an Infrastructure as Code tool by HashiCorp that uses HCL (HashiCorp Configuration Language) to define infrastructure
3. **B** - Pulumi's main advantage is using general-purpose programming languages (TypeScript, Python, Go, etc.) instead of a domain-specific language, enabling complex logic and type safety

## Next Steps

- [CDN Architecture Advanced](../cloud_infrastructure/05.%20CDN%20Architecture%20Advanced.md) - Content delivery
- [Serverless Architecture](../cloud_infrastructure/06.%20Serverless%20Architecture.md) - Serverless computing

