---
number: 1
title: "Distributed Database Systems"
slug: "distributed-database-systems"
level: "advanced"
tags: ["databases", "distributed", "distributed-systems", "consensus", "replication"]
prerequisites: ["database-concurrency-control-advanced"]
estimated_minutes: 150
contributors: []
diagrams: []
examples: []
canonical_id: "cs-db-adv-01"
---

# Distributed Database Systems

## Overview

Distributed database systems spread data across multiple nodes for scalability and availability. Understanding distributed database architectures, consistency models, replication strategies, partitioning, and distributed transactions is essential for building scalable database systems.

## Table of Contents

1. [What are Distributed Databases?](#what-are-distributed)
2. [Distributed Database Architecture](#architecture)
3. [Consistency Models](#consistency)
4. [Replication Strategies](#replication)
5. [Partitioning & Sharding](#partitioning)
6. [Distributed Transactions](#distributed-transactions)
7. [CAP Theorem](#cap-theorem)
8. [Real-World Examples](#examples)

## What are Distributed Databases?

### Definition

**Distributed Database**: Database across multiple nodes

**Characteristics**:
- **Distributed**: Data distributed across nodes
- **Network**: Nodes communicate over network
- **Transparency**: Location transparency
- **Autonomy**: Node autonomy

**Benefits**: 
- **Scalability**: Scale horizontally
- **Availability**: High availability
- **Performance**: Better performance

**Challenges**: 
- **Complexity**: More complex
- **Consistency**: Consistency challenges
- **Network**: Network issues

## Distributed Database Architecture

### Architecture Types

**1. Homogeneous**:
```
Same DBMS on all nodes
```

**2. Heterogeneous**:
```
Different DBMS on nodes
```

**3. Federated**:
```
Federated database system
```

**4. Client-Server**:
```
Client-server architecture
```

### Architecture Components

**1. Local DBMS**:
```
Local database management
```

**2. Distributed DBMS**:
```
Distributed database management
```

**3. Network**:
```
Network communication
```

**4. Transaction Manager**:
```
Distributed transaction management
```

## Consistency Models

### Consistency Types

**1. Strong Consistency**:
```
All nodes see same data
```

**2. Eventual Consistency**:
```
Eventually consistent
```

**3. Weak Consistency**:
```
Weak consistency guarantees
```

**4. Causal Consistency**:
```
Causally consistent
```

### Consistency Trade-offs

**Strong Consistency**:
- **Benefit**: Correct data
- **Cost**: Lower availability, higher latency

**Eventual Consistency**:
- **Benefit**: Higher availability, lower latency
- **Cost**: May see stale data

## Replication Strategies

### Replication Types

**1. Master-Slave**:
```
Single master, multiple slaves
```

**2. Master-Master**:
```
Multiple masters
```

**3. Multi-Master**:
```
Multiple masters, conflict resolution
```

**4. Peer-to-Peer**:
```
Peer-to-peer replication
```

### Replication Strategies

**Synchronous Replication**:
```
Wait for all replicas
Strong consistency
Higher latency
```

**Asynchronous Replication**:
```
Don't wait for replicas
Eventual consistency
Lower latency
```

## Partitioning & Sharding

### What is Partitioning?

**Partitioning**: Split data across nodes

**Types**: 
- **Horizontal**: Split rows
- **Vertical**: Split columns
- **Functional**: Split by function

**Sharding**: Horizontal partitioning

### Sharding Strategies

**1. Range Sharding**:
```
Shard by range
```

**2. Hash Sharding**:
```
Shard by hash
```

**3. Directory Sharding**:
```
Directory-based sharding
```

**4. Composite Sharding**:
```
Composite sharding
```

### Sharding Example

**Hash Sharding**:
```
Shard 1: hash(key) % 3 == 0
Shard 2: hash(key) % 3 == 1
Shard 3: hash(key) % 3 == 2
```

**Benefit**: Even distribution

## Distributed Transactions

### What are Distributed Transactions?

**Distributed Transaction**: Transaction across nodes

**Challenge**: ACID across network

**Solutions**: 
- **2PC**: Two-Phase Commit
- **3PC**: Three-Phase Commit
- **Saga**: Saga pattern

### Two-Phase Commit (2PC)

**Phase 1 (Prepare)**:
```
1. Coordinator sends prepare
2. Participants vote
3. Coordinator collects votes
```

**Phase 2 (Commit/Abort)**:
```
1. If all yes: Commit
2. If any no: Abort
```

**Problem**: Blocking if coordinator fails

### Saga Pattern

**Saga**: Long-running transactions

**Method**: 
```
Compensating transactions
No global locks
```

**Benefit**: Non-blocking

**Use**: Microservices, long transactions

## CAP Theorem

### What is CAP Theorem?

**CAP**: Consistency, Availability, Partition tolerance

**Theorem**: Can have at most 2 of 3

**Choices**: 
- **CP**: Consistency + Partition tolerance
- **AP**: Availability + Partition tolerance
- **CA**: Consistency + Availability (not distributed)

### CAP Trade-offs

**CP Systems**:
```
Consistency + Partition tolerance
Examples: Traditional databases
```

**AP Systems**:
```
Availability + Partition tolerance
Examples: NoSQL databases
```

**CA Systems**:
```
Consistency + Availability
Not truly distributed
```

## Real-World Examples

### Example 1: Google Spanner

**Type**: CP system

**Features**: 
- **Strong Consistency**: Strong consistency
- **Global Distribution**: Global distribution
- **TrueTime**: TrueTime for ordering

**Use**: Global database

### Example 2: Amazon DynamoDB

**Type**: AP system

**Features**: 
- **High Availability**: High availability
- **Eventual Consistency**: Eventual consistency
- **Scalability**: Highly scalable

**Use**: High-availability applications

### Example 3: MongoDB

**Type**: Configurable

**Features**: 
- **Replication**: Replication
- **Sharding**: Sharding
- **Consistency**: Configurable consistency

**Use**: Document database

## Common Pitfalls

### Problem: Network Partitions

```c
// BAD: Ignore network partitions
// System unavailable

// GOOD: Handle partitions
// Choose CAP trade-off
```

### Problem: Consistency Issues

```c
// BAD: Ignore consistency
// Data inconsistencies

// GOOD: Choose consistency model
// Based on requirements
```

## Quiz

1. What is a distributed database?
   - **A)** Single database
   - **B)** Database spread across multiple nodes over network
   - **C)** Database on one server
   - **D)** Database in memory

2. What is the CAP theorem?
   - **A)** Can have all three
   - **B)** Can have at most 2 of 3: Consistency, Availability, Partition tolerance
   - **C)** Can have only one
   - **D)** No limitations

3. What is sharding?
   - **A)** Replication
   - **B)** Horizontal partitioning splitting data across nodes
   - **C)** Vertical partitioning
   - **D)** Backup

**Answers:**
1. **B** - A distributed database spreads data across multiple nodes connected by a network, providing scalability and availability
2. **B** - CAP theorem states that in a distributed system, you can have at most 2 of: Consistency, Availability, Partition tolerance
3. **B** - Sharding is horizontal partitioning that splits data (rows) across multiple nodes/servers for scalability

## Next Steps

- [NewSQL Databases](../databases/02.%20NewSQL%20Databases.md) - NewSQL
- [Time-Series Databases](../databases/03.%20Time-Series%20Databases.md) - Time-series

