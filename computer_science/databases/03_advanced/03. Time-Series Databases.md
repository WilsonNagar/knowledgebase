---
number: 3
title: "Time-Series Databases"
slug: "time-series-databases"
level: "advanced"
tags: ["databases", "time-series", "iot", "monitoring", "metrics"]
prerequisites: ["newsql-databases"]
estimated_minutes: 140
contributors: []
diagrams: []
examples: []
canonical_id: "cs-db-adv-03"
---

# Time-Series Databases

## Overview

Time-series databases are optimized for storing and querying time-stamped data. Understanding time-series data characteristics, specialized storage engines, compression techniques, and time-series query patterns is essential for IoT, monitoring, and analytics applications.

## Table of Contents

1. [What are Time-Series Databases?](#what-is-timeseries)
2. [Time-Series Data Characteristics](#characteristics)
3. [Time-Series Storage](#storage)
4. [Compression Techniques](#compression)
5. [Time-Series Query Patterns](#query-patterns)
6. [Time-Series Databases](#timeseries-databases)
7. [Use Cases](#use-cases)
8. [Best Practices](#best-practices)

## What are Time-Series Databases?

### Definition

**Time-Series Database**: Optimized for time-stamped data

**Purpose**: Store and query time-series data

**Characteristics**:
- **Time-Ordered**: Data ordered by time
- **Append-Only**: Mostly append-only
- **High Volume**: High data volume
- **Time-Based Queries**: Time-based queries

**Use**: IoT, monitoring, metrics, analytics

### Time-Series vs Relational

**Relational**: 
- **General Purpose**: General-purpose
- **Updates**: Frequent updates
- **Relations**: Complex relations

**Time-Series**: 
- **Specialized**: Specialized for time-series
- **Append-Heavy**: Mostly appends
- **Time-Focused**: Time-focused queries

## Time-Series Data Characteristics

### Characteristics

**1. Time-Ordered**:
```
Data ordered by timestamp
```

**2. Append-Only**:
```
Mostly append operations
```

**3. High Volume**:
```
High data volume
```

**4. Immutable**:
```
Data rarely updated
```

**5. Time-Based Queries**:
```
Queries based on time ranges
```

### Time-Series Data Model

**Data Points**:
```
(timestamp, value, tags)
```

**Example**:
```
(2024-01-01 10:00:00, 25.5, sensor_id=1, location=room1)
(2024-01-01 10:01:00, 25.6, sensor_id=1, location=room1)
```

**Tags**: Metadata (sensor_id, location)

**Values**: Measurements (temperature, etc.)

## Time-Series Storage

### Storage Strategies

**1. Columnar Storage**:
```
Store columns separately
```

**2. Compression**:
```
Heavy compression
```

**3. Partitioning**:
```
Partition by time
```

**4. Indexing**:
```
Time-based indexing
```

### Storage Layout

**Time-Partitioned**:
```
Partition 1: 2024-01-01 to 2024-01-31
Partition 2: 2024-02-01 to 2024-02-29
...
```

**Benefit**: 
- **Efficient Queries**: Efficient time-range queries
- **Easy Deletion**: Easy old data deletion
- **Compression**: Better compression

## Compression Techniques

### Compression Methods

**1. Delta Compression**:
```
Store differences
```

**2. Run-Length Encoding**:
```
Encode runs
```

**3. Dictionary Compression**:
```
Dictionary for tags
```

**4. Gorilla Compression**:
```
Facebook's Gorilla compression
```

### Delta Compression

**Delta Compression**: Store differences

**Example**:
```
Original: [100, 101, 103, 102, 104]
Delta:    [100, 1, 2, -1, 2]
```

**Benefit**: Smaller values, better compression

## Time-Series Query Patterns

### Common Queries

**1. Range Queries**:
```
SELECT * FROM metrics
WHERE time >= '2024-01-01'
  AND time < '2024-01-02'
```

**2. Aggregation**:
```
SELECT AVG(value), time_bucket('1h', time)
FROM metrics
GROUP BY time_bucket('1h', time)
```

**3. Downsampling**:
```
Reduce resolution
```

**4. Interpolation**:
```
Fill missing values
```

### Query Optimization

**1. Time-Range Filtering**:
```
Filter by time first
```

**2. Downsampling**:
```
Downsample for long ranges
```

**3. Aggregation**:
```
Pre-aggregate when possible
```

**4. Indexing**:
```
Time-based indexes
```

## Time-Series Databases

### Popular Time-Series Databases

**1. InfluxDB**:
```
Time-series database
High write throughput
```

**2. TimescaleDB**:
```
PostgreSQL extension
SQL interface
```

**3. Prometheus**:
```
Monitoring database
Pull-based
```

**4. OpenTSDB**:
```
HBase-based
Scalable
```

### InfluxDB

**InfluxDB**: Time-series database

**Features**: 
- **High Write**: High write throughput
- **Compression**: Compression
- **Query Language**: InfluxQL, Flux
- **Retention**: Data retention policies

**Use**: IoT, monitoring

### TimescaleDB

**TimescaleDB**: PostgreSQL extension

**Features**: 
- **SQL**: Full SQL
- **Hypertables**: Automatic partitioning
- **Compression**: Compression
- **PostgreSQL**: PostgreSQL compatibility

**Use**: Time-series with SQL

## Use Cases

### Use Case 1: IoT

**Use**: IoT sensor data

**Requirements**: 
- **High Volume**: High data volume
- **Real-Time**: Real-time ingestion
- **Queries**: Time-based queries

**Solution**: InfluxDB, TimescaleDB

### Use Case 2: Monitoring

**Use**: System monitoring

**Requirements**: 
- **Metrics**: Store metrics
- **Dashboards**: Support dashboards
- **Alerts**: Support alerts

**Solution**: Prometheus, InfluxDB

### Use Case 3: Analytics

**Use**: Time-series analytics

**Requirements**: 
- **Aggregation**: Aggregation
- **Downsampling**: Downsampling
- **Analysis**: Time-series analysis

**Solution**: TimescaleDB, InfluxDB

## Best Practices

### Practice 1: Data Retention

**Retention Policies**: 
```
Set retention policies
Delete old data automatically
```

**Benefit**: Manage storage

### Practice 2: Downsampling

**Downsampling**: 
```
Downsample old data
Reduce resolution
```

**Benefit**: Reduce storage

### Practice 3: Tagging

**Tagging**: 
```
Use tags for metadata
Efficient filtering
```

**Benefit**: Better queries

### Practice 4: Batch Writes

**Batch Writes**: 
```
Batch writes
Better performance
```

**Benefit**: Higher throughput

## Real-World Examples

### Example 1: IoT Platform

**Use**: IoT sensor data

**Database**: InfluxDB

**Features**: 
- **High Write**: High write throughput
- **Compression**: Compression
- **Queries**: Time-based queries

**Result**: Efficient IoT data storage

### Example 2: Monitoring System

**Use**: System monitoring

**Database**: Prometheus

**Features**: 
- **Metrics**: Metrics storage
- **Queries**: PromQL queries
- **Alerts**: Alerting

**Result**: Effective monitoring

## Common Pitfalls

### Problem: Wrong Database

```c
// BAD: Use relational database
// Poor performance

// GOOD: Use time-series database
// Optimized for time-series
```

### Problem: No Retention Policy

```c
// BAD: Keep all data forever
// Storage explosion

// GOOD: Set retention policies
// Manage storage
```

## Quiz

1. What is a time-series database?
   - **A)** General-purpose database
   - **B)** Database optimized for time-stamped data with append-heavy workloads
   - **C)** NoSQL database
   - **D)** Graph database

2. What are characteristics of time-series data?
   - **A)** Frequent updates
   - **B)** Time-ordered, append-only, high volume, immutable
   - **C)** Complex relations
   - **D)** Random access

3. What is delta compression?
   - **A)** Full storage
   - **B)** Storing differences between consecutive values for better compression
   - **C)** No compression
   - **D)** Random compression

**Answers:**
1. **B** - Time-series databases are specialized for storing and querying time-stamped data with append-heavy, high-volume workloads
2. **B** - Time-series data is time-ordered, mostly append-only, high volume, and rarely updated (immutable)
3. **B** - Delta compression stores differences between consecutive values rather than absolute values, enabling better compression for time-series data

## Next Steps

- [Graph Databases](./04.%20Graph%20Databases.md) - Graph databases
- [Distributed Database Systems](./01.%20Distributed%20Database%20Systems.md) - Advanced architectures

