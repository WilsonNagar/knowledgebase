---
number: 9
title: "Distributed Caching - Redis, Memcached Strategies"
slug: "distributed-caching-redis-memcached-strategies"
level: "intermediate"
tags: ["distributed-systems", "caching", "redis", "memcached", "cache-strategies"]
prerequisites: ["service-discovery-consul-etcd-zookeeper"]
estimated_minutes: 140
contributors: []
diagrams: []
examples: []
canonical_id: "cs-dist-09"
---

# Distributed Caching - Redis, Memcached Strategies

## Overview

Distributed caching improves performance by storing frequently accessed data in memory across multiple nodes. Understanding Redis, Memcached, caching strategies, cache invalidation, and distributed cache architectures is essential for building high-performance distributed systems.

## Table of Contents

1. [What is Distributed Caching?](#what-is-caching)
2. [Redis](#redis)
3. [Memcached](#memcached)
4. [Redis vs Memcached](#redis-vs-memcached)
5. [Caching Strategies](#strategies)
6. [Cache Invalidation](#invalidation)
7. [Distributed Cache Architectures](#architectures)
8. [Best Practices](#best-practices)

## What is Distributed Caching?

### Definition

**Distributed Cache**: Cache across multiple nodes

**Purpose**: 
- **Performance**: Improve performance
- **Scalability**: Scale cache
- **Availability**: High availability

**Benefits**: 
- **Fast Access**: Fast data access
- **Reduce Load**: Reduce database load
- **Scalability**: Horizontal scalability

### Caching Benefits

**1. Performance**:
```
Faster data access
```

**2. Scalability**:
```
Reduce database load
```

**3. Availability**:
```
Cache can serve during outages
```

**4. Cost**:
```
Reduce database costs
```

## Redis

### What is Redis?

**Redis**: In-memory data structure store

**Features**: 
- **Data Structures**: Strings, lists, sets, hashes, sorted sets
- **Persistence**: Optional persistence
- **Replication**: Master-slave replication
- **Clustering**: Redis Cluster
- **Pub/Sub**: Publish-subscribe

**Use**: Caching, sessions, queues, real-time

### Redis Data Structures

**1. Strings**:
```
SET key value
GET key
```

**2. Lists**:
```
LPUSH list value
RPOP list
```

**3. Sets**:
```
SADD set member
SMEMBERS set
```

**4. Hashes**:
```
HSET hash field value
HGET hash field
```

**5. Sorted Sets**:
```
ZADD sortedset score member
ZRANGE sortedset 0 -1
```

### Redis Features

**1. Persistence**:
```
RDB snapshots
AOF append-only file
```

**2. Replication**:
```
Master-slave replication
```

**3. Clustering**:
```
Redis Cluster
Sharding
```

**4. Pub/Sub**:
```
Publish-subscribe messaging
```

## Memcached

### What is Memcached?

**Memcached**: Distributed memory caching

**Features**: 
- **Simple**: Simple key-value store
- **Fast**: Very fast
- **Distributed**: Distributed caching
- **No Persistence**: No persistence

**Use**: Simple caching

### Memcached Characteristics

**1. Key-Value**:
```
Simple key-value store
```

**2. No Persistence**:
```
No disk persistence
```

**3. Distributed**:
```
Distributed across nodes
```

**4. Fast**:
```
Very fast access
```

### Memcached Usage

**Operations**:
```
SET key value
GET key
DELETE key
```

**Distributed**:
```
Client hashes keys
Routes to appropriate server
```

## Redis vs Memcached

### Comparison

| Aspect | Redis | Memcached |
|--------|-------|-----------|
| **Data Structures** | Rich (strings, lists, sets, etc.) | Simple (key-value) |
| **Persistence** | Yes (RDB, AOF) | No |
| **Replication** | Yes | No |
| **Clustering** | Yes (Redis Cluster) | Client-side sharding |
| **Pub/Sub** | Yes | No |
| **Complexity** | Higher | Lower |
| **Use Case** | Rich features needed | Simple caching |

### When to Use Redis

**Use Redis When**:
- **Rich Data Structures**: Need rich data structures
- **Persistence**: Need persistence
- **Pub/Sub**: Need pub/sub
- **Complex Operations**: Complex operations

### When to Use Memcached

**Use Memcached When**:
- **Simple Caching**: Simple key-value caching
- **No Persistence**: Don't need persistence
- **Simplicity**: Want simplicity
- **Performance**: Maximum performance

## Caching Strategies

### Strategy 1: Cache-Aside

**Cache-Aside**: Application manages cache

**Process**:
```
1. Check cache
2. If miss: Load from database
3. Store in cache
4. Return data
```

**Benefit**: Application control

**Use**: Most common pattern

### Strategy 2: Write-Through

**Write-Through**: Write to cache and database

**Process**:
```
1. Write to cache
2. Write to database
3. Return
```

**Benefit**: Cache always consistent

**Trade-off**: Slower writes

### Strategy 3: Write-Back

**Write-Back**: Write to cache, defer database

**Process**:
```
1. Write to cache
2. Return immediately
3. Write to database later
```

**Benefit**: Fast writes

**Trade-off**: Risk of data loss

### Strategy 4: Read-Through

**Read-Through**: Cache loads on miss

**Process**:
```
1. Check cache
2. If miss: Cache loads from database
3. Return data
```

**Benefit**: Transparent to application

## Cache Invalidation

### Invalidation Strategies

**1. TTL**:
```
Time-to-live
Automatic expiration
```

**2. Explicit Invalidation**:
```
Explicitly invalidate
On updates
```

**3. Versioning**:
```
Version keys
Invalidate by version
```

**4. Event-Based**:
```
Invalidate on events
```

### Invalidation Patterns

**TTL Pattern**:
```
SET key value EX 3600  // Expires in 1 hour
```

**Explicit Invalidation**:
```
DEL key  // Delete on update
```

**Versioning Pattern**:
```
SET user:123:v2 data
GET user:123:v2
```

## Distributed Cache Architectures

### Architecture Types

**1. Client-Side Sharding**:
```
Client hashes keys
Routes to servers
```

**2. Server-Side Sharding**:
```
Servers handle sharding
```

**3. Replicated Cache**:
```
Replicate cache
```

**4. Distributed Cache**:
```
Distributed across nodes
```

### Redis Cluster

**Redis Cluster**: Distributed Redis

**Features**: 
- **Sharding**: Automatic sharding
- **Replication**: Replication
- **High Availability**: High availability

**Sharding**: Hash slots

**Replication**: Master-slave

## Best Practices

### Practice 1: Choose Right Strategy

**Choose**: 
```
Match strategy to use case
Cache-aside for most cases
```

**Benefit**: Optimal performance

### Practice 2: Set TTLs

**TTL**: 
```
Set appropriate TTLs
Balance freshness and performance
```

**Benefit**: Automatic invalidation

### Practice 3: Handle Cache Misses

**Cache Misses**: 
```
Handle gracefully
Fallback to database
```

**Benefit**: Resilience

### Practice 4: Monitor Cache

**Monitor**: 
```
Monitor hit rates
Monitor performance
```

**Benefit**: Optimization

## Real-World Examples

### Example 1: Session Storage

**Use**: Session storage

**Tool**: Redis

**Features**: 
- **TTL**: Automatic expiration
- **Persistence**: Optional persistence
- **Performance**: Fast access

**Result**: Efficient session management

### Example 2: Database Caching

**Use**: Database query caching

**Tool**: Memcached

**Features**: 
- **Simple**: Simple caching
- **Fast**: Very fast
- **Distributed**: Distributed

**Result**: Reduced database load

## Common Pitfalls

### Problem: Cache Stampede

```c
// BAD: Many requests on cache miss
// Database overload

// GOOD: Use locks or probabilistic expiration
// Prevent stampede
```

### Problem: Stale Data

```c
// BAD: No invalidation
// Stale data served

// GOOD: Proper invalidation
// TTL or explicit invalidation
```

## Quiz

1. What is distributed caching?
   - **A)** Single cache
   - **B)** Cache distributed across multiple nodes for scalability
   - **C)** Database
   - **D)** Storage

2. What is the main difference between Redis and Memcached?
   - **A)** No difference
   - **B)** Redis has rich data structures and persistence; Memcached is simple key-value
   - **C)** Redis is slower
   - **D)** Memcached is more complex

3. What is cache-aside?
   - **A)** Cache first
   - **B)** Application-managed caching pattern where app checks cache, loads from DB on miss
   - **C)** Cache only
   - **D)** Database only

**Answers:**
1. **B** - Distributed caching spreads cache across multiple nodes, providing scalability and high availability
2. **B** - Redis offers rich data structures (lists, sets, hashes), persistence, and clustering; Memcached is a simple distributed key-value cache
3. **B** - Cache-aside is a pattern where the application checks cache first, loads from database on miss, and stores in cache

## Next Steps

- [Distributed Locking](./10.%20Distributed%20Locking.md) - Distributed locks
- [Leader Election Algorithms](./11.%20Leader%20Election%20Algorithms.md) - Leader election

