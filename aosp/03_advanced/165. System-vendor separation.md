---
number: 165
title: System/vendor separation
slug: system-vendor-separation
level: advanced
tags:
  - aosp
  - treble
  - system-vendor-separation
  - partitions
  - modularization
prerequisites:
  - treble-architecture
  - android-partitions
  - binderized-services
estimated_minutes: 95
contributors: []
diagrams: []
examples: []
canonical_id: aosp-advanced-165
---

# System/vendor separation

## Overview

System/vendor separation refers to the architectural separation between the Android system (framework) and vendor-specific implementations (HALs, drivers, proprietary code) in Project Treble. This separation enables independent updates of the framework and vendor code, improves security through isolation, and allows faster Android updates. Understanding system/vendor separation is essential for AOSP development, as it explains how system and vendor are separated, how partitions are organized, how processes are isolated, how interfaces enable separation, and how separation benefits Android development. This guide provides a comprehensive overview of system/vendor separation, partition separation, process separation, interface boundaries, isolation mechanisms, and separation benefits.

Think of system/vendor separation like separating a building's infrastructure from its customizations: just as a building's core infrastructure (system) is separate from tenant customizations (vendor), allowing infrastructure updates without affecting customizations, and customizations can be updated without changing infrastructure, system/vendor separation allows framework updates without affecting vendor code, and vendor code can be updated without changing the framework.

## Deep Explanation

### What is System/Vendor Separation?

System/vendor separation refers to the architectural separation between the Android system (framework) and vendor-specific implementations (HALs, drivers, proprietary code) in Project Treble. This separation enables independent updates and better isolation.

**Key Characteristics:**
- **Partition Separation:** Separate partitions
- **Process Separation:** Separate processes
- **Code Separation:** Separate codebases
- **Interface-Based:** Interface-based communication
- **Independent Updates:** Independent update paths

**Why System/Vendor Separation?**
- **Independent Updates:** Framework and vendor can update independently
- **Security Isolation:** Better security through isolation
- **Faster Updates:** Faster Android updates
- **Better Testing:** Better testing with GSI

### Partition Separation

#### System Partition

**System Partition:**
- Contains Android framework
- System services
- Framework libraries
- System applications

**System Partition Characteristics:**
- Read-only
- Framework code only
- AOSP-maintained
- Can be updated independently

**System Partition Structure:**
```
/system/
├── framework/        - Framework JARs
├── lib/              - Framework libraries
├── lib64/            - Framework libraries (64-bit)
├── app/              - System apps
├── priv-app/         - Privileged system apps
└── etc/              - System configuration
```

#### Vendor Partition

**Vendor Partition:**
- Contains vendor code
- HAL implementations
- Vendor libraries
- Vendor binaries

**Vendor Partition Characteristics:**
- Read-only
- Vendor-specific code
- Vendor-maintained
- Can be updated independently

**Vendor Partition Structure:**
```
/vendor/
├── lib/              - Vendor libraries (32-bit)
├── lib64/            - Vendor libraries (64-bit)
├── bin/              - Vendor binaries
├── hw/               - HAL modules (legacy)
├── etc/              - Vendor configuration
├── manifest.xml      - VINTF manifest
└── firmware/         - Firmware files
```

### Process Separation

#### System Processes

**System Processes:**
- Framework services
- System server
- System applications
- Framework components

**System Process Characteristics:**
- Run in system context
- System UID (1000)
- Framework code
- AOSP-maintained

**System Process Examples:**
- system_server
- com.android.systemui
- com.android.phone

#### Vendor Processes

**Vendor Processes:**
- Vendor HAL services
- Vendor services
- Vendor applications
- Hardware-specific code

**Vendor Process Characteristics:**
- Run in vendor context
- Vendor UID
- Vendor code
- Vendor-maintained

**Vendor Process Examples:**
- cameraserver
- android.hardware.camera@2.4-service
- vendor-specific services

### Interface Boundaries

#### HAL Interfaces

**HAL Interface Boundaries:**
- Clear interface definitions
- Versioned interfaces
- Stable API contracts
- Interface-based communication

**Interface Types:**
- HIDL interfaces (legacy)
- AIDL interfaces (modern)
- Versioned interfaces
- Stable interfaces

#### Communication Methods

**Communication Methods:**
- Binder IPC
- Interface proxies
- Service discovery
- Callback mechanisms

**Communication Flow:**
```
Framework Service
    │
    │ Binder IPC
    │
    ▼
HAL Interface (Proxy)
    │
    │ Interface Contract
    │
    ▼
HAL Implementation (Stub)
```

### Isolation Mechanisms

#### File System Isolation

**File System Isolation:**
- Separate partitions
- Separate mount points
- Separate file systems
- Access restrictions

**Isolation Characteristics:**
- System cannot directly access vendor files
- Vendor cannot directly access system files
- Interface-based access only
- SELinux enforcement

#### Process Isolation

**Process Isolation:**
- Separate processes
- Separate UIDs
- Separate contexts
- IPC communication only

**Isolation Characteristics:**
- Process boundaries
- UID/GID isolation
- SELinux domain isolation
- Binder IPC only

#### Code Isolation

**Code Isolation:**
- Separate codebases
- Separate libraries
- Separate binaries
- Interface-based linking

**Isolation Characteristics:**
- No direct code dependencies
- Interface-based dependencies
- Versioned interfaces
- Stable API contracts

### Separation Benefits

#### Independent Updates

**Update Independence:**
- Framework can update without vendor
- Vendor can update without framework
- Faster security patches
- Easier Android version upgrades

**Update Scenarios:**
- Framework-only updates
- Vendor-only updates
- Coordinated updates
- Independent update paths

#### Security Isolation

**Security Benefits:**
- Process isolation
- File system isolation
- Code isolation
- Reduced attack surface

**Security Characteristics:**
- Vendor vulnerabilities don't affect framework
- Framework vulnerabilities don't affect vendor
- Better security boundaries
- Improved security posture

#### Testing Benefits

**Testing Benefits:**
- GSI (Generic System Image) testing
- Framework testing without vendor
- Vendor testing without framework
- Better compatibility testing

**Testing Scenarios:**
- Test framework with different vendors
- Test vendor with different frameworks
- Compatibility verification
- Integration testing

### Separation Implementation

#### Build System Separation

**Build Separation:**
- Separate build targets
- Separate build configurations
- Separate build outputs
- Independent builds

**Build Characteristics:**
- System builds independently
- Vendor builds independently
- Interface verification
- Compatibility checking

#### Runtime Separation

**Runtime Separation:**
- Separate processes
- Separate libraries
- Interface-based communication
- Runtime verification

**Runtime Characteristics:**
- Process isolation enforced
- Library isolation enforced
- Interface compliance verified
- Compatibility maintained

### Interface Contracts

#### Interface Stability

**Interface Stability:**
- Stable API contracts
- Versioned interfaces
- Backward compatibility
- Forward compatibility (within limits)

**Stability Requirements:**
- Interfaces must remain stable
- Changes require versioning
- Compatibility maintained
- Deprecation handled

#### Interface Versioning

**Version Management:**
- Major versions: Breaking changes
- Minor versions: Additive changes
- Version negotiation
- Compatibility matrix

**Version Strategy:**
- Version compatibility
- Backward compatibility
- Forward compatibility
- Deprecation policy

### Separation Enforcement

#### Build-Time Enforcement

**Build-Time Checks:**
- Interface verification
- Dependency checking
- Compatibility validation
- Build errors for violations

**Enforcement Mechanisms:**
- Build system checks
- Interface validation
- Dependency analysis
- Compatibility verification

#### Runtime Enforcement

**Runtime Checks:**
- Process isolation
- File system isolation
- SELinux enforcement
- Interface compliance

**Enforcement Mechanisms:**
- Kernel-level isolation
- SELinux policies
- Process boundaries
- Access control

### Separation Best Practices

#### Best Practices

**Best Practices:**
- Maintain clear boundaries
- Use stable interfaces
- Follow interface contracts
- Test separation
- Document interfaces

**Practice Guidelines:**
- **Boundaries:** Maintain clear boundaries
- **Interfaces:** Use stable interfaces
- **Contracts:** Follow interface contracts
- **Testing:** Test separation thoroughly
- **Documentation:** Document interfaces

## Key Takeaways

1. **System/vendor separation** refers to the architectural separation between the Android system (framework) and vendor-specific implementations (HALs, drivers, proprietary code) in Project Treble.

2. **Partition separation** includes system partition (contains Android framework, system services, framework libraries, system applications), vendor partition (contains vendor code, HAL implementations, vendor libraries, vendor binaries), and partition characteristics.

3. **Process separation** includes system processes (framework services, system server, system applications, framework components), vendor processes (vendor HAL services, vendor services, vendor applications, hardware-specific code), and process characteristics.

4. **Interface boundaries** include HAL interfaces (clear interface definitions, versioned interfaces, stable API contracts, interface-based communication), communication methods (Binder IPC, interface proxies, service discovery, callback mechanisms), and communication flow.

5. **Isolation mechanisms** include file system isolation (separate partitions, separate mount points, separate file systems, access restrictions), process isolation (separate processes, separate UIDs, separate contexts, IPC communication only), code isolation (separate codebases, separate libraries, separate binaries, interface-based linking), and isolation characteristics.

6. **Separation benefits** include independent updates (framework can update without vendor, vendor can update without framework, faster security patches, easier Android version upgrades), security isolation (process isolation, file system isolation, code isolation, reduced attack surface), testing benefits (GSI testing, framework testing without vendor, vendor testing without framework, better compatibility testing), and benefit details.

7. **Separation implementation** includes build system separation (separate build targets, separate build configurations, separate build outputs, independent builds), runtime separation (separate processes, separate libraries, interface-based communication, runtime verification), and implementation characteristics.

8. **Interface contracts** include interface stability (stable API contracts, versioned interfaces, backward compatibility, forward compatibility), version management (major versions, minor versions, version negotiation, compatibility matrix), and contract requirements.

9. **Understanding system/vendor separation** is essential for AOSP development, enabling independent updates, security isolation, faster updates, and proper separation implementation.

## Related Topics

- **Treble architecture:** Treble architecture details
- **VNDK:** VNDK details
- **GSI (Generic System Image):** GSI details

