---
number: 140
title: Bootloader chain
slug: bootloader-chain
level: advanced
tags:
  - aosp
  - security
  - bootloader
  - bootloader-chain
  - chain-of-trust
  - secure-boot
  - boot-verification
prerequisites:
  - verified-boot-avb
  - bootloader-and-fastboot
  - boot-rom
  - boot-process-overview
estimated_minutes: 95
contributors: []
diagrams: []
examples: []
canonical_id: aosp-advanced-140
---

# Bootloader chain

## Overview

Bootloader chain is the sequence of bootloader stages that execute during the Android boot process, where each stage verifies and loads the next stage, creating a chain of trust from hardware to the operating system. The bootloader chain typically consists of multiple stages (e.g., Primary Boot Loader, Secondary Boot Loader) that progressively initialize hardware and verify boot components. Understanding bootloader chain is essential for AOSP development, as it explains how bootloaders work together, how the chain of trust is established, how each stage verifies the next, how bootloader stages are organized, and how the bootloader chain integrates with verified boot. This guide provides a comprehensive overview of bootloader chain, bootloader stages, chain of trust, verification process, and bootloader chain integration.

Think of bootloader chain like a relay race: just as runners in a relay race pass a baton from one runner to the next, each bootloader stage passes control to the next stage, but in the bootloader chain, each stage also verifies the next stage before passing control, ensuring the chain of trust is maintained.

## Deep Explanation

### What is Bootloader Chain?

Bootloader chain is the sequence of bootloader stages that execute during the Android boot process, where each stage verifies and loads the next stage, creating a chain of trust from hardware to the operating system. The bootloader chain typically consists of multiple stages that progressively initialize hardware and verify boot components.

**Key Characteristics:**
- **Multi-Stage:** Multiple bootloader stages
- **Sequential:** Stages execute in sequence
- **Verification:** Each stage verifies the next
- **Chain of Trust:** Maintains chain of trust
- **Progressive:** Progressive hardware initialization

**Why Bootloader Chain?**
- **Hardware Initialization:** Progressive hardware setup
- **Security:** Maintains chain of trust
- **Flexibility:** Allows multiple bootloader stages
- **Verification:** Enables component verification

### Bootloader Stages

#### Primary Boot Loader (PBL)

**Primary Boot Loader (PBL):**
- First bootloader stage
- Loaded by Boot ROM
- Minimal hardware initialization
- Loads Secondary Boot Loader

**PBL Characteristics:**
- **First Stage:** First bootloader stage
- **ROM-Loaded:** Loaded by Boot ROM
- **Minimal:** Minimal functionality
- **SBL Loader:** Loads Secondary Boot Loader

**PBL Responsibilities:**
- Initialize basic hardware
- Load Secondary Boot Loader
- Verify Secondary Boot Loader
- Pass control to SBL

#### Secondary Boot Loader (SBL)

**Secondary Boot Loader (SBL):**
- Second bootloader stage
- Loaded by Primary Boot Loader
- More hardware initialization
- Loads kernel or next stage

**SBL Characteristics:**
- **Second Stage:** Second bootloader stage
- **PBL-Loaded:** Loaded by Primary Boot Loader
- **Extended:** Extended hardware initialization
- **Kernel Loader:** Loads kernel or next stage

**SBL Responsibilities:**
- Initialize more hardware
- Load kernel or next stage
- Verify kernel or next stage
- Pass control to kernel or next stage

#### Additional Stages

**Additional Stages:**
- Some devices have more stages
- Each stage initializes more hardware
- Each stage verifies the next
- Progressive initialization

**Stage Examples:**
- **Tertiary Boot Loader (TBL):** Third stage (if present)
- **Application Boot Loader (ABL):** Application-level bootloader
- **U-Boot:** Universal bootloader (some devices)

### Chain of Trust

#### Chain of Trust Concept

**Chain of Trust:**
- Unbroken chain from hardware to software
- Each stage verifies the next
- Root of trust in Boot ROM
- Cryptographic verification at each stage

**Chain Structure:**
```
Boot ROM (Hardware - Root of Trust)
   ↓ (verifies)
Primary Boot Loader (PBL)
   ↓ (verifies)
Secondary Boot Loader (SBL)
   ↓ (verifies)
Kernel + Ramdisk
   ↓
Android System
```

#### Verification at Each Stage

**Verification Process:**
- Each stage verifies the next before loading
- Uses cryptographic signatures
- Checks component integrity
- Prevents unauthorized code execution

**Verification Steps:**
```
1. Current stage loads next stage
2. Current stage reads next stage signature
3. Current stage verifies signature
4. If valid: Load and execute next stage
5. If invalid: Halt boot process
```

### Bootloader Chain Flow

#### Complete Boot Flow

**Complete Boot Flow:**
```
1. Device powers on
   ↓
2. Boot ROM executes
   ↓
3. Boot ROM loads Primary Boot Loader (PBL)
   ↓
4. Boot ROM verifies PBL signature
   ↓
5. PBL executes (if verified)
   ↓
6. PBL initializes basic hardware
   ↓
7. PBL loads Secondary Boot Loader (SBL)
   ↓
8. PBL verifies SBL signature
   ↓
9. SBL executes (if verified)
   ↓
10. SBL initializes more hardware
   ↓
11. SBL loads kernel and ramdisk
   ↓
12. SBL verifies kernel signature
   ↓
13. Kernel executes (if verified)
   ↓
14. Android system starts
```

#### Stage Transitions

**Stage Transitions:**
- Each stage passes control to next
- Verification before transition
- Fail-safe on verification failure
- Progressive hardware initialization

**Transition Characteristics:**
- **Verification:** Verify before transition
- **Control Transfer:** Pass control to next stage
- **Fail-Safe:** Halt on verification failure
- **Progressive:** Progressive initialization

### Hardware Initialization

#### Progressive Initialization

**Progressive Initialization:**
- Each stage initializes more hardware
- PBL: Basic hardware (clocks, memory)
- SBL: Extended hardware (storage, display)
- Kernel: Full hardware initialization

**Initialization Stages:**
- **PBL:** Basic hardware initialization
- **SBL:** Extended hardware initialization
- **Kernel:** Full hardware initialization
- **System:** Application-level initialization

#### Hardware Access

**Hardware Access:**
- Each stage has access to more hardware
- PBL: Limited hardware access
- SBL: Extended hardware access
- Kernel: Full hardware access

**Access Characteristics:**
- **Progressive:** Progressive hardware access
- **Controlled:** Controlled by bootloader stage
- **Secure:** Secure hardware initialization
- **Efficient:** Efficient initialization

### Bootloader Chain Security

#### Security Mechanisms

**Security Mechanisms:**
- Cryptographic signature verification
- Chain of trust maintenance
- Secure hardware integration
- Rollback protection

**Security Features:**
- **Signature Verification:** Verify each stage
- **Chain of Trust:** Maintain unbroken chain
- **Secure Hardware:** Integrate with secure hardware
- **Rollback Protection:** Prevent version downgrades

#### Secure Boot

**Secure Boot:**
- Bootloader chain with verification
- Each stage verified before execution
- Prevents unauthorized code execution
- Maintains system integrity

**Secure Boot Characteristics:**
- **Verification:** Verify each stage
- **Enforcement:** Enforce verification
- **Protection:** Protect against unauthorized code
- **Integrity:** Maintain system integrity

### Bootloader Chain Variants

#### Qualcomm Bootloader Chain

**Qualcomm Bootloader Chain:**
- PBL (Primary Boot Loader)
- SBL (Secondary Boot Loader)
- ABL (Application Boot Loader)
- Kernel

**Qualcomm Characteristics:**
- **PBL:** First stage, minimal initialization
- **SBL:** Second stage, extended initialization
- **ABL:** Application-level bootloader
- **Kernel:** Linux kernel

#### MediaTek Bootloader Chain

**MediaTek Bootloader Chain:**
- Preloader (in Boot ROM)
- LK (Little Kernel)
- Kernel

**MediaTek Characteristics:**
- **Preloader:** In Boot ROM
- **LK:** Little Kernel bootloader
- **Kernel:** Linux kernel

#### Generic Bootloader Chain

**Generic Bootloader Chain:**
- Boot ROM
- Primary Boot Loader
- Secondary Boot Loader
- Kernel

**Generic Characteristics:**
- **Standard Stages:** Standard bootloader stages
- **Flexible:** Flexible implementation
- **Verification:** Verification at each stage
- **Chain of Trust:** Maintains chain of trust

### Bootloader Chain Integration

#### Verified Boot Integration

**Verified Boot Integration:**
- Bootloader chain integrates with verified boot
- Each stage verifies the next
- AVB verification at appropriate stages
- Chain of trust maintained

**Integration Points:**
- **Boot ROM:** Verifies PBL
- **PBL:** Verifies SBL
- **SBL:** Verifies kernel (with AVB)
- **Kernel:** Verifies system partitions

#### Fastboot Integration

**Fastboot Integration:**
- Bootloader chain supports Fastboot
- Fastboot mode in bootloader
- Allows device flashing
- Development and recovery tool

**Fastboot Characteristics:**
- **Bootloader Mode:** Fastboot in bootloader
- **Flashing:** Allows device flashing
- **Development:** Development tool
- **Recovery:** Recovery tool

### Debugging Bootloader Chain

#### Debugging Tools

**Debugging Tools:**
- UART serial output
- JTAG debugging
- Boot logs
- Fastboot commands

**Debugging Commands:**
```bash
# Check bootloader version
fastboot getvar version-bootloader

# Check bootloader status
fastboot getvar unlocked

# View boot logs
adb shell dmesg | grep bootloader
```

#### Common Issues

**Common Issues:**
- Bootloader verification failures
- Stage transition failures
- Hardware initialization failures
- Signature verification failures

**Debugging Steps:**
1. Check bootloader version
2. Verify bootloader signatures
3. Review boot logs
4. Check hardware initialization
5. Verify chain of trust

## Key Takeaways

1. **Bootloader chain** is the sequence of bootloader stages that execute during the Android boot process, where each stage verifies and loads the next stage, creating a chain of trust.

2. **Bootloader stages** include Primary Boot Loader (PBL - first bootloader stage, loaded by Boot ROM, minimal hardware initialization), Secondary Boot Loader (SBL - second bootloader stage, loaded by PBL, more hardware initialization), additional stages (some devices have more stages, each stage initializes more hardware), and stage characteristics.

3. **Chain of trust** includes chain of trust concept (unbroken chain from hardware to software, each stage verifies the next, root of trust in Boot ROM), chain structure (Boot ROM → PBL → SBL → Kernel), verification at each stage (each stage verifies the next before loading, uses cryptographic signatures, checks component integrity), and verification steps.

4. **Bootloader chain flow** includes complete boot flow (device powers on, Boot ROM executes, PBL loads and executes, SBL loads and executes, kernel loads and executes), stage transitions (each stage passes control to next, verification before transition, fail-safe on verification failure), and transition characteristics.

5. **Hardware initialization** includes progressive initialization (each stage initializes more hardware, PBL: basic hardware, SBL: extended hardware, kernel: full hardware), hardware access (each stage has access to more hardware, progressive hardware access, controlled by bootloader stage), and initialization stages.

6. **Bootloader chain security** includes security mechanisms (cryptographic signature verification, chain of trust maintenance, secure hardware integration, rollback protection), secure boot (bootloader chain with verification, each stage verified before execution, prevents unauthorized code execution), and security features.

7. **Bootloader chain variants** include Qualcomm bootloader chain (PBL, SBL, ABL, kernel), MediaTek bootloader chain (Preloader, LK, kernel), generic bootloader chain (Boot ROM, Primary Boot Loader, Secondary Boot Loader, kernel), and variant characteristics.

8. **Bootloader chain integration** includes verified boot integration (bootloader chain integrates with verified boot, each stage verifies the next, AVB verification at appropriate stages), fastboot integration (bootloader chain supports Fastboot, Fastboot mode in bootloader, allows device flashing), and integration points.

9. **Understanding bootloader chain** is essential for AOSP development, enabling boot process understanding, chain of trust maintenance, hardware initialization, and proper bootloader chain architecture implementation.

## Related Topics

- **Verified Boot (AVB):** Verified boot details
- **Bootloader and Fastboot:** Bootloader details
- **Boot ROM:** Boot ROM details
- **Boot Process Overview:** Boot process details

