---
number: 167
title: GSI (Generic System Image)
slug: gsi-generic-system-image
level: advanced
tags:
  - aosp
  - gsi
  - generic-system-image
  - treble
  - testing
  - compatibility
prerequisites:
  - treble-architecture
  - system-vendor-separation
  - vndk
estimated_minutes: 95
contributors: []
diagrams: []
examples: []
canonical_id: aosp-advanced-167
---

# GSI (Generic System Image)

## Overview

GSI (Generic System Image) is a pure Android system image built from AOSP that can run on any Treble-compliant device, enabling testing of the Android framework with different vendor implementations and validating Treble compatibility. GSI provides a standardized system image that works across devices, allowing developers to test framework changes, verify vendor compatibility, and ensure Treble compliance. Understanding GSI is essential for AOSP development, as it explains how to test framework with different vendors, how to validate Treble compliance, how GSI works with vendor implementations, and how GSI enables better testing and compatibility verification. This guide provides a comprehensive overview of GSI, GSI purpose, GSI structure, GSI usage, GSI testing, and GSI benefits.

Think of GSI like a universal operating system: just as a universal OS can run on different hardware platforms as long as they meet certain requirements (Treble compliance), GSI can run on any Treble-compliant device, allowing you to test the Android framework independently of vendor-specific customizations. It's like a "reference implementation" that validates that vendor implementations work correctly with the standard Android framework.

## Deep Explanation

### What is GSI?

GSI (Generic System Image) is a pure Android system image built from AOSP that can run on any Treble-compliant device. GSI provides a standardized system image for testing and validation.

**Key Characteristics:**
- **Pure AOSP:** Built from AOSP source
- **Generic:** Works on any Treble-compliant device
- **Standardized:** No vendor customizations
- **Testable:** Enables framework testing
- **Compatible:** Works with vendor implementations

**Why GSI?**
- **Framework Testing:** Test framework independently
- **Compatibility Validation:** Validate vendor compatibility
- **Treble Testing:** Test Treble compliance
- **Standard Reference:** Standard reference implementation

### GSI Purpose

#### Framework Testing

**Framework Testing:**
- Test framework changes independently
- Test framework with different vendors
- Validate framework functionality
- Test framework updates

**Testing Benefits:**
- Isolate framework testing
- Test without vendor dependencies
- Validate framework changes
- Test framework compatibility

#### Vendor Compatibility Testing

**Compatibility Testing:**
- Test vendor implementations
- Validate vendor compatibility
- Test vendor HALs
- Verify vendor interfaces

**Compatibility Benefits:**
- Validate vendor compliance
- Test vendor HALs
- Verify interface compatibility
- Ensure Treble compliance

#### Treble Compliance Validation

**Treble Validation:**
- Validate Treble compliance
- Test system/vendor separation
- Verify interface boundaries
- Test independent updates

**Validation Benefits:**
- Ensure Treble compliance
- Validate separation
- Verify interfaces
- Test update mechanisms

### GSI Structure

#### GSI Components

**GSI Components:**
- Pure AOSP framework
- System services
- Framework libraries
- System applications
- No vendor code

**Component Characteristics:**
- AOSP-only code
- No vendor customizations
- Standard Android framework
- Generic implementations

#### GSI Image Structure

**Image Structure:**
```
GSI System Image
├── /system/          - Framework code
├── /system_ext/      - System extensions
├── /product/         - Product features
└── Framework manifest - Framework requirements
```

**Partition Layout:**
- System partition: Framework code
- System_ext partition: System extensions
- Product partition: Product features
- No vendor partition (uses device's vendor)

### GSI Usage

#### GSI Installation

**Installation Process:**
```
1. Download GSI image
2. Unlock device bootloader
3. Flash GSI to system partition
4. Reboot device
5. GSI runs with device's vendor
```

**Installation Requirements:**
- Treble-compliant device
- Unlocked bootloader
- Fastboot access
- Compatible Android version

#### GSI Flashing

**Flashing Methods:**
```bash
# Fastboot flashing
fastboot flash system system.img

# Or using fastbootd (dynamic partitions)
fastboot flash system system.img
fastboot flash system_ext system_ext.img
fastboot flash product product.img
```

**Flashing Process:**
- Flash system partition
- Flash system_ext partition (if present)
- Flash product partition (if present)
- Reboot device

### GSI Testing

#### Framework Testing

**Framework Test Scenarios:**
- Test framework changes
- Test framework updates
- Test framework compatibility
- Test framework functionality

**Testing Approach:**
- Install GSI on device
- Test framework features
- Validate functionality
- Test with vendor HALs

#### Vendor Compatibility Testing

**Compatibility Test Scenarios:**
- Test vendor HALs with GSI
- Validate vendor interfaces
- Test vendor compatibility
- Verify Treble compliance

**Testing Approach:**
- Install GSI on device
- Test vendor HALs
- Validate interfaces
- Verify compatibility

#### Integration Testing

**Integration Test Scenarios:**
- Test framework-vendor integration
- Test HAL interactions
- Test service communication
- Test system functionality

**Testing Approach:**
- Install GSI
- Test full system
- Validate integration
- Test functionality

### GSI Benefits

#### Independent Framework Testing

**Testing Benefits:**
- Test framework without vendor
- Isolate framework issues
- Test framework changes
- Validate framework functionality

**Benefit Details:**
- Framework testing isolation
- Vendor-independent testing
- Framework change validation
- Framework functionality testing

#### Vendor Validation

**Validation Benefits:**
- Validate vendor implementations
- Test vendor compatibility
- Verify vendor compliance
- Test vendor HALs

**Benefit Details:**
- Vendor implementation validation
- Compatibility verification
- Compliance testing
- HAL testing

#### Standard Reference

**Reference Benefits:**
- Standard reference implementation
- Baseline for testing
- Comparison standard
- Compatibility baseline

**Benefit Details:**
- Reference implementation
- Testing baseline
- Comparison standard
- Compatibility reference

### GSI Limitations

#### Device-Specific Limitations

**Limitations:**
- Device-specific features may not work
- Vendor customizations missing
- Device-specific optimizations absent
- Some hardware may not work

**Limitation Details:**
- Missing device features
- No vendor customizations
- Generic implementations
- Hardware compatibility

#### Testing Limitations

**Testing Limitations:**
- May not test all device features
- Vendor-specific features untested
- Device optimizations untested
- Some scenarios not covered

**Limitation Details:**
- Limited feature coverage
- Vendor features untested
- Device optimizations untested
- Testing gaps

### GSI Build Process

#### Building GSI

**Build Process:**
```bash
# Build GSI
source build/envsetup.sh
lunch aosp_arm64-userdebug
make -j$(nproc)

# GSI images in:
# out/target/product/generic_arm64/system.img
```

**Build Characteristics:**
- Build from AOSP source
- Generic device target
- No vendor code
- Pure framework build

#### GSI Variants

**GSI Variants:**
- **user:** Production GSI
- **userdebug:** Debug GSI (root access)
- **eng:** Engineering GSI (full debug)

**Variant Selection:**
- Choose based on testing needs
- userdebug for development
- user for production testing
- eng for full debugging

### GSI Compatibility

#### Treble Compliance

**Compliance Requirements:**
- Device must be Treble-compliant
- Vendor must implement required HALs
- Interfaces must be compatible
- VINTF compliance required

**Compliance Verification:**
- VTS testing
- Interface verification
- Manifest validation
- Compatibility checking

#### Version Compatibility

**Version Requirements:**
- GSI version matches device Android version
- Vendor HAL versions compatible
- Interface versions compatible
- VNDK versions compatible

**Compatibility Checking:**
- Version verification
- Interface compatibility
- VNDK compatibility
- HAL version compatibility

### GSI Best Practices

#### Best Practices

**Best Practices:**
- Use GSI for framework testing
- Test with different vendors
- Validate Treble compliance
- Test compatibility thoroughly
- Document test results

**Practice Guidelines:**
- **Testing:** Use GSI for framework testing
- **Vendors:** Test with different vendors
- **Compliance:** Validate Treble compliance
- **Testing:** Test compatibility thoroughly
- **Documentation:** Document test results

## Key Takeaways

1. **GSI (Generic System Image)** is a pure Android system image built from AOSP that can run on any Treble-compliant device, enabling testing of the Android framework with different vendor implementations.

2. **GSI purpose** includes framework testing (test framework changes independently, test framework with different vendors, validate framework functionality), vendor compatibility testing (test vendor implementations, validate vendor compatibility, test vendor HALs), Treble compliance validation (validate Treble compliance, test system/vendor separation, verify interface boundaries), and purpose details.

3. **GSI structure** includes GSI components (pure AOSP framework, system services, framework libraries, system applications, no vendor code), GSI image structure (system partition, system_ext partition, product partition, framework manifest), and structure details.

4. **GSI usage** includes GSI installation (download GSI image, unlock device bootloader, flash GSI to system partition, reboot device), GSI flashing (fastboot flashing, fastbootd flashing, flashing process), and usage methods.

5. **GSI testing** includes framework testing (test framework changes, test framework updates, test framework compatibility, test framework functionality), vendor compatibility testing (test vendor HALs with GSI, validate vendor interfaces, test vendor compatibility, verify Treble compliance), integration testing (test framework-vendor integration, test HAL interactions, test service communication, test system functionality), and testing approaches.

6. **GSI benefits** include independent framework testing (test framework without vendor, isolate framework issues, test framework changes, validate framework functionality), vendor validation (validate vendor implementations, test vendor compatibility, verify vendor compliance, test vendor HALs), standard reference (standard reference implementation, baseline for testing, comparison standard, compatibility baseline), and benefit details.

7. **GSI limitations** include device-specific limitations (device-specific features may not work, vendor customizations missing, device-specific optimizations absent, some hardware may not work), testing limitations (may not test all device features, vendor-specific features untested, device optimizations untested, some scenarios not covered), and limitation details.

8. **GSI build process** includes building GSI (build from AOSP source, generic device target, no vendor code, pure framework build), GSI variants (user, userdebug, eng), variant selection, and build process details.

9. **Understanding GSI** is essential for AOSP development, enabling framework testing, vendor validation, Treble compliance validation, and proper GSI usage.

## Related Topics

- **Treble architecture:** Treble architecture details
- **System/vendor separation:** Separation details
- **VNDK:** VNDK details

