---
number: 166
title: VNDK
slug: vndk
level: advanced
tags:
  - aosp
  - vndk
  - vendor-ndk
  - treble
  - libraries
  - compatibility
prerequisites:
  - treble-architecture
  - system-vendor-separation
  - loading-libs-from-system-partitions
estimated_minutes: 95
contributors: []
diagrams: []
examples: []
canonical_id: aosp-advanced-166
---

# VNDK

## Overview

VNDK (Vendor Native Development Kit) is a set of system libraries that vendors can use in their HAL implementations, providing stable ABI/API interfaces that enable vendor code to work with different framework versions. VNDK libraries are versioned, have stable ABIs, and are designed to maintain compatibility between framework updates and vendor implementations. Understanding VNDK is essential for AOSP development, as it explains how vendor code can use system libraries, how VNDK libraries are versioned, how VNDK maintains compatibility, how VNDK libraries are organized, and how VNDK enables Treble compliance. This guide provides a comprehensive overview of VNDK, VNDK library organization, versioning, compatibility, usage, and VNDK best practices.

Think of VNDK like a standardized library system: just as a public library provides standardized books (VNDK libraries) that anyone can use (vendor code), with versioned editions (VNDK versions) that maintain compatibility, VNDK provides standardized system libraries that vendor code can use, with versioned libraries that maintain compatibility across framework updates.

## Deep Explanation

### What is VNDK?

VNDK (Vendor Native Development Kit) is a set of system libraries that vendors can use in their HAL implementations, providing stable ABI/API interfaces that enable vendor code to work with different framework versions. VNDK ensures compatibility between framework and vendor.

**Key Characteristics:**
- **Stable Libraries:** Stable ABI/API libraries
- **Versioned:** Versioned libraries
- **Vendor-Accessible:** Accessible to vendor code
- **Compatibility:** Maintains compatibility
- **Treble Support:** Enables Treble compliance

**Why VNDK?**
- **Vendor Libraries:** Vendors need system libraries
- **Compatibility:** Maintain framework-vendor compatibility
- **Stability:** Stable interfaces for vendor code
- **Updates:** Enable independent updates

### VNDK Library Organization

#### VNDK Library Types

**VNDK Library Categories:**
- **VNDK Core:** Core VNDK libraries
- **VNDK-SP:** VNDK Same-Process libraries
- **VNDK-Private:** Private VNDK libraries
- **LL-NDK:** Low-Level NDK libraries

**Library Characteristics:**
- Stable ABI/API
- Versioned
- Vendor-accessible
- Framework-compatible

#### VNDK Directory Structure

**VNDK Directories:**
```
/system/lib64/vndk-<version>/
├── libbase.so
├── liblog.so
├── libutils.so
└── ...

/vendor/lib64/vndk/
├── libbase.so -> /system/lib64/vndk-<version>/libbase.so
└── ...
```

**Directory Organization:**
- System: `/system/lib64/vndk-<version>/`
- Vendor: `/vendor/lib64/vndk/`
- Version-specific directories
- Symbolic links

### VNDK Versioning

#### Version Management

**VNDK Versions:**
- Versioned by Android release
- Each Android version has VNDK version
- Backward compatibility maintained
- Forward compatibility (within limits)

**Version Format:**
- `vndk-<version>` (e.g., `vndk-30` for Android 11)
- Version corresponds to API level
- Multiple versions can coexist

#### Version Compatibility

**Compatibility Rules:**
- Vendor code uses specific VNDK version
- Framework provides VNDK version
- Compatibility verified at build time
- Runtime compatibility checked

**Compatibility Matrix:**
- Vendor VNDK version ↔ Framework VNDK version
- Compatibility requirements
- Version negotiation
- Compatibility testing

### VNDK Library Usage

#### Vendor Library Usage

**Vendor Code Usage:**
```cpp
// Vendor HAL implementation
#include <base/logging.h>
#include <utils/StrongPointer.h>

// Use VNDK libraries
LOG(INFO) << "Vendor HAL initialized";
sp<MyObject> obj = new MyObject();
```

**Usage Characteristics:**
- Vendor code links against VNDK
- VNDK libraries available at runtime
- Stable ABI/API
- Version-specific libraries

#### Library Linking

**Linking Process:**
```
Vendor HAL
    │
    │ Links against
    │
    ▼
VNDK Libraries
    │
    │ Runtime loading
    │
    ▼
System VNDK Directory
```

**Linking Methods:**
- Build-time linking
- Runtime loading
- Symbol resolution
- Version matching

### VNDK Library Categories

#### VNDK Core Libraries

**VNDK Core:**
- Core system libraries
- Commonly used libraries
- Stable interfaces
- Vendor-accessible

**Core Libraries:**
- libbase
- liblog
- libutils
- libcutils
- And more

#### VNDK-SP Libraries

**VNDK-SP (Same-Process):**
- Libraries used in same process
- Process-local libraries
- Limited sharing
- Specific use cases

**VNDK-SP Characteristics:**
- Same-process usage
- Limited scope
- Specific requirements
- Process isolation

#### LL-NDK Libraries

**LL-NDK (Low-Level NDK):**
- Low-level system libraries
- Kernel interface libraries
- Minimal dependencies
- Core functionality

**LL-NDK Libraries:**
- libc
- libm
- libdl
- And more

### VNDK Build System

#### VNDK Module Definition

**VNDK Module:**
```bp
cc_library {
    name: "libexample_vndk",
    vendor_available: true,
    vndk: {
        enabled: true,
    },
    srcs: ["example.cpp"],
    shared_libs: [
        "libbase",
        "liblog",
    ],
}
```

**VNDK Characteristics:**
- `vendor_available: true`
- `vndk: { enabled: true }`
- Stable ABI/API
- Version management

#### VNDK Build Output

**Build Output:**
- VNDK libraries in system partition
- Versioned directories
- Symbolic links in vendor
- Compatibility verification

**Output Structure:**
```
out/target/product/<device>/system/lib64/vndk-<version>/
out/target/product/<device>/vendor/lib64/vndk/
```

### VNDK Compatibility

#### ABI Stability

**ABI Stability:**
- Stable ABI across versions
- Backward compatibility
- Symbol versioning
- ABI verification

**Stability Requirements:**
- ABI must remain stable
- Changes require versioning
- Compatibility maintained
- Deprecation handled

#### API Stability

**API Stability:**
- Stable API across versions
- Backward compatibility
- API versioning
- API verification

**Stability Requirements:**
- API must remain stable
- Changes require versioning
- Compatibility maintained
- Deprecation handled

### VNDK Testing

#### VNDK-SP Testing

**VNDK-SP Tests:**
- ABI compatibility tests
- API compatibility tests
- Version compatibility tests
- Integration tests

**Testing Tools:**
- VNDK-SP test suite
- ABI checker
- API checker
- Compatibility verifier

#### VTS Integration

**VTS Integration:**
- VNDK testing in VTS
- Compatibility verification
- ABI/API validation
- Integration testing

**VTS Tests:**
- VNDK library tests
- Compatibility tests
- Version tests
- Integration tests

### VNDK Best Practices

#### Best Practices

**Best Practices:**
- Use VNDK libraries when available
- Avoid direct framework dependencies
- Maintain ABI/API stability
- Test with VTS
- Document VNDK usage

**Practice Guidelines:**
- **VNDK Libraries:** Use VNDK libraries when available
- **Dependencies:** Avoid direct framework dependencies
- **Stability:** Maintain ABI/API stability
- **Testing:** Test with VTS
- **Documentation:** Document VNDK usage

## Key Takeaways

1. **VNDK (Vendor Native Development Kit)** is a set of system libraries that vendors can use in their HAL implementations, providing stable ABI/API interfaces that enable vendor code to work with different framework versions.

2. **VNDK library organization** includes VNDK library types (VNDK Core, VNDK-SP, VNDK-Private, LL-NDK), VNDK directory structure (system directories, vendor directories, version-specific directories, symbolic links), and library organization.

3. **VNDK versioning** includes version management (versioned by Android release, each Android version has VNDK version, backward compatibility maintained), version compatibility (vendor code uses specific VNDK version, framework provides VNDK version, compatibility verified at build time), and version characteristics.

4. **VNDK library usage** includes vendor library usage (vendor code links against VNDK, VNDK libraries available at runtime, stable ABI/API), library linking (build-time linking, runtime loading, symbol resolution, version matching), and usage methods.

5. **VNDK library categories** include VNDK Core libraries (core system libraries, commonly used libraries, stable interfaces), VNDK-SP libraries (libraries used in same process, process-local libraries, limited sharing), LL-NDK libraries (low-level system libraries, kernel interface libraries, minimal dependencies), and library categories.

6. **VNDK build system** includes VNDK module definition (vendor_available, vndk enabled, stable ABI/API, version management), VNDK build output (VNDK libraries in system partition, versioned directories, symbolic links in vendor, compatibility verification), and build system details.

7. **VNDK compatibility** includes ABI stability (stable ABI across versions, backward compatibility, symbol versioning, ABI verification), API stability (stable API across versions, backward compatibility, API versioning, API verification), and stability requirements.

8. **VNDK testing** includes VNDK-SP testing (ABI compatibility tests, API compatibility tests, version compatibility tests, integration tests), VTS integration (VNDK testing in VTS, compatibility verification, ABI/API validation, integration testing), and testing methods.

9. **Understanding VNDK** is essential for AOSP development, enabling vendor library usage, framework-vendor compatibility, stable interfaces, and proper VNDK implementation.

## Related Topics

- **Treble architecture:** Treble architecture details
- **System/vendor separation:** Separation details
- **GSI (Generic System Image):** GSI details

