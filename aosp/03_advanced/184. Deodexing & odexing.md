---
number: 184
title: Deodexing & odexing
slug: deodexing-odexing
level: advanced
tags:
  - aosp
  - deodexing
  - odexing
  - dex
  - odex
  - optimization
  - rom-development
prerequisites:
  - oat-vdex-files
  - dex2oat
  - art-boot-image-dex-pre-optimization
estimated_minutes: 95
contributors: []
diagrams: []
examples: []
canonical_id: aosp-advanced-184
---

# Deodexing & odexing

## Overview

Deodexing and odexing refer to processes for managing ODEX (Optimized DEX) files in Android ROMs. Deodexing involves extracting DEX files from ODEX files and combining them back into APKs, while odexing involves optimizing DEX files into ODEX format for faster execution. Understanding deodexing and odexing is essential for AOSP development, as it explains how ODEX files work, how to deodex ROMs for customization, how to odex for performance, and how these processes affect ROM development and customization. This guide provides a comprehensive overview of deodexing and odexing, ODEX file format, deodexing process, odexing process, use cases, and best practices.

Think of deodexing and odexing like unpacking and repacking optimized code: just as you might unpack an optimized software package to modify it, then repack it for better performance, deodexing extracts optimized DEX files from ODEX format to allow customization, while odexing optimizes DEX files into ODEX format for better performance. Deodexed ROMs are easier to customize, while odexed ROMs have better performance.

## Deep Explanation

### What are Deodexing & Odexing?

Deodexing and odexing refer to processes for managing ODEX (Optimized DEX) files in Android ROMs. Deodexing extracts DEX from ODEX files, while odexing optimizes DEX into ODEX format.

**Key Characteristics:**
- **Deodexing:** Extract DEX from ODEX
- **Odexing:** Optimize DEX to ODEX
- **ROM Customization:** Enable customization
- **Performance:** Optimize performance
- **Format Conversion:** DEX ↔ ODEX conversion

**Why Deodexing & Odexing?**
- **Customization:** Enable ROM customization
- **Performance:** Optimize app performance
- **ROM Development:** ROM development support
- **Modification:** Enable app modification
- **Optimization:** Performance optimization

### ODEX File Format

#### ODEX Overview

**ODEX (Optimized DEX):**
- Pre-optimized DEX format
- Contains optimized bytecode
- ART: Contains native code
- Faster execution
- Created by dex2oat

**ODEX Characteristics:**
- Optimized format
- Performance benefits
- Architecture-specific
- Faster loading
- Better execution

#### ODEX File Structure

**ODEX Structure:**
```
ODEX File (ART)
├── ELF Header
├── Native Code (compiled methods)
├── DEX Data (optional)
└── Metadata
```

**Structure Characteristics:**
- ELF format (ART)
- Native code
- DEX data (optional)
- Metadata
- Architecture-specific

### Deodexing Process

#### What is Deodexing?

**Deodexing:**
- Extract DEX from ODEX files
- Combine DEX files into APKs
- Remove ODEX files
- Create deodexed ROM
- Enable customization

**Deodexing Purpose:**
- Enable app modification
- Allow resource customization
- Simplify ROM customization
- Enable theming
- Support modding

#### Deodexing Steps

**Deodexing Process:**
```
1. Extract ODEX files
2. Extract DEX from ODEX
3. Combine DEX files
4. Insert DEX into APK
5. Remove ODEX files
6. Create deodexed ROM
```

**Process Characteristics:**
- ODEX extraction
- DEX extraction
- DEX combination
- APK modification
- ODEX removal
- ROM creation

#### Deodexing Tools

**Deodexing Tools:**
- `baksmali` - Disassemble ODEX
- `smali` - Assemble DEX
- `deodex` scripts - Automated deodexing
- Custom tools - ROM-specific tools

**Tool Usage:**
```bash
# Extract DEX from ODEX
baksmali deodex app.odex -o output/

# Assemble DEX
smali assemble output/ -o classes.dex

# Insert into APK
zip -u app.apk classes.dex
```

**Tool Characteristics:**
- ODEX disassembly
- DEX assembly
- APK modification
- Automation support
- Tool integration

### Odexing Process

#### What is Odexing?

**Odexing:**
- Optimize DEX to ODEX
- Create optimized files
- Improve performance
- Pre-compile code
- Generate native code

**Odexing Purpose:**
- Improve performance
- Faster app startup
- Better execution
- Pre-optimization
- Performance gains

#### Odexing Steps

**Odexing Process:**
```
1. Extract DEX from APK
2. Run dex2oat
3. Create ODEX file
4. Store ODEX file
5. Update APK references
```

**Process Characteristics:**
- DEX extraction
- dex2oat compilation
- ODEX creation
- File storage
- Reference updates

#### Odexing Tools

**Odexing Tools:**
- `dex2oat` - DEX to OAT compiler
- Build system - Automatic odexing
- Custom scripts - Manual odexing

**Tool Usage:**
```bash
# Odex with dex2oat
dex2oat \
    --dex-file=app.dex \
    --oat-file=app.odex \
    --compiler-filter=speed \
    --instruction-set=arm64
```

**Tool Characteristics:**
- DEX compilation
- ODEX generation
- Optimization levels
- Architecture support
- Build integration

### Use Cases

#### Deodexing Use Cases

**Deodexing Scenarios:**
- ROM customization
- App modification
- Theming support
- Resource customization
- Modding support

**Use Case Characteristics:**
- Customization needs
- Modification requirements
- Theming support
- Resource changes
- Development support

#### Odexing Use Cases

**Odexing Scenarios:**
- Performance optimization
- Faster app startup
- Better execution speed
- Pre-optimization
- Production builds

**Use Case Characteristics:**
- Performance focus
- Startup optimization
- Execution optimization
- Production readiness
- Optimization benefits

### ROM Development

#### Deodexed ROMs

**Deodexed ROM Characteristics:**
- Easier to customize
- App modification possible
- Theming support
- Resource customization
- Larger file size

**Deodexed ROM Benefits:**
- Customization flexibility
- Modification support
- Theming capability
- Resource changes
- Development friendly

#### Odexed ROMs

**Odexed ROM Characteristics:**
- Better performance
- Faster startup
- Optimized execution
- Smaller APK size
- Harder to customize

**Odexed ROM Benefits:**
- Performance gains
- Faster startup
- Better execution
- Storage efficiency
- Production ready

### Process Comparison

#### Deodexing vs Odexing

**Deodexing:**
- Extract DEX from ODEX
- Combine into APK
- Enable customization
- Larger file size
- Easier modification

**Odexing:**
- Optimize DEX to ODEX
- Improve performance
- Faster execution
- Smaller APK size
- Harder modification

**Comparison:**
- Opposite processes
- Different goals
- Trade-offs
- Use case dependent
- Complementary processes

### Best Practices

#### Best Practices

**Best Practices:**
- Choose based on use case
- Test thoroughly
- Understand trade-offs
- Document process
- Maintain compatibility

**Practice Guidelines:**
- **Use Case:** Choose based on use case
- **Testing:** Test thoroughly
- **Trade-offs:** Understand trade-offs
- **Documentation:** Document process
- **Compatibility:** Maintain compatibility

## Key Takeaways

1. **Deodexing and odexing** refer to processes for managing ODEX (Optimized DEX) files in Android ROMs, with deodexing extracting DEX from ODEX and odexing optimizing DEX to ODEX.

2. **ODEX file format** includes ODEX overview (pre-optimized DEX format, contains optimized bytecode, ART contains native code, faster execution, created by dex2oat), ODEX file structure (ELF format, native code, DEX data optional, metadata, architecture-specific), and format characteristics.

3. **Deodexing process** includes what is deodexing (extract DEX from ODEX files, combine DEX files into APKs, remove ODEX files, create deodexed ROM, enable customization), deodexing steps (extract ODEX files, extract DEX from ODEX, combine DEX files, insert DEX into APK, remove ODEX files, create deodexed ROM), deodexing tools (baksmali, smali, deodex scripts, custom tools), and process characteristics.

4. **Odexing process** includes what is odexing (optimize DEX to ODEX, create optimized files, improve performance, pre-compile code, generate native code), odexing steps (extract DEX from APK, run dex2oat, create ODEX file, store ODEX file, update APK references), odexing tools (dex2oat, build system, custom scripts), and process characteristics.

5. **Use cases** include deodexing use cases (ROM customization, app modification, theming support, resource customization, modding support), odexing use cases (performance optimization, faster app startup, better execution speed, pre-optimization, production builds), and use case characteristics.

6. **ROM development** includes deodexed ROMs (easier to customize, app modification possible, theming support, resource customization, larger file size), odexed ROMs (better performance, faster startup, optimized execution, smaller APK size, harder to customize), and ROM characteristics.

7. **Process comparison** includes deodexing vs odexing (extract DEX from ODEX vs optimize DEX to ODEX, enable customization vs improve performance, larger file size vs smaller APK size, easier modification vs harder modification), comparison details, and process characteristics.

8. **Understanding deodexing and odexing** is essential for AOSP development, enabling ROM customization, performance optimization, ROM development support, app modification, and proper ODEX file management.

## Related Topics

- **OAT & VDEX files:** OAT/VDEX details
- **dex2oat:** dex2oat details
- **ART boot image & dex pre-optimization:** Optimization details

