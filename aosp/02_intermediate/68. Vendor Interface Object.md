---
number: 68
title: Vendor Interface Object
slug: vendor-interface-object
level: intermediate
tags:
  - aosp
  - vio
  - vendor-interface
  - treble
  - hal
  - manifest
  - compatibility
prerequisites:
  - aidl-based-hals
  - stability-annotations
  - android-architecture-complete-overview
estimated_minutes: 75
contributors: []
diagrams: []
examples: []
canonical_id: aosp-intermediate-68
---

# Vendor Interface Object

## Overview

Vendor Interface Object (VIO) is a mechanism in Android that allows the framework to query vendor capabilities and HAL implementations at runtime, enabling the framework to discover what hardware interfaces are available and how to interact with them. Understanding Vendor Interface Object is essential for AOSP development, as it enables framework-vendor communication, supports Project Treble compatibility, allows runtime HAL discovery, and provides a standardized way for the framework to query vendor capabilities. This guide provides a comprehensive overview of Vendor Interface Object, its purpose, how it works, manifest files, and its role in Project Treble.

Think of Vendor Interface Object like a product catalog: just as a product catalog lists what products are available, their features, and how to order them, Vendor Interface Object lists what HAL implementations are available, their capabilities, and how the framework can use them. The framework can query this "catalog" at runtime to discover and use vendor hardware interfaces.

## Deep Explanation

### What is Vendor Interface Object?

Vendor Interface Object (VIO) is a runtime mechanism that allows the Android framework to discover and query vendor HAL implementations and capabilities. It provides a standardized way for the framework to understand what hardware interfaces are available from the vendor.

**Key Characteristics:**
- **Runtime Discovery:** Framework queries vendor capabilities at runtime
- **Standardized Interface:** Consistent way to query HALs
- **Treble Compatible:** Enables framework-vendor separation
- **Manifest-Based:** Uses XML manifests to describe capabilities

**Why Vendor Interface Object?**
- **HAL Discovery:** Framework needs to know what HALs are available
- **Capability Querying:** Framework queries hardware capabilities
- **Treble Support:** Enables independent framework/vendor updates
- **Standardization:** Consistent interface for all vendors

### VIO vs VINTF

#### Vendor Interface Object (VIO)

**What It Is:**
- Runtime query mechanism
- Framework queries vendor
- Discovers HAL implementations
- Queries capabilities

**Purpose:**
- Runtime discovery
- Capability querying
- HAL enumeration
- Interface discovery

#### VINTF (Vendor Interface Object Tree)

**What It Is:**
- Complete framework for vendor interfaces
- Includes VIO functionality
- Manifest management
- Compatibility checking

**Purpose:**
- Comprehensive vendor interface management
- Manifest validation
- Compatibility verification
- VIO is part of VINTF

**Relationship:**
- VIO is a component of VINTF
- VINTF provides broader functionality
- VIO focuses on runtime queries
- VINTF includes manifest management

### VIO Architecture

#### Architecture Overview

**Framework Side:**
```
Android Framework
     │
     │ Queries VIO
     │
     ▼
VIO Client API
     │
     │ IPC/Binder
     │
     ▼
VIO Service
```

**Vendor Side:**
```
VIO Service
     │
     │ Reads manifest
     │
     ▼
Vendor Manifest
     │
     │ Describes HALs
     │
     ▼
HAL Implementations
```

#### VIO Components

**VIO Client API:**
- Framework uses to query vendor
- Standardized API
- Runtime queries
- Capability discovery

**VIO Service:**
- Vendor-side service
- Responds to queries
- Reads vendor manifest
- Returns capability information

**Vendor Manifest:**
- XML file describing HALs
- Lists available interfaces
- Describes capabilities
- Version information

### VIO Query Mechanism

#### Querying HAL Availability

**Framework Query:**
```cpp
// Framework queries if HAL is available
bool isAvailable = VintfObject::getInstance()->isHalAvailable(
    "android.hardware.example", "default");
```

**VIO Response:**
- Returns availability status
- Can check specific instances
- Runtime determination
- Based on manifest

#### Querying HAL Capabilities

**Framework Query:**
```cpp
// Framework queries HAL capabilities
std::vector<std::string> instances = 
    VintfObject::getInstance()->listHalInstances("android.hardware.example");
```

**VIO Response:**
- Returns available instances
- Lists capabilities
- Version information
- Interface details

### Vendor Manifest

#### Manifest Structure

**Location:**
- `/vendor/manifest.xml` (device manifest)
- Describes vendor HALs
- Lists available interfaces
- Version information

**Basic Structure:**
```xml
<manifest version="1.0" type="device">
    <hal format="aidl">
        <name>android.hardware.example</name>
        <version>1</version>
        <interface>
            <name>IExample</name>
            <instance>default</instance>
        </interface>
    </hal>
</manifest>
```

#### Manifest Elements

**hal Element:**
- Describes a HAL implementation
- Format: "aidl" or "hidl"
- Name and version
- Interface definitions

**interface Element:**
- Describes HAL interface
- Interface name
- Instance names
- Version information

**Instance:**
- Specific HAL instance
- Multiple instances supported
- Identified by name
- "default" is common

### VIO API Usage

#### Framework Usage

**Checking HAL Availability:**
```cpp
#include <vintf/VintfObject.h>

using android::vintf::VintfObject;

// Check if HAL is available
bool available = VintfObject::getInstance()->isHalAvailable(
    "android.hardware.example", "default");
    
if (available) {
    // HAL is available, can use it
}
```

**Listing HAL Instances:**
```cpp
// List all instances of a HAL
std::vector<std::string> instances = 
    VintfObject::getInstance()->listHalInstances("android.hardware.example");
    
for (const auto& instance : instances) {
    // Process each instance
}
```

**Querying HAL Version:**
```cpp
// Get HAL version
std::string version = VintfObject::getInstance()->getHalVersion(
    "android.hardware.example", "default");
```

### VIO and Project Treble

#### Treble Context

**Project Treble:**
- Separates framework and vendor
- Requires stable interfaces
- Enables independent updates
- Uses VIO for discovery

**VIO's Role:**
- Enables runtime discovery
- Framework queries vendor capabilities
- No compile-time coupling
- Supports independent updates

#### Framework-Vendor Communication

**Before VIO:**
- Framework compiled with HAL knowledge
- Tight coupling
- Required recompilation
- Difficult updates

**With VIO:**
- Framework queries at runtime
- Loose coupling
- No recompilation needed
- Easier updates

### VIO Manifest Examples

#### AIDL HAL Manifest

**AIDL HAL Declaration:**
```xml
<manifest version="1.0" type="device">
    <hal format="aidl">
        <name>android.hardware.example</name>
        <version>1</version>
        <fqname>IExample/default</fqname>
    </hal>
</manifest>
```

**Elements:**
- `format="aidl"`: AIDL HAL
- `name`: HAL package name
- `version`: HAL version
- `fqname`: Fully qualified name (interface/instance)

#### HIDL HAL Manifest

**HIDL HAL Declaration:**
```xml
<manifest version="1.0" type="device">
    <hal format="hidl">
        <name>android.hardware.example</name>
        <version>1.0</version>
        <interface>
            <name>IExample</name>
            <instance>default</instance>
        </interface>
    </hal>
</manifest>
```

**Elements:**
- `format="hidl"`: HIDL HAL
- `name`: HAL package name
- `version`: HAL version (e.g., "1.0")
- `interface`: Interface definition

### VIO Service Implementation

#### Vendor-Side Service

**Service Purpose:**
- Responds to framework queries
- Reads vendor manifest
- Returns capability information
- Manages HAL discovery

**Implementation:**
- Part of VINTF framework
- Runs in vendor process
- Accesses vendor manifest
- Provides query responses

### VIO Best Practices

#### Manifest Maintenance

**Keep Manifest Updated:**
- Update when HALs change
- Reflect actual capabilities
- Version information accurate
- Instance names correct

**Manifest Validation:**
- Validate against schema
- Check for errors
- Ensure completeness
- Test with VTS

#### Framework Usage

**Query Before Use:**
- Always check availability
- Handle missing HAL gracefully
- Check version compatibility
- Use appropriate fallbacks

**Error Handling:**
- Handle query failures
- Graceful degradation
- Log errors appropriately
- Provide user feedback

### VIO Debugging

#### Common Issues

**HAL Not Found:**
- Check manifest file
- Verify HAL name
- Check instance name
- Review manifest location

**Query Failures:**
- Check VIO service
- Verify manifest format
- Review error logs
- Check permissions

#### Debugging Tools

**Manifest Inspection:**
```bash
# View vendor manifest
adb shell cat /vendor/manifest.xml

# Check manifest format
adb shell vintf
```

**Runtime Queries:**
```bash
# List available HALs
adb shell lshal

# Check specific HAL
adb shell lshal | grep example
```

### VIO and Compatibility

#### Version Compatibility

**Interface Versioning:**
- Framework queries version
- Checks compatibility
- Uses appropriate version
- Handles version mismatches

**Backward Compatibility:**
- Framework supports multiple versions
- Vendor implements specific version
- VIO enables version discovery
- Compatibility maintained

## Key Takeaways

1. **Vendor Interface Object (VIO)** is a runtime mechanism that allows the framework to discover and query vendor HAL implementations and capabilities.

2. **VIO enables runtime discovery** of HAL availability, instances, and capabilities, allowing the framework to adapt to different vendor implementations.

3. **Vendor manifest** (`/vendor/manifest.xml`) describes available HALs, their interfaces, instances, and versions, which VIO uses to respond to queries.

4. **VIO is part of VINTF** (Vendor Interface Object Tree), which provides comprehensive vendor interface management including manifest validation and compatibility checking.

5. **VIO supports Project Treble** by enabling loose coupling between framework and vendor, allowing independent updates without recompilation.

6. **Framework uses VIO API** to query HAL availability, list instances, and check versions at runtime, enabling dynamic HAL discovery.

7. **VIO manifests** describe both AIDL and HIDL HALs, with different formats but similar purpose of declaring available interfaces.

8. **Understanding Vendor Interface Object** is essential for AOSP development, Treble compatibility, and creating HAL implementations that can be discovered and used by the framework.

## Related Topics

- **VINTF:** Complete Vendor Interface Object Tree framework
- **AIDL-based HALs:** Modern HAL implementations using AIDL
- **Stability annotations:** @VintfStability for HAL interfaces
- **Android Architecture - Complete Overview:** How VIO fits into overall architecture

