---
number: 70
title: VTS (Vendor Test Suite)
slug: vts-vendor-test-suite
level: intermediate
tags:
  - aosp
  - vts
  - vendor-test-suite
  - testing
  - treble
  - compatibility
  - hal-testing
prerequisites:
  - vintf
  - aidl-based-hals
  - vendor-interface-object
estimated_minutes: 80
contributors: []
diagrams: []
examples: []
canonical_id: aosp-intermediate-70
---

# VTS (Vendor Test Suite)

## Overview

VTS (Vendor Test Suite) is an automated testing framework that validates vendor HAL implementations for compatibility with the Android framework, ensuring that vendor code meets Project Treble requirements and works correctly with framework updates. Understanding VTS is essential for AOSP development, as it ensures HAL compatibility, validates VINTF compliance, enables Treble certification, and provides automated testing for vendor implementations. This guide provides a comprehensive overview of VTS, its purpose, test structure, how to run tests, and its role in Project Treble.

Think of VTS like a quality assurance system: just as a quality assurance system tests products to ensure they meet specifications and work correctly, VTS tests vendor HAL implementations to ensure they meet Android's interface requirements and work correctly with the framework. It automates compatibility testing, validates interface compliance, and ensures that vendor code can work with framework updates.

## Deep Explanation

### What is VTS?

VTS (Vendor Test Suite) is an automated testing framework that validates vendor HAL implementations for compatibility with the Android framework. It ensures that vendor code meets Project Treble requirements and can work with framework updates.

**Key Characteristics:**
- **Automated Testing:** Automated test execution
- **HAL Validation:** Tests HAL implementations
- **Compatibility Checking:** Validates framework-vendor compatibility
- **Treble Certification:** Required for Treble compliance

**Why VTS?**
- **Compatibility:** Ensures HAL compatibility
- **Treble Support:** Validates Treble requirements
- **Quality Assurance:** Automated quality checks
- **Certification:** Required for device certification

### VTS Purpose

#### HAL Compatibility Testing

**What It Tests:**
- HAL interface compliance
- Method implementations
- Data type handling
- Error handling
- Version compatibility

**Why It Matters:**
- Ensures HALs work with framework
- Validates interface implementations
- Catches compatibility issues early
- Prevents runtime failures

#### VINTF Compliance

**What It Validates:**
- Manifest correctness
- HAL declarations
- Version compatibility
- Interface availability
- Instance declarations

**Why It Matters:**
- Ensures VINTF compliance
- Validates manifest structure
- Checks compatibility rules
- Prevents manifest errors

#### Treble Certification

**What It Ensures:**
- Treble requirements met
- Framework-vendor separation
- Independent update capability
- Compatibility maintained

**Why It Matters:**
- Required for Treble certification
- Enables framework updates
- Validates separation
- Ensures update compatibility

### VTS Architecture

#### Test Structure

**Test Organization:**
```
VTS/
├── testcases/           # Test cases
│   ├── data/           # Test data
│   ├── hal/            # HAL tests
│   └── vts/            # VTS framework tests
├── tools/              # Test tools
└── frameworks/         # Test frameworks
```

**Test Types:**
- **HAL Tests:** Test HAL implementations
- **Manifest Tests:** Validate manifests
- **Compatibility Tests:** Check compatibility
- **Framework Tests:** Test framework integration

#### Test Execution

**Execution Flow:**
```
1. VTS test runner starts
2. Connects to device
3. Loads test cases
4. Executes tests
5. Collects results
6. Generates report
```

**Test Environment:**
- Runs on host machine
- Connects to device via ADB
- Executes tests on device
- Collects results

### VTS Test Categories

#### HAL Interface Tests

**What They Test:**
- HAL method implementations
- Parameter handling
- Return values
- Error conditions
- Edge cases

**Example Tests:**
- Method call correctness
- Data type validation
- Error handling
- Performance checks

#### Manifest Tests

**What They Test:**
- Manifest format
- HAL declarations
- Version information
- Interface definitions
- Instance declarations

**Example Tests:**
- XML validation
- Schema compliance
- Required fields
- Version compatibility

#### Compatibility Tests

**What They Test:**
- Framework-vendor compatibility
- Version compatibility
- Interface compatibility
- Update compatibility

**Example Tests:**
- Required HAL availability
- Version matching
- Interface correctness
- Update scenarios

### Running VTS Tests

#### Prerequisites

**Requirements:**
- Device with vendor HALs
- ADB connection
- VTS test suite
- Python environment

**Setup:**
```bash
# Set up VTS environment
source build/envsetup.sh
lunch <device>

# Connect device
adb devices
```

#### Running Tests

**Run All Tests:**
```bash
# Run all VTS tests
vts-tradefed run commandAndExit vts
```

**Run Specific Test:**
```bash
# Run specific test module
vts-tradefed run commandAndExit vts -m VtsHalExampleV1_0Target
```

**Run Test Suite:**
```bash
# Run specific test suite
vts-tradefed run commandAndExit vts -s <suite_name>
```

#### Test Results

**Result Format:**
- Pass/Fail status
- Test logs
- Error messages
- Performance metrics

**Result Location:**
- Test results directory
- HTML reports
- Log files
- XML reports

### VTS Test Examples

#### HAL Test Example

**Test Structure:**
```python
class VtsHalExampleTest(VtsBaseTest):
    def setUp(self):
        # Setup test environment
        self.hal = IExample.getService()
        
    def testGetValue(self):
        # Test getValue method
        result = self.hal.getValue()
        self.assertIsNotNone(result)
        
    def testSetValue(self):
        # Test setValue method
        self.hal.setValue(42)
        value = self.hal.getValue()
        self.assertEqual(value, 42)
```

**Test Execution:**
- Tests HAL methods
- Validates behavior
- Checks error handling
- Verifies correctness

#### Manifest Test Example

**Test Structure:**
```python
class VtsManifestTest(VtsBaseTest):
    def testManifestFormat(self):
        # Test manifest format
        manifest = self.getDeviceManifest()
        self.assertIsValidXML(manifest)
        
    def testHalDeclarations(self):
        # Test HAL declarations
        hals = self.getHalDeclarations()
        self.assertIsNotEmpty(hals)
```

**Test Execution:**
- Validates manifest format
- Checks HAL declarations
- Verifies structure
- Tests compliance

### VTS and Project Treble

#### Treble Validation

**What VTS Validates:**
- Framework-vendor separation
- Interface stability
- Version compatibility
- Update compatibility

**Why It Matters:**
- Ensures Treble compliance
- Validates separation
- Enables updates
- Maintains compatibility

#### Certification Process

**Certification Steps:**
1. Implement HALs
2. Create manifests
3. Run VTS tests
4. Fix failures
5. Achieve certification

**Certification Requirements:**
- All VTS tests pass
- VINTF compliance
- HAL compatibility
- Manifest correctness

### VTS Best Practices

#### Test Development

**Write Comprehensive Tests:**
- Cover all methods
- Test edge cases
- Validate error handling
- Check performance

**Maintain Tests:**
- Update with HAL changes
- Keep tests current
- Fix broken tests
- Add new test cases

#### Test Execution

**Regular Testing:**
- Run tests frequently
- Before releases
- After HAL changes
- During development

**Test Coverage:**
- Cover all HALs
- Test all methods
- Validate all interfaces
- Check all scenarios

### VTS Debugging

#### Common Issues

**Test Failures:**
- HAL not available
- Method not implemented
- Wrong version
- Interface mismatch

**Debugging Steps:**
- Check test logs
- Verify HAL availability
- Review error messages
- Check manifest

#### Debugging Tools

**Test Logs:**
```bash
# View test logs
adb logcat | grep VTS

# Check test results
cat <test_results>/test_result.xml
```

**Manual Testing:**
```bash
# Test HAL manually
adb shell lshal | grep example

# Check manifest
adb shell cat /vendor/manifest.xml
```

### VTS Integration

#### CI/CD Integration

**Continuous Testing:**
- Run VTS in CI/CD
- Automated test execution
- Failure notifications
- Test reporting

**Benefits:**
- Early issue detection
- Automated validation
- Consistent testing
- Quality assurance

#### Development Workflow

**Development Process:**
1. Implement HAL
2. Create manifest
3. Run VTS tests
4. Fix issues
5. Re-test
6. Submit for certification

## Key Takeaways

1. **VTS (Vendor Test Suite)** is an automated testing framework that validates vendor HAL implementations for compatibility with the Android framework.

2. **VTS tests HAL compatibility** by validating interface implementations, method correctness, error handling, and version compatibility.

3. **VTS validates VINTF compliance** by checking manifest format, HAL declarations, version information, and compatibility rules.

4. **VTS is required for Treble certification**, ensuring that vendor code meets Project Treble requirements and can work with framework updates.

5. **VTS test categories** include HAL interface tests, manifest tests, and compatibility tests, covering all aspects of vendor implementation.

6. **VTS tests are run via vts-tradefed**, with options to run all tests, specific test modules, or test suites.

7. **VTS results** include pass/fail status, test logs, error messages, and performance metrics, providing comprehensive test reporting.

8. **Understanding VTS** is essential for AOSP development, HAL implementation, Treble certification, and ensuring vendor code quality and compatibility.

## Related Topics

- **VINTF:** Vendor Interface Object Tree framework that VTS validates
- **AIDL-based HALs:** HAL implementations that VTS tests
- **Vendor Interface Object:** Runtime discovery that VTS validates
- **Device manifest vs framework manifest:** Manifests that VTS validates

