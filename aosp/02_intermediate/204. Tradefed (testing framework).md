---
number: 204
title: Tradefed (testing framework)
slug: tradefed-testing-framework
level: intermediate
tags:
  - aosp
  - tradefed
  - trade-federation
  - testing
  - test-framework
  - automated-testing
prerequisites:
  - vts-vendor-test-suite
  - android-architecture-complete-overview
estimated_minutes: 95
contributors: []
diagrams: []
examples: []
canonical_id: aosp-intermediate-204
---

# Tradefed (testing framework)

## Overview

Tradefed (Trade Federation) is the continuous testing framework used in AOSP for running automated tests on Android devices, including CTS (Compatibility Test Suite), VTS (Vendor Test Suite), GTS (Google Test Suite), and custom test suites. Understanding Tradefed is essential for AOSP development, as it explains how to run automated tests, how to create test suites, how to manage test execution, how to analyze test results, and how Tradefed provides the infrastructure for Android testing. This guide provides a comprehensive overview of Tradefed, its architecture, test execution, test suite creation, result analysis, and best practices.

Think of Tradefed like a test execution engine: just as an engine powers a vehicle and coordinates all its systems (fuel injection, ignition, transmission), Tradefed powers Android testing and coordinates all testing components (test discovery, device management, test execution, result collection, reporting), making it the core infrastructure for automated Android testing.

## Deep Explanation

### What is Tradefed?

Tradefed (Trade Federation) is the continuous testing framework used in AOSP for running automated tests on Android devices. It provides the infrastructure for test execution, device management, result collection, and test reporting.

**Key Characteristics:**
- **Test Framework:** Core testing framework
- **Device Management:** Manages test devices
- **Test Execution:** Executes test suites
- **Result Collection:** Collects test results
- **Continuous Testing:** Supports continuous testing

**Why Tradefed?**
- **Automated Testing:** Enables automated test execution
- **Device Management:** Manages multiple devices
- **Test Infrastructure:** Provides testing infrastructure
- **Result Management:** Manages test results
- **CI/CD Integration:** Integrates with CI/CD systems

### Tradefed Architecture

#### Framework Components

**Core Components:**
- Test runner
- Device manager
- Result collector
- Report generator
- Configuration manager

**Component Structure:**
```
Tradefed
├── Test Runner      - Executes tests
├── Device Manager   - Manages devices
├── Result Collector - Collects results
├── Report Generator - Generates reports
└── Config Manager   - Manages configurations
```

**Component Characteristics:**
- Modular architecture
- Extensible design
- Device management
- Result handling
- Configuration support

#### Test Execution Flow

**Execution Flow:**
```
1. Load test configuration
2. Discover available devices
3. Allocate device for test
4. Execute test suite
5. Collect test results
6. Generate test report
7. Release device
```

**Flow Characteristics:**
- Configuration loading
- Device discovery
- Device allocation
- Test execution
- Result collection
- Report generation
- Device management

### Tradefed Commands

#### Basic Commands

**Command Structure:**
```bash
tradefed.sh run commandAndExit [options] [test_suite]
```

**Basic Commands:**
```bash
# Run CTS tests
tradefed.sh run commandAndExit cts

# Run VTS tests
tradefed.sh run commandAndExit vts

# Run GTS tests
tradefed.sh run commandAndExit gts

# Run specific test module
tradefed.sh run commandAndExit cts -m CtsExampleTest

# Run with options
tradefed.sh run commandAndExit cts --serial <device_serial>
```

**Command Characteristics:**
- Test suite execution
- Module selection
- Device targeting
- Option configuration
- Command flexibility

#### Advanced Commands

**Advanced Options:**
```bash
# Run with specific device
tradefed.sh run commandAndExit cts --serial <serial>

# Run with retry
tradefed.sh run commandAndExit cts --retry-strategy RETRY_ANY_FAILURE

# Run with sharding
tradefed.sh run commandAndExit cts --shard-count 4

# Run with timeout
tradefed.sh run commandAndExit cts --max-test-timeout 300000

# Run with log level
tradefed.sh run commandAndExit cts --log-level VERBOSE
```

**Advanced Characteristics:**
- Device selection
- Retry configuration
- Sharding support
- Timeout management
- Logging control

### Test Suites

#### CTS (Compatibility Test Suite)

**CTS Overview:**
- Tests Android API compatibility
- Validates app compatibility
- Ensures API compliance
- Required for certification
- Comprehensive API testing

**Running CTS:**
```bash
# Run full CTS
tradefed.sh run commandAndExit cts

# Run specific CTS module
tradefed.sh run commandAndExit cts -m CtsExampleTest

# Run CTS with options
tradefed.sh run commandAndExit cts --serial <device> --retry-strategy RETRY_ANY_FAILURE
```

**CTS Characteristics:**
- API compatibility testing
- Comprehensive coverage
- Certification requirement
- Automated execution
- Result reporting

#### VTS (Vendor Test Suite)

**VTS Overview:**
- Tests vendor HAL implementations
- Validates Treble compliance
- Ensures HAL compatibility
- Required for Treble certification
- Vendor interface testing

**Running VTS:**
```bash
# Run full VTS
tradefed.sh run commandAndExit vts

# Run specific VTS module
tradefed.sh run commandAndExit vts -m VtsHalExampleV1_0Target

# Run VTS with options
tradefed.sh run commandAndExit vts --serial <device>
```

**VTS Characteristics:**
- HAL compatibility testing
- Treble compliance validation
- Vendor interface testing
- Certification requirement
- Automated execution

#### GTS (Google Test Suite)

**GTS Overview:**
- Tests Google Play Services compatibility
- Validates GMS compliance
- Ensures Play Services compatibility
- Required for GMS certification
- Google services testing

**Running GTS:**
```bash
# Run full GTS
tradefed.sh run commandAndExit gts

# Run specific GTS module
tradefed.sh run commandAndExit gts -m GtsExampleTest

# Run GTS with options
tradefed.sh run commandAndExit gts --serial <device>
```

**GTS Characteristics:**
- GMS compatibility testing
- Play Services validation
- Certification requirement
- Automated execution
- Result reporting

### Test Configuration

#### Configuration Files

**Configuration Structure:**
```xml
<!-- test_config.xml -->
<configuration description="Test configuration">
    <target_preparer class="com.android.tradefed.targetprep.DeviceSetup"/>
    <test class="com.android.tradefed.testtype.AndroidJUnitTest">
        <option name="package" value="com.example.test"/>
    </test>
    <result_reporter class="com.android.tradefed.result.ConsoleResultReporter"/>
</configuration>
```

**Configuration Elements:**
- Target preparers
- Test classes
- Result reporters
- Options
- Device requirements

**Configuration Characteristics:**
- XML-based configuration
- Modular structure
- Extensible design
- Option support
- Device configuration

#### Custom Test Configuration

**Creating Configuration:**
```xml
<!-- custom_test_config.xml -->
<configuration description="Custom test configuration">
    <!-- Device setup -->
    <target_preparer class="com.android.tradefed.targetprep.DeviceSetup">
        <option name="cleanup" value="true"/>
    </target_preparer>
    
    <!-- Test execution -->
    <test class="com.android.tradefed.testtype.AndroidJUnitTest">
        <option name="package" value="com.example.customtest"/>
        <option name="class" value="com.example.customtest.ExampleTest"/>
    </test>
    
    <!-- Result reporting -->
    <result_reporter class="com.android.tradefed.result.ConsoleResultReporter"/>
    <result_reporter class="com.android.tradefed.result.XmlResultReporter">
        <option name="results-dir" value="/path/to/results"/>
    </result_reporter>
</configuration>
```

**Custom Configuration:**
- Custom test classes
- Custom preparers
- Custom reporters
- Custom options
- Custom workflows

### Device Management

#### Device Allocation

**Device Allocation:**
- Automatic device discovery
- Device allocation for tests
- Device state management
- Multi-device support
- Device reservation

**Allocation Process:**
```
1. Tradefed discovers available devices
2. Tests request device allocation
3. Device allocated to test
4. Test executes on device
5. Device released after test
```

**Allocation Characteristics:**
- Automatic discovery
- Dynamic allocation
- State management
- Multi-device support
- Resource management

#### Device State Management

**Device States:**
- Available (ready for tests)
- Allocated (assigned to test)
- Running (test executing)
- Error (device error)
- Offline (not available)

**State Management:**
- State tracking
- State transitions
- Error handling
- Recovery mechanisms
- State reporting

**State Characteristics:**
- State tracking
- Transition management
- Error recovery
- State reporting
- Resource management

### Test Results

#### Result Collection

**Result Collection:**
- Test pass/fail status
- Test execution time
- Test logs
- Error messages
- Performance metrics

**Collection Features:**
- Automatic collection
- Log capture
- Error reporting
- Performance tracking
- Result storage

**Collection Characteristics:**
- Comprehensive collection
- Log management
- Error reporting
- Performance metrics
- Result storage

#### Result Reporting

**Report Formats:**
- Console output
- XML reports
- HTML reports
- JSON reports
- Custom formats

**Report Generation:**
```bash
# Generate XML report
tradefed.sh run commandAndExit cts --result-report-type XML

# Generate HTML report
tradefed.sh run commandAndExit cts --result-report-type HTML

# Custom report location
tradefed.sh run commandAndExit cts --result-dir /path/to/results
```

**Report Characteristics:**
- Multiple formats
- Customizable reports
- Detailed information
- Result analysis
- Report storage

### Best Practices

#### Best Practices

**Best Practices:**
- Use appropriate test suites
- Configure devices correctly
- Monitor test execution
- Analyze test results
- Maintain test configurations

**Practice Guidelines:**
- **Test Suites:** Use appropriate test suites
- **Device Configuration:** Configure devices correctly
- **Monitoring:** Monitor test execution
- **Analysis:** Analyze test results
- **Maintenance:** Maintain test configurations

#### Common Issues

**Common Issues:**
- Device not found
- Test execution failures
- Timeout issues
- Device state problems
- Configuration errors

**Issue Solutions:**
- Verify device connection
- Check device state
- Adjust timeout values
- Review configuration
- Check logs

## Key Takeaways

1. **Tradefed (Trade Federation)** is the continuous testing framework used in AOSP for running automated tests on Android devices, providing infrastructure for test execution, device management, result collection, and test reporting.

2. **Tradefed architecture** includes framework components (test runner, device manager, result collector, report generator, configuration manager), test execution flow (load test configuration, discover available devices, allocate device for test, execute test suite, collect test results, generate test report, release device), and architecture characteristics.

3. **Tradefed commands** include basic commands (test suite execution, module selection, device targeting, option configuration, command flexibility), advanced commands (device selection, retry configuration, sharding support, timeout management, logging control), and command characteristics.

4. **Test suites** include CTS (Compatibility Test Suite - tests Android API compatibility, validates app compatibility, ensures API compliance, required for certification, comprehensive API testing), VTS (Vendor Test Suite - tests vendor HAL implementations, validates Treble compliance, ensures HAL compatibility, required for Treble certification, vendor interface testing), GTS (Google Test Suite - tests Google Play Services compatibility, validates GMS compliance, ensures Play Services compatibility, required for GMS certification, Google services testing), and suite characteristics.

5. **Test configuration** includes configuration files (XML-based configuration, modular structure, extensible design, option support, device configuration), custom test configuration (custom test classes, custom preparers, custom reporters, custom options, custom workflows), and configuration characteristics.

6. **Device management** includes device allocation (automatic device discovery, device allocation for tests, device state management, multi-device support, device reservation), device state management (state tracking, state transitions, error handling, recovery mechanisms, state reporting), and management characteristics.

7. **Test results** include result collection (test pass/fail status, test execution time, test logs, error messages, performance metrics), result reporting (console output, XML reports, HTML reports, JSON reports, custom formats), and result characteristics.

8. **Best practices** include best practices (use appropriate test suites, configure devices correctly, monitor test execution, analyze test results, maintain test configurations), common issues (device not found, test execution failures, timeout issues, device state problems, configuration errors), and practice guidelines.

9. **Understanding Tradefed** is essential for AOSP development, enabling automated testing, test suite execution, device management, result collection, CI/CD integration, and proper testing framework usage.

## Related Topics

- **VTS (Vendor Test Suite):** VTS details
- **Android Architecture - Complete Overview:** Architecture details

