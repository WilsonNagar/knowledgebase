---
number: 203
title: Android Studio (system debugging)
slug: android-studio-system-debugging
level: intermediate
tags:
  - aosp
  - android-studio
  - debugging
  - system-debugging
  - native-debugging
  - development-tools
prerequisites:
  - gdbserver-for-native-debugging
  - debugging-native-crashes-tombstones
  - android-architecture-complete-overview
estimated_minutes: 95
contributors: []
diagrams: []
examples: []
canonical_id: aosp-intermediate-203
---

# Android Studio (system debugging)

## Overview

Android Studio (system debugging) refers to using Android Studio IDE to debug AOSP system code, including native code, framework code, and system services. Understanding Android Studio system debugging is essential for AOSP development, as it explains how to set up Android Studio for AOSP, how to debug native code, how to debug framework code, how to attach to system processes, and how to use Android Studio's debugging features for AOSP development. This guide provides a comprehensive overview of Android Studio system debugging, setup and configuration, native debugging, framework debugging, process attachment, and debugging workflows.

Think of Android Studio system debugging like a professional debugging suite: just as a professional debugging suite provides multiple tools for debugging different types of code (source code debugger, memory analyzer, performance profiler), Android Studio provides multiple debugging capabilities for AOSP system code (native debugging, framework debugging, process attachment, log analysis), making it a comprehensive tool for AOSP development and debugging.

## Deep Explanation

### What is Android Studio System Debugging?

Android Studio system debugging refers to using Android Studio IDE to debug AOSP system code, including native C/C++ code, Java/Kotlin framework code, and system services running on Android devices.

**Key Characteristics:**
- **IDE-Based Debugging:** Integrated development environment
- **Native Support:** Debugs native C/C++ code
- **Framework Support:** Debugs Java/Kotlin framework code
- **Process Attachment:** Attaches to running processes
- **Comprehensive:** Multiple debugging capabilities

**Why Android Studio System Debugging?**
- **Integrated Environment:** All-in-one debugging environment
- **Native Debugging:** Debug native code with LLDB
- **Framework Debugging:** Debug framework code with Java debugger
- **Visual Interface:** Visual debugging interface
- **Productivity:** Improves debugging productivity

### Android Studio Setup for AOSP

#### Importing AOSP Project

**Project Import:**
- Import AOSP source code
- Configure project structure
- Set up build paths
- Configure SDK paths
- Set up source paths

**Import Process:**
```
1. File → Open → Select AOSP root directory
2. Android Studio analyzes project
3. Configure project structure
4. Set up build paths
5. Sync project
```

**Import Characteristics:**
- Project structure detection
- Build configuration
- Source path setup
- SDK configuration
- Project synchronization

#### Project Configuration

**Configuration Steps:**
- Configure SDK paths
- Set up NDK paths
- Configure build variants
- Set up source paths
- Configure debug settings

**Configuration Example:**
```gradle
// build.gradle (if using Gradle)
android {
    compileSdkVersion 33
    ndkVersion "25.1.8937393"
    
    sourceSets {
        main {
            jniLibs.srcDirs = ['libs']
        }
    }
}
```

**Configuration Characteristics:**
- SDK configuration
- NDK configuration
- Build variant setup
- Source path configuration
- Debug settings

### Native Code Debugging

#### LLDB Configuration

**LLDB Setup:**
- Configure LLDB debugger
- Set up symbol paths
- Configure source paths
- Set up breakpoints
- Configure debug settings

**LLDB Configuration:**
```json
// .lldbinit or launch.json
{
    "type": "lldb",
    "request": "attach",
    "name": "Attach to Native Process",
    "processId": "${command:pickProcess}",
    "sourceMap": {
        "/build/path": "/source/path"
    }
}
```

**LLDB Characteristics:**
- Native debugging
- Symbol loading
- Source mapping
- Breakpoint support
- Process attachment

#### Native Debugging Workflow

**Debugging Workflow:**
```
1. Build native code with debug symbols
2. Deploy to device
3. Start process or attach to running process
4. Set breakpoints in native code
5. Debug with LLDB
```

**Workflow Steps:**
```bash
# 1. Build with debug symbols
m -j8 native_library

# 2. Push to device
adb push libnative.so /system/lib64/

# 3. Attach to process
# Use Android Studio's "Attach to Process" feature
```

**Workflow Characteristics:**
- Debug build
- Deployment
- Process attachment
- Breakpoint debugging
- Step-through debugging

#### Native Breakpoints

**Setting Breakpoints:**
- Set breakpoints in C/C++ code
- Conditional breakpoints
- Function breakpoints
- Watchpoints
- Exception breakpoints

**Breakpoint Types:**
- Line breakpoints
- Function breakpoints
- Conditional breakpoints
- Watchpoints (memory)
- Exception breakpoints

**Breakpoint Usage:**
```cpp
// Set breakpoint at line
int result = calculate_value();  // Breakpoint here

// Conditional breakpoint
if (value > threshold) {  // Break if value > 100
    process_value();
}
```

**Breakpoint Characteristics:**
- Visual breakpoint setting
- Conditional breakpoints
- Watchpoint support
- Exception handling
- Breakpoint management

### Framework Code Debugging

#### Java Debugger Configuration

**Java Debugger Setup:**
- Configure Java debugger
- Set up source paths
- Configure class paths
- Set up breakpoints
- Configure debug settings

**Java Debugger Configuration:**
```json
// launch.json
{
    "type": "java",
    "request": "attach",
    "name": "Attach to Framework Process",
    "hostName": "localhost",
    "port": 5005,
    "sourcePaths": [
        "${workspaceFolder}/frameworks/base"
    ]
}
```

**Java Debugger Characteristics:**
- Framework debugging
- Source path setup
- Class path configuration
- Breakpoint support
- Process attachment

#### Framework Debugging Workflow

**Debugging Workflow:**
```
1. Build framework with debug symbols
2. Deploy to device
3. Attach to system process
4. Set breakpoints in framework code
5. Debug with Java debugger
```

**Workflow Steps:**
```bash
# 1. Build framework with debug
m -j8 framework

# 2. Deploy to device
adb sync system

# 3. Attach to SystemServer
# Use Android Studio's "Attach to Process" feature
# Select "system_server" process
```

**Workflow Characteristics:**
- Debug build
- Framework deployment
- Process attachment
- Breakpoint debugging
- Step-through debugging

#### Framework Breakpoints

**Setting Breakpoints:**
- Set breakpoints in Java/Kotlin code
- Conditional breakpoints
- Method breakpoints
- Field watchpoints
- Exception breakpoints

**Breakpoint Types:**
- Line breakpoints
- Method breakpoints
- Conditional breakpoints
- Field watchpoints
- Exception breakpoints

**Breakpoint Usage:**
```java
// Set breakpoint at line
public void processRequest(Request request) {
    validateRequest(request);  // Breakpoint here
    handleRequest(request);
}

// Conditional breakpoint
if (request.getType() == RequestType.CRITICAL) {  // Break if critical
    processCriticalRequest(request);
}
```

**Breakpoint Characteristics:**
- Visual breakpoint setting
- Conditional breakpoints
- Watchpoint support
- Exception handling
- Breakpoint management

### Process Attachment

#### Attaching to System Processes

**Process Attachment:**
- Attach to system_server
- Attach to native services
- Attach to app processes
- Attach to HAL services
- Multiple process debugging

**Attachment Process:**
```
1. Run → Attach to Process
2. Select process from list
3. Choose debugger type (Java/LLDB)
4. Android Studio attaches
5. Set breakpoints and debug
```

**Attachment Characteristics:**
- Process selection
- Debugger type selection
- Automatic attachment
- Symbol loading
- Breakpoint support

#### System Process Debugging

**System Processes:**
- system_server (framework services)
- Native services (C++ services)
- HAL services (hardware abstraction)
- App processes (user applications)
- Zygote (app process creation)

**Process Types:**
- Java processes (system_server, apps)
- Native processes (native services, HALs)
- Mixed processes (Java + native)

**Process Debugging:**
```bash
# List running processes
adb shell ps -A

# Attach to system_server
# Use Android Studio's "Attach to Process"
# Select "system_server"
```

**Process Characteristics:**
- Multiple process types
- Different debugger requirements
- Process-specific debugging
- Symbol requirements
- Attachment methods

### Debugging Features

#### Variable Inspection

**Variable Inspection:**
- Inspect variables
- Evaluate expressions
- Watch variables
- Inspect object properties
- Memory inspection

**Inspection Features:**
- Variable values
- Expression evaluation
- Object properties
- Array/collection inspection
- Memory values

**Inspection Usage:**
```java
// Inspect variable
int value = calculateValue();  // Inspect 'value'

// Evaluate expression
int result = value * 2;  // Evaluate 'value * 2'

// Inspect object
MyObject obj = new MyObject();  // Inspect 'obj' properties
```

**Inspection Characteristics:**
- Real-time inspection
- Expression evaluation
- Object navigation
- Memory inspection
- Variable watching

#### Call Stack Analysis

**Call Stack:**
- View call stack
- Navigate stack frames
- Inspect frame variables
- Analyze stack trace
- Thread stack inspection

**Stack Features:**
- Stack frame navigation
- Variable inspection per frame
- Frame information
- Thread stack views
- Stack trace analysis

**Stack Usage:**
```java
// View call stack when breakpoint hits
method1() {
    method2();  // Breakpoint here
}

method2() {
    method3();  // View stack: method3 -> method2 -> method1
}
```

**Stack Characteristics:**
- Frame navigation
- Variable inspection
- Frame information
- Thread views
- Stack analysis

#### Log Integration

**Log Integration:**
- View logcat in Android Studio
- Filter logs
- Search logs
- Log analysis
- Log debugging

**Log Features:**
- Real-time log viewing
- Log filtering
- Log search
- Tag-based filtering
- Log level filtering

**Log Usage:**
```bash
# View logcat in Android Studio
# Tools → Logcat
# Filter by tag, package, or level
```

**Log Characteristics:**
- Integrated log viewer
- Real-time updates
- Advanced filtering
- Search capabilities
- Log analysis

### Advanced Debugging

#### Multi-Process Debugging

**Multi-Process:**
- Debug multiple processes
- Cross-process debugging
- Process communication debugging
- Binder transaction debugging
- IPC debugging

**Multi-Process Features:**
- Multiple debugger instances
- Process switching
- Cross-process breakpoints
- Communication debugging
- IPC analysis

**Multi-Process Usage:**
```
1. Attach to first process
2. Attach to second process
3. Set breakpoints in both
4. Debug cross-process communication
```

**Multi-Process Characteristics:**
- Multiple attachments
- Process switching
- Cross-process debugging
- Communication analysis
- IPC debugging

#### Performance Profiling

**Performance Profiling:**
- CPU profiling
- Memory profiling
- Network profiling
- Method tracing
- System tracing

**Profiling Features:**
- CPU usage analysis
- Memory allocation tracking
- Network activity monitoring
- Method execution time
- System trace integration

**Profiling Usage:**
```
1. Run → Profile 'app'
2. Select profiling type
3. Start profiling
4. Analyze results
```

**Profiling Characteristics:**
- Real-time profiling
- Performance metrics
- Resource usage
- Method analysis
- System integration

### Best Practices

#### Best Practices

**Best Practices:**
- Use debug builds with symbols
- Set up source paths correctly
- Use appropriate breakpoints
- Keep debugging sessions organized
- Document debugging workflows

**Practice Guidelines:**
- **Debug Builds:** Use debug builds with symbols
- **Source Paths:** Set up source paths correctly
- **Breakpoints:** Use appropriate breakpoints
- **Organization:** Keep debugging sessions organized
- **Documentation:** Document debugging workflows

#### Common Issues

**Common Issues:**
- Symbols not loading
- Source paths incorrect
- Process attachment fails
- Breakpoints not hitting
- Debugger disconnects

**Issue Solutions:**
- Verify symbol paths
- Check source path configuration
- Ensure process is debuggable
- Verify breakpoint locations
- Check debugger connection

## Key Takeaways

1. **Android Studio (system debugging)** refers to using Android Studio IDE to debug AOSP system code, including native C/C++ code, Java/Kotlin framework code, and system services running on Android devices.

2. **Android Studio setup for AOSP** includes importing AOSP project (import AOSP source code, configure project structure, set up build paths, configure SDK paths, set up source paths), project configuration (configure SDK paths, set up NDK paths, configure build variants, set up source paths, configure debug settings), and setup characteristics.

3. **Native code debugging** includes LLDB configuration (configure LLDB debugger, set up symbol paths, configure source paths, set up breakpoints, configure debug settings), native debugging workflow (build native code with debug symbols, deploy to device, start process or attach to running process, set breakpoints in native code, debug with LLDB), native breakpoints (set breakpoints in C/C++ code, conditional breakpoints, function breakpoints, watchpoints, exception breakpoints), and debugging characteristics.

4. **Framework code debugging** includes Java debugger configuration (configure Java debugger, set up source paths, configure class paths, set up breakpoints, configure debug settings), framework debugging workflow (build framework with debug symbols, deploy to device, attach to system process, set breakpoints in framework code, debug with Java debugger), framework breakpoints (set breakpoints in Java/Kotlin code, conditional breakpoints, method breakpoints, field watchpoints, exception breakpoints), and debugging characteristics.

5. **Process attachment** includes attaching to system processes (attach to system_server, attach to native services, attach to app processes, attach to HAL services, multiple process debugging), system process debugging (system processes, process types, process debugging), and attachment characteristics.

6. **Debugging features** include variable inspection (inspect variables, evaluate expressions, watch variables, inspect object properties, memory inspection), call stack analysis (view call stack, navigate stack frames, inspect frame variables, analyze stack trace, thread stack inspection), log integration (view logcat in Android Studio, filter logs, search logs, log analysis, log debugging), and feature characteristics.

7. **Advanced debugging** includes multi-process debugging (debug multiple processes, cross-process debugging, process communication debugging, Binder transaction debugging, IPC debugging), performance profiling (CPU profiling, memory profiling, network profiling, method tracing, system tracing), and advanced characteristics.

8. **Best practices** include best practices (use debug builds with symbols, set up source paths correctly, use appropriate breakpoints, keep debugging sessions organized, document debugging workflows), common issues (symbols not loading, source paths incorrect, process attachment fails, breakpoints not hitting, debugger disconnects), and practice guidelines.

9. **Understanding Android Studio system debugging** is essential for AOSP development, enabling integrated debugging, native code debugging, framework debugging, process attachment, productivity improvement, and proper debugging tool usage.

## Related Topics

- **gdbserver for native debugging:** Native debugging details
- **Debugging native crashes (tombstones):** Native crash debugging details
- **Android Architecture - Complete Overview:** Architecture details

