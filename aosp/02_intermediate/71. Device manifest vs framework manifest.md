---
number: 71
title: Device manifest vs framework manifest
slug: device-manifest-vs-framework-manifest
level: intermediate
tags:
  - aosp
  - manifest
  - device-manifest
  - framework-manifest
  - vintf
  - treble
  - hal
prerequisites:
  - vintf
  - vendor-interface-object
  - aidl-based-hals
estimated_minutes: 75
contributors: []
diagrams: []
examples: []
canonical_id: aosp-intermediate-71
---

# Device manifest vs framework manifest

## Overview

Device manifest and framework manifest are two complementary XML files in Android's VINTF (Vendor Interface Object Tree) system that describe vendor HAL capabilities and framework requirements respectively. Understanding the difference between these manifests is essential for AOSP development, as they define the contract between framework and vendor, enable compatibility validation, support Project Treble, and ensure that framework and vendor implementations work together correctly. This guide provides a comprehensive overview of device manifest vs framework manifest, their purposes, structures, differences, and how they work together.

Think of device manifest and framework manifest like a job posting and a resume: the framework manifest is like a job posting that describes what the framework needs (required HALs, versions, interfaces), while the device manifest is like a resume that describes what the vendor provides (available HALs, versions, interfaces). VINTF matches them together to ensure compatibility - the vendor's "resume" must meet the framework's "job requirements" for the system to work.

## Deep Explanation

### What are Device and Framework Manifests?

Device manifest and framework manifest are XML files that describe vendor HAL capabilities and framework requirements in Android's VINTF system. They enable compatibility validation and ensure framework-vendor interoperability.

**Key Characteristics:**
- **Device Manifest:** Describes what vendor provides
- **Framework Manifest:** Describes what framework needs
- **Complementary:** Work together for compatibility
- **VINTF Managed:** Part of VINTF framework

**Why Two Manifests?**
- **Separation:** Framework and vendor separated
- **Compatibility:** Enable compatibility checking
- **Discovery:** Framework discovers vendor capabilities
- **Validation:** Validate framework-vendor match

### Device Manifest

#### What is Device Manifest?

Device manifest is an XML file provided by the vendor that describes the HAL implementations available on the device. It declares what hardware interfaces the vendor provides.

**Location:**
- `/vendor/manifest.xml`
- Vendor-provided
- Device-specific
- Describes vendor HALs

**Purpose:**
- Declare available HALs
- Describe interfaces
- List instances
- Provide version information

#### Device Manifest Structure

**Basic Structure:**
```xml
<manifest version="1.0" type="device">
    <hal format="aidl">
        <name>android.hardware.example</name>
        <version>1</version>
        <fqname>IExample/default</fqname>
    </hal>
</manifest>
```

**Key Elements:**
- `type="device"`: Identifies as device manifest
- `hal`: Describes a HAL implementation
- `format`: HAL format (aidl or hidl)
- `name`: HAL package name
- `version`: HAL version
- `fqname`: Fully qualified name (interface/instance)

#### Device Manifest Purpose

**Declares Available HALs:**
- Lists HALs vendor implements
- Describes interfaces
- Provides version info
- Enables discovery

**Runtime Discovery:**
- Framework queries device manifest
- Discovers available HALs
- Checks capabilities
- Uses for compatibility

### Framework Manifest

#### What is Framework Manifest?

Framework manifest is an XML file provided by the framework that describes the HAL requirements of the Android framework. It declares what hardware interfaces the framework needs.

**Location:**
- `/system/etc/vintf/manifest.xml`
- Framework-provided
- System-wide
- Describes framework requirements

**Purpose:**
- Declare required HALs
- Specify version requirements
- Define interface needs
- Set compatibility requirements

#### Framework Manifest Structure

**Basic Structure:**
```xml
<manifest version="1.0" type="framework">
    <hal format="aidl" optional="false">
        <name>android.hardware.example</name>
        <version>1</version>
        <interface>
            <name>IExample</name>
            <instance>default</instance>
        </interface>
    </hal>
</manifest>
```

**Key Elements:**
- `type="framework"`: Identifies as framework manifest
- `hal`: Describes a required HAL
- `format`: HAL format (aidl or hidl)
- `name`: HAL package name
- `version`: Required version
- `optional`: Whether HAL is optional
- `interface`: Required interface

#### Framework Manifest Purpose

**Declares Required HALs:**
- Lists HALs framework needs
- Specifies versions
- Defines interfaces
- Sets requirements

**Compatibility Validation:**
- VINTF validates compatibility
- Checks device manifest
- Verifies requirements met
- Ensures compatibility

### Key Differences

#### Purpose

**Device Manifest:**
- Describes what vendor provides
- Lists available HALs
- Vendor capabilities
- "What I have"

**Framework Manifest:**
- Describes what framework needs
- Lists required HALs
- Framework requirements
- "What I need"

#### Location

**Device Manifest:**
- `/vendor/manifest.xml`
- Vendor partition
- Vendor-provided
- Device-specific

**Framework Manifest:**
- `/system/etc/vintf/manifest.xml`
- System partition
- Framework-provided
- System-wide

#### Content

**Device Manifest:**
- Available HALs
- Implemented interfaces
- Vendor capabilities
- Instance declarations

**Framework Manifest:**
- Required HALs
- Needed interfaces
- Version requirements
- Optional/required flags

#### Ownership

**Device Manifest:**
- Vendor creates
- Vendor maintains
- Device-specific
- Vendor responsibility

**Framework Manifest:**
- Framework creates
- Framework maintains
- System-wide
- Framework responsibility

### How They Work Together

#### Compatibility Checking

**Process:**
```
1. Framework loads framework manifest
2. Device loads device manifest
3. VINTF compares manifests
4. Validates compatibility
5. Ensures requirements met
```

**Validation:**
- Required HALs must be present
- Versions must be compatible
- Interfaces must match
- Instances must be available

#### Runtime Discovery

**Framework Queries:**
- Framework reads device manifest
- Discovers available HALs
- Checks capabilities
- Uses for compatibility

**VIO Usage:**
- VIO reads device manifest
- Provides query responses
- Enables runtime discovery
- Supports framework queries

### Manifest Examples

#### AIDL HAL Example

**Device Manifest:**
```xml
<manifest version="1.0" type="device">
    <hal format="aidl">
        <name>android.hardware.example</name>
        <version>1</version>
        <fqname>IExample/default</fqname>
    </hal>
</manifest>
```

**Framework Manifest:**
```xml
<manifest version="1.0" type="framework">
    <hal format="aidl" optional="false">
        <name>android.hardware.example</name>
        <version>1</version>
        <interface>
            <name>IExample</name>
            <instance>default</instance>
        </interface>
    </hal>
</manifest>
```

**Compatibility:**
- Device provides IExample/default
- Framework requires IExample/default
- Versions match (1)
- Compatible ✓

#### HIDL HAL Example

**Device Manifest:**
```xml
<manifest version="1.0" type="device">
    <hal format="hidl">
        <name>android.hardware.legacy</name>
        <version>1.0</version>
        <interface>
            <name>ILegacy</name>
            <instance>default</instance>
        </interface>
    </hal>
</manifest>
```

**Framework Manifest:**
```xml
<manifest version="1.0" type="framework">
    <hal format="hidl" optional="true">
        <name>android.hardware.legacy</name>
        <version>1.0</version>
        <interface>
            <name>ILegacy</name>
            <instance>default</instance>
        </interface>
    </hal>
</manifest>
```

**Compatibility:**
- Device provides ILegacy/default
- Framework requires ILegacy/default (optional)
- Versions match (1.0)
- Compatible ✓

### Optional vs Required HALs

#### Required HALs

**Framework Manifest:**
```xml
<hal format="aidl" optional="false">
    <name>android.hardware.required</name>
    <version>1</version>
    <interface>
        <name>IRequired</name>
        <instance>default</instance>
    </interface>
</hal>
```

**Requirements:**
- Must be present in device manifest
- System won't boot without it
- Critical for functionality
- Non-negotiable

#### Optional HALs

**Framework Manifest:**
```xml
<hal format="aidl" optional="true">
    <name>android.hardware.optional</name>
    <version>1</version>
    <interface>
        <name>IOptional</name>
        <instance>default</instance>
    </interface>
</hal>
```

**Requirements:**
- May be present in device manifest
- System can boot without it
- Nice to have
- Graceful degradation

### Version Compatibility

#### Version Matching

**Exact Match:**
- Device: version 1
- Framework: version 1
- Compatible ✓

**Minor Version:**
- Device: version 1.1
- Framework: version 1
- Compatible ✓ (backward compatible)

**Major Version:**
- Device: version 2
- Framework: version 1
- May not be compatible ✗

#### Version Requirements

**Framework Specifies:**
- Minimum version
- Maximum version
- Exact version
- Version range

**Device Provides:**
- Specific version
- Must meet requirements
- Version compatibility checked
- VINTF validates

### Manifest Maintenance

#### Device Manifest

**Vendor Responsibilities:**
- Create device manifest
- Keep it updated
- Reflect actual HALs
- Maintain accuracy

**Updates:**
- Update when HALs change
- Add new HALs
- Remove deprecated HALs
- Update versions

#### Framework Manifest

**Framework Responsibilities:**
- Create framework manifest
- Keep it updated
- Reflect framework needs
- Maintain accuracy

**Updates:**
- Update with framework changes
- Add new requirements
- Remove deprecated requirements
- Update versions

### Best Practices

#### Device Manifest

**Accuracy:**
- Reflect actual HALs
- Accurate versions
- Complete interface info
- Correct instances

**Maintenance:**
- Keep updated
- Validate format
- Test with VTS
- Review regularly

#### Framework Manifest

**Clarity:**
- Clear requirements
- Accurate versions
- Proper optional flags
- Complete interface info

**Maintenance:**
- Keep updated
- Validate format
- Test compatibility
- Review regularly

### Debugging Manifests

#### Common Issues

**Compatibility Failures:**
- HAL not found
- Version mismatch
- Interface mismatch
- Instance not found

**Manifest Errors:**
- XML syntax errors
- Schema violations
- Missing fields
- Invalid values

#### Debugging Tools

**Manifest Inspection:**
```bash
# View device manifest
adb shell cat /vendor/manifest.xml

# View framework manifest
adb shell cat /system/etc/vintf/manifest.xml

# Check VINTF compatibility
adb shell vintf
```

**Validation:**
```bash
# Validate manifest format
vintf-check <manifest.xml>

# Check compatibility
vintf-check device.xml framework.xml
```

## Key Takeaways

1. **Device manifest** (`/vendor/manifest.xml`) describes what HALs the vendor provides, while **framework manifest** (`/system/etc/vintf/manifest.xml`) describes what HALs the framework needs.

2. **Device manifest** is vendor-provided and device-specific, listing available HALs, interfaces, and instances, while **framework manifest** is framework-provided and system-wide, listing required HALs and version requirements.

3. **VINTF compares both manifests** to validate compatibility, ensuring that required HALs are present, versions are compatible, and interfaces match.

4. **Device manifest enables runtime discovery** through VIO, allowing the framework to query vendor capabilities at runtime.

5. **Framework manifest** can mark HALs as optional or required, with required HALs being critical for system boot and optional HALs allowing graceful degradation.

6. **Version compatibility** is validated between manifests, with exact matches, backward-compatible minor versions, and potentially incompatible major versions.

7. **Both manifests must be maintained** by their respective owners (vendor for device manifest, framework for framework manifest) and kept accurate and up-to-date.

8. **Understanding device manifest vs framework manifest** is essential for AOSP development, VINTF compliance, Treble compatibility, and ensuring framework-vendor interoperability.

## Related Topics

- **VINTF:** Framework that manages both manifests
- **Vendor Interface Object:** Uses device manifest for discovery
- **AIDL-based HALs:** HALs described in manifests
- **VTS (Vendor Test Suite):** Validates manifest compliance

