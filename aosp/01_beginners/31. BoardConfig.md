---
number: 31
title: BoardConfig
slug: boardconfig
level: beginner
tags:
  - aosp
  - boardconfig
  - device
  - hardware
  - configuration
  - build
prerequisites:
  - aosp-repo-structure
  - lunch-lunch-combos
  - build-system-structure
estimated_minutes: 75
contributors: []
diagrams: []
examples: []
canonical_id: aosp-beginner-31
---

# BoardConfig

## Overview

BoardConfig is a critical configuration file in AOSP that defines hardware-specific settings for a device. It specifies board-level configurations like CPU architecture, memory layout, partition sizes, kernel configuration, and hardware features. Understanding BoardConfig is essential for porting Android to new devices, customizing builds for specific hardware, and understanding how device configurations work. This guide provides a comprehensive overview of BoardConfig, its structure, key settings, and how it's used in the build system.

Think of BoardConfig like a device's technical specification sheet: just as a spec sheet lists all the hardware details of a device (processor, memory, storage, etc.), BoardConfig lists all the hardware-specific settings that Android needs to know to build and run correctly on that device. Without the right BoardConfig, Android wouldn't know how to interact with the hardware properly.

## Deep Explanation

### What is BoardConfig?

BoardConfig is a Makefile (BoardConfig.mk) that contains hardware-specific configuration for a device. It defines board-level settings that are independent of the Android software stack but essential for building and running Android on specific hardware.

**Key Characteristics:**
- **Hardware-Specific:** Defines hardware configuration
- **Board-Level:** Applies to entire board/device
- **Makefile Format:** Written in Make syntax
- **Required:** Essential for device builds

**Why BoardConfig?**
- **Hardware Differences:** Different devices have different hardware
- **Build Configuration:** Build system needs hardware info
- **Runtime Configuration:** System needs hardware details
- **Device Porting:** Essential for new devices

### BoardConfig Location

#### File Location

**Standard Path:**
```
device/<vendor>/<device>/BoardConfig.mk
```

**Example:**
```
device/google/pixel/BoardConfig.mk
device/samsung/galaxy/BoardConfig.mk
```

**Naming:**
- Standard name: `BoardConfig.mk`
- Must be in device directory
- Loaded by build system
- Required for device builds

#### Multiple BoardConfigs

**Board Variants:**
- Some devices have multiple board variants
- Different BoardConfig.mk files
- Selected based on hardware
- Example: `BoardConfig-common.mk`, `BoardConfig-variant.mk`

### BoardConfig Structure

#### Basic Structure

**File Format:**
```makefile
# BoardConfig.mk
# Hardware configuration

# Architecture
TARGET_ARCH := arm64
TARGET_ARCH_VARIANT := armv8-a
TARGET_CPU_VARIANT := generic
TARGET_CPU_ABI := arm64-v8a

# Kernel
TARGET_KERNEL_ARCH := arm64
TARGET_KERNEL_CONFIG := defconfig
TARGET_KERNEL_SOURCE := kernel/vendor/device

# Partitions
BOARD_BOOTIMAGE_PARTITION_SIZE := 67108864
BOARD_SYSTEMIMAGE_PARTITION_SIZE := 3221225472
BOARD_USERDATAIMAGE_PARTITION_SIZE := 57671680000
```

**Key Sections:**
- Architecture settings
- Kernel configuration
- Partition sizes
- Hardware features
- Build options

### Key BoardConfig Variables

#### Architecture Settings

**TARGET_ARCH:**
```makefile
TARGET_ARCH := arm64
```
- Target CPU architecture
- Options: `arm`, `arm64`, `x86`, `x86_64`
- Determines toolchain
- Affects all builds

**TARGET_ARCH_VARIANT:**
```makefile
TARGET_ARCH_VARIANT := armv8-a
```
- Architecture variant
- Fine-tunes architecture
- Example: `armv7-a-neon`, `armv8-a`
- Optimizes for specific CPU

**TARGET_CPU_VARIANT:**
```makefile
TARGET_CPU_VARIANT := generic
```
- CPU variant
- Example: `generic`, `cortex-a53`, `kryo`
- CPU-specific optimizations
- Affects code generation

**TARGET_CPU_ABI:**
```makefile
TARGET_CPU_ABI := arm64-v8a
```
- Application Binary Interface
- Determines native code format
- Example: `armeabi-v7a`, `arm64-v8a`
- Affects app compatibility

#### Kernel Configuration

**TARGET_KERNEL_ARCH:**
```makefile
TARGET_KERNEL_ARCH := arm64
```
- Kernel architecture
- Must match device architecture
- Used for kernel builds
- Determines kernel config

**TARGET_KERNEL_CONFIG:**
```makefile
TARGET_KERNEL_CONFIG := defconfig
```
- Kernel configuration file
- Defines kernel features
- Example: `defconfig`, `mydevice_defconfig`
- Located in kernel source

**TARGET_KERNEL_SOURCE:**
```makefile
TARGET_KERNEL_SOURCE := kernel/vendor/device
```
- Kernel source location
- Path to kernel tree
- Used for kernel builds
- Can be external or in-tree

#### Partition Configuration

**Boot Partition:**
```makefile
BOARD_BOOTIMAGE_PARTITION_SIZE := 67108864  # 64 MB
```
- Boot partition size
- Contains kernel and initramfs
- Must fit boot image
- Device-specific

**System Partition:**
```makefile
BOARD_SYSTEMIMAGE_PARTITION_SIZE := 3221225472  # 3 GB
```
- System partition size
- Contains Android system
- Must fit all system files
- Device-specific

**Userdata Partition:**
```makefile
BOARD_USERDATAIMAGE_PARTITION_SIZE := 57671680000  # ~54 GB
```
- User data partition size
- Contains user data
- Largest partition usually
- Device-specific

**Other Partitions:**
```makefile
BOARD_VENDORIMAGE_PARTITION_SIZE := 1073741824  # 1 GB
BOARD_CACHEIMAGE_PARTITION_SIZE := 268435456    # 256 MB
BOARD_RECOVERYIMAGE_PARTITION_SIZE := 67108864  # 64 MB
```

#### Hardware Features

**Display:**
```makefile
TARGET_SCREEN_WIDTH := 1080
TARGET_SCREEN_HEIGHT := 1920
TARGET_SCREEN_DENSITY := 420
```

**Graphics:**
```makefile
BOARD_EGL_CFG := device/vendor/device/egl.cfg
USE_OPENGL_RENDERER := true
```

**Audio:**
```makefile
BOARD_USES_ALSA_AUDIO := true
BOARD_HAVE_BLUETOOTH := true
```

**Camera:**
```makefile
BOARD_CAMERA_LIBRARIES := libcamera
USE_CAMERA_STUB := false
```

#### Build Options

**Build Flags:**
```makefile
TARGET_NO_BOOTLOADER := false
TARGET_NO_KERNEL := false
TARGET_NO_RECOVERY := false
```

**Optimization:**
```makefile
TARGET_USE_SDCLANG := true
TARGET_FORCE_HWC_FOR_VIRTUAL_DISPLAYS := true
```

### BoardConfig Inheritance

#### Common BoardConfig

**Base Configuration:**
```makefile
# device/vendor/common/BoardConfigCommon.mk
# Common settings for all vendor devices

TARGET_ARCH := arm64
TARGET_ARCH_VARIANT := armv8-a
# ... common settings
```

**Device-Specific:**
```makefile
# device/vendor/device/BoardConfig.mk
include device/vendor/common/BoardConfigCommon.mk

# Device-specific overrides
BOARD_BOOTIMAGE_PARTITION_SIZE := 67108864
# ... device-specific settings
```

**Benefits:**
- Reuse common settings
- Reduce duplication
- Maintain consistency
- Easier updates

### BoardConfig Examples

#### Example 1: ARM64 Device

```makefile
# BoardConfig.mk for ARM64 device

# Architecture
TARGET_ARCH := arm64
TARGET_ARCH_VARIANT := armv8-a
TARGET_CPU_VARIANT := generic
TARGET_CPU_ABI := arm64-v8a

# Kernel
TARGET_KERNEL_ARCH := arm64
TARGET_KERNEL_CONFIG := mydevice_defconfig
TARGET_KERNEL_SOURCE := kernel/vendor/device

# Partitions
BOARD_BOOTIMAGE_PARTITION_SIZE := 67108864
BOARD_SYSTEMIMAGE_PARTITION_SIZE := 3221225472
BOARD_USERDATAIMAGE_PARTITION_SIZE := 57671680000

# Display
TARGET_SCREEN_WIDTH := 1080
TARGET_SCREEN_HEIGHT := 1920
TARGET_SCREEN_DENSITY := 420

# Features
BOARD_HAVE_BLUETOOTH := true
BOARD_HAVE_WIFI := true
USE_CAMERA_STUB := false
```

#### Example 2: x86 Device

```makefile
# BoardConfig.mk for x86 device

# Architecture
TARGET_ARCH := x86
TARGET_ARCH_VARIANT := x86_64
TARGET_CPU_VARIANT := generic
TARGET_CPU_ABI := x86_64

# Kernel
TARGET_KERNEL_ARCH := x86
TARGET_KERNEL_CONFIG := x86_64_defconfig
TARGET_KERNEL_SOURCE := kernel/x86

# Partitions
BOARD_BOOTIMAGE_PARTITION_SIZE := 67108864
BOARD_SYSTEMIMAGE_PARTITION_SIZE := 2147483648
BOARD_USERDATAIMAGE_PARTITION_SIZE := 10737418240

# Features
BOARD_HAVE_BLUETOOTH := true
BOARD_HAVE_WIFI := true
```

### BoardConfig and Build System

#### How BoardConfig is Used

**Build System Integration:**
1. Build system reads BoardConfig.mk
2. Loads hardware settings
3. Configures build tools
4. Sets up partitions
5. Configures kernel build

**Build Variables:**
- BoardConfig sets build variables
- Used throughout build process
- Affects compilation
- Controls image creation

#### BoardConfig Loading

**Loading Process:**
```makefile
# In device makefile
include device/vendor/device/BoardConfig.mk
```

**Order:**
1. Product makefile loaded
2. BoardConfig.mk loaded
3. Settings applied
4. Build configured

### Common BoardConfig Settings

#### Memory Configuration

**RAM Settings:**
```makefile
BOARD_RAMDISK_OFFSET := 0x02000000
BOARD_KERNEL_BASE := 0x80000000
BOARD_KERNEL_OFFSET := 0x00008000
```

**Memory Layout:**
- Defines memory addresses
- Kernel base address
- RAM disk location
- Device-specific

#### Storage Configuration

**File Systems:**
```makefile
TARGET_USERIMAGES_USE_EXT4 := true
TARGET_USERIMAGES_USE_F2FS := false
BOARD_SYSTEMIMAGE_FILE_SYSTEM_TYPE := ext4
```

**Storage Options:**
- ext4 (traditional)
- f2fs (flash-optimized)
- Device-specific choice
- Performance considerations

#### Security Configuration

**Verified Boot:**
```makefile
BOARD_AVB_ENABLE := true
BOARD_BUILD_DISABLED_VBMETAIMAGE := false
```

**Encryption:**
```makefile
TARGET_HW_DISK_ENCRYPTION := true
TARGET_CRYPTFS_HW_PATH := vendor/qcom/opensource/cryptfs_hw
```

### BoardConfig Best Practices

#### Organization

**Structure:**
- Group related settings
- Use comments
- Document choices
- Maintain consistency

**Comments:**
```makefile
# Architecture Configuration
TARGET_ARCH := arm64

# Kernel Configuration
TARGET_KERNEL_ARCH := arm64

# Partition Sizes (in bytes)
BOARD_BOOTIMAGE_PARTITION_SIZE := 67108864
```

#### Device-Specific Settings

**Only Device-Specific:**
- Don't duplicate common settings
- Use inheritance
- Override only what's different
- Keep it minimal

**Common Settings:**
- Put in common BoardConfig
- Inherit in device BoardConfig
- Reduce duplication
- Easier maintenance

### Debugging BoardConfig

#### Common Issues

**Wrong Architecture:**
- Mismatch between device and config
- Build failures
- Runtime issues
- Check TARGET_ARCH

**Partition Size Issues:**
- Too small partitions
- Build failures
- Image too large
- Check partition sizes

**Kernel Configuration:**
- Wrong kernel config
- Kernel build failures
- Missing features
- Check TARGET_KERNEL_CONFIG

#### Verification

**Check Settings:**
```bash
# After lunch, check variables
echo $TARGET_ARCH
echo $TARGET_KERNEL_CONFIG
echo $BOARD_BOOTIMAGE_PARTITION_SIZE
```

**Build Test:**
```bash
# Test build
m bootimage
```

### BoardConfig vs Product Config

#### Differences

**BoardConfig:**
- Hardware-specific
- Board-level settings
- Architecture, partitions
- Kernel configuration

**Product Config:**
- Software-specific
- Product-level settings
- Apps, features
- System configuration

**Relationship:**
- Both needed for device
- BoardConfig for hardware
- Product config for software
- Work together

## Key Takeaways

1. **BoardConfig is a hardware-specific configuration file** that defines board-level settings for a device.

2. **BoardConfig.mk is located** in `device/<vendor>/<device>/BoardConfig.mk` and contains hardware settings.

3. **Key settings include** architecture (TARGET_ARCH), kernel configuration, partition sizes, and hardware features.

4. **BoardConfig defines** CPU architecture, memory layout, partition sizes, and hardware capabilities.

5. **BoardConfig can inherit** from common BoardConfig files to reduce duplication and maintain consistency.

6. **BoardConfig is essential** for building Android for a device, as it tells the build system about the hardware.

7. **Common settings** include architecture, kernel config, partition sizes, display, graphics, audio, and other hardware features.

8. **Understanding BoardConfig** is essential for porting Android to new devices and customizing builds for specific hardware.

## Related Topics

- **device/ vendor/ directory structure:** Where BoardConfig files are located
- **AOSP Repo Structure:** How BoardConfig fits into the overall repo structure
- **lunch & lunch combos:** How BoardConfig is loaded during build setup
- **Build System Structure:** How BoardConfig integrates with the build system

