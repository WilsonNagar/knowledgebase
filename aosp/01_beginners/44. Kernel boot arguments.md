---
number: 44
title: Kernel boot arguments
slug: kernel-boot-arguments
level: beginner
tags:
  - aosp
  - kernel
  - boot
  - arguments
  - cmdline
  - parameters
  - bootloader
prerequisites:
  - building-the-kernel
  - bootloader-and-fastboot
  - boot-process-overview
estimated_minutes: 75
contributors: []
diagrams: []
examples: []
canonical_id: aosp-beginner-44
---

# Kernel boot arguments

## Overview

Kernel boot arguments (also called kernel command line or cmdline) are parameters passed to the kernel at boot time that control kernel behavior, configure hardware, and set system options. Understanding kernel boot arguments is essential for AOSP development, as they're used to configure the kernel, enable debugging, set hardware parameters, and control boot behavior. This guide provides a comprehensive overview of kernel boot arguments, how they're passed, common arguments, and how to use them in Android.

Think of kernel boot arguments like command-line flags for a program: just as you can pass arguments to a program when you run it (like `program --verbose --output=file.txt`), the bootloader passes arguments to the kernel when it starts (like `console=ttyMSM0,115200 androidboot.serialno=ABC123`). These arguments tell the kernel how to configure itself, what hardware to use, and how to behave during boot and runtime.

## Deep Explanation

### What are Kernel Boot Arguments?

Kernel boot arguments are strings passed to the kernel by the bootloader that configure kernel behavior, hardware settings, and system options. They're parsed by the kernel during early initialization and affect how the kernel operates.

**Key Characteristics:**
- **Early Configuration:** Set before kernel fully initializes
- **String Format:** Space-separated key=value pairs
- **Bootloader-Passed:** Provided by bootloader
- **Persistent:** Stored in boot image or device tree

**Why Boot Arguments?**
- **Configuration:** Configure kernel without recompiling
- **Hardware:** Set hardware-specific parameters
- **Debugging:** Enable debug features
- **Flexibility:** Change behavior without rebuild

### How Boot Arguments are Passed

#### Bootloader to Kernel

**ARM/ARM64 (ATAGS):**
- Legacy method (deprecated)
- Bootloader passes ATAGs structure
- Contains memory info, cmdline
- Still used on some devices

**Device Tree:**
- Modern method
- cmdline in chosen node
- Bootloader sets device tree
- Kernel reads from device tree

**Boot Image:**
- Android boot image format
- cmdline in boot image header
- Bootloader extracts and passes
- Standard Android method

#### Boot Image Format

**Android Boot Image Header:**
```
struct boot_img_hdr {
    char cmdline[BOOT_ARGS_SIZE + BOOT_EXTRA_ARGS_SIZE];
    // ... other fields
};
```

**mkbootimg Command:**
```bash
mkbootimg \
    --kernel Image \
    --ramdisk initramfs.cpio.gz \
    --cmdline "console=ttyMSM0,115200,n8 androidboot.serialno=ABC123" \
    --output boot.img
```

**Bootloader Process:**
1. Reads boot image
2. Extracts cmdline from header
3. Passes to kernel
4. Kernel parses arguments

### Boot Argument Format

#### Basic Format

**Key-Value Pairs:**
```
key=value
```

**Multiple Arguments:**
```
arg1=value1 arg2=value2 arg3=value3
```

**Boolean Arguments:**
```
# Enable feature
feature

# Disable feature (if enabled by default)
nofeature
```

**Examples:**
```
console=ttyMSM0,115200,n8
androidboot.serialno=ABC123
androidboot.mode=normal
```

#### Argument Types

**String Arguments:**
```
androidboot.serialno=ABC123
androidboot.hardware=pixel
```

**Numeric Arguments:**
```
mem=2G
maxcpus=4
```

**Boolean Arguments:**
```
quiet
verbose
debug
```

**List Arguments:**
```
androidboot.selinux=permissive,enforcing
```

### Common Kernel Boot Arguments

#### Console and Serial

**Console Configuration:**
```
console=ttyMSM0,115200,n8
```

**Parameters:**
- `ttyMSM0` - Serial device
- `115200` - Baud rate
- `n8` - No parity, 8 data bits

**Other Console Options:**
```
console=tty0          # VGA console
console=null           # No console
console=ttyS0,115200   # Serial port 0
```

#### Android-Specific Arguments

**Serial Number:**
```
androidboot.serialno=ABC123
```

**Hardware:**
```
androidboot.hardware=pixel
androidboot.hardware=sdm845
```

**Boot Mode:**
```
androidboot.mode=normal
androidboot.mode=recovery
androidboot.mode=charger
```

**SELinux:**
```
androidboot.selinux=enforcing
androidboot.selinux=permissive
androidboot.selinux=disabled
```

**Verified Boot:**
```
androidboot.verifiedbootstate=green
androidboot.verifiedbootstate=yellow
androidboot.verifiedbootstate=orange
androidboot.verifiedbootstate=red
```

#### Memory Configuration

**Memory Size:**
```
mem=2G
mem=4096M
```

**Memory Layout:**
```
memmap=64M$0x10000000
```

**CMA (Contiguous Memory Allocator):**
```
cma=64M
```

#### CPU Configuration

**CPU Count:**
```
maxcpus=4
nr_cpus=8
```

**CPU Affinity:**
```
isolcpus=2,3
```

**CPU Governor:**
```
cpufreq.default_governor=performance
```

#### Debugging Arguments

**Verbose Logging:**
```
loglevel=7
debug
verbose
```

**Early Printk:**
```
earlyprintk=serial,0x12345678,115200
```

**Kernel Debugging:**
```
kgdboc=ttyS0,115200
kgdbwait
```

**Panic Behavior:**
```
panic=10
nopanic
```

#### File System Arguments

**Root File System:**
```
root=/dev/sda1
root=PARTUUID=12345678-1234-1234-1234-123456789abc
```

**Root File System Type:**
```
rootfstype=ext4
rootfstype=f2fs
```

**Read-Only Root:**
```
ro
rw
```

#### Network Arguments

**IP Configuration:**
```
ip=192.168.1.100::192.168.1.1:255.255.255.0:hostname:eth0:off
```

**NFS Root:**
```
root=/dev/nfs nfsroot=192.168.1.1:/path/to/root
```

### Android Boot Arguments

#### Android Boot Arguments Format

**Prefix:**
- Android arguments use `androidboot.` prefix
- Parsed by Android init
- Available as system properties
- Device-specific

**Common Android Arguments:**
```
androidboot.serialno=ABC123
androidboot.hardware=pixel
androidboot.mode=normal
androidboot.selinux=enforcing
androidboot.verifiedbootstate=green
androidboot.baseband=version
androidboot.bootloader=version
androidboot.radio=version
```

#### Android Init Processing

**Property Mapping:**
- `androidboot.serialno` → `ro.serialno`
- `androidboot.hardware` → `ro.hardware`
- `androidboot.mode` → `ro.boot.mode`
- `androidboot.selinux` → `ro.boot.selinux`

**Access in Android:**
```bash
# From shell
getprop ro.serialno
getprop ro.hardware
getprop ro.boot.mode
```

**From Code:**
```java
String serial = SystemProperties.get("ro.serialno");
String hardware = SystemProperties.get("ro.hardware");
```

### Viewing Boot Arguments

#### From Running System

**Kernel Command Line:**
```bash
cat /proc/cmdline
```

**Output Example:**
```
console=ttyMSM0,115200,n8 androidboot.serialno=ABC123 androidboot.hardware=pixel androidboot.mode=normal androidboot.selinux=enforcing
```

**System Properties:**
```bash
getprop | grep boot
```

**Device Tree:**
```bash
cat /proc/device-tree/chosen/bootargs
```

#### From Boot Image

**unpackbootimg:**
```bash
unpackbootimg -i boot.img -o output/
cat output/boot.img-cmdline
```

**mkbootimg (extract):**
```bash
# Extract cmdline from boot image
abootimg -x boot.img
cat bootimg.cfg | grep cmdline
```

### Setting Boot Arguments

#### In Boot Image

**Using mkbootimg:**
```bash
mkbootimg \
    --kernel Image \
    --ramdisk initramfs.cpio.gz \
    --cmdline "console=ttyMSM0,115200,n8 androidboot.serialno=ABC123" \
    --output boot.img
```

**Modifying Existing Boot Image:**
```bash
# Extract
unpackbootimg -i boot.img -o output/

# Modify cmdline.txt
echo "new arguments here" > output/boot.img-cmdline

# Repack (requires custom script or tool)
```

#### In Device Tree

**Device Tree Source:**
```dts
chosen {
    bootargs = "console=ttyMSM0,115200,n8 androidboot.serialno=ABC123";
};
```

**Compile Device Tree:**
```bash
dtc -I dts -O dtb -o device.dtb device.dts
```

#### In Bootloader

**U-Boot:**
```bash
setenv bootargs "console=ttyMSM0,115200 androidboot.serialno=ABC123"
saveenv
boot
```

**Fastboot:**
```bash
# Boot with temporary arguments
fastboot boot -c "console=ttyMSM0,115200" boot.img
```

### Boot Argument Processing

#### Kernel Parsing

**Early Boot:**
- Kernel parses arguments early
- Before most subsystems initialized
- Sets up core configuration
- Affects initialization

**Parse Functions:**
- `parse_early_param()` - Early parameters
- `parse_args()` - Standard parameters
- `__setup()` - Setup functions

**Registration:**
```c
early_param("console", early_console_setup);
__setup("androidboot.serialno=", androidboot_serialno_setup);
```

#### Android Init Processing

**Init Processing:**
1. Reads `/proc/cmdline`
2. Parses `androidboot.*` arguments
3. Sets system properties
4. Makes available to system

**Property Names:**
- `androidboot.serialno` → `ro.serialno`
- `androidboot.hardware` → `ro.hardware`
- `androidboot.mode` → `ro.boot.mode`

### Common Use Cases

#### Debugging

**Enable Verbose Logging:**
```
loglevel=7 debug verbose
```

**Enable Early Printk:**
```
earlyprintk=serial,0x12345678,115200
```

**Kernel Debugging:**
```
kgdboc=ttyS0,115200 kgdbwait
```

#### Hardware Configuration

**Memory:**
```
mem=2G cma=64M
```

**CPU:**
```
maxcpus=4 isolcpus=2,3
```

**Console:**
```
console=ttyMSM0,115200,n8
```

#### Android Configuration

**Boot Mode:**
```
androidboot.mode=recovery
androidboot.mode=charger
```

**SELinux:**
```
androidboot.selinux=permissive
```

**Serial Number:**
```
androidboot.serialno=ABC123
```

### Boot Argument Best Practices

#### Naming Conventions

**Android Arguments:**
- Use `androidboot.` prefix
- Lowercase with dots
- Descriptive names
- Consistent format

**Standard Arguments:**
- Follow kernel conventions
- Standard names
- Well-documented
- Compatible

#### Documentation

**Document Arguments:**
- Purpose of each argument
- Valid values
- Default behavior
- Side effects

**Device-Specific:**
- Document device-specific arguments
- Explain hardware requirements
- Note compatibility

#### Testing

**Test Arguments:**
- Verify behavior
- Test edge cases
- Check compatibility
- Validate values

**Incremental Changes:**
- Change one at a time
- Test after each change
- Document results
- Keep working config

### Troubleshooting

#### Common Issues

**Arguments Not Applied:**
- Check boot image format
- Verify bootloader support
- Check device tree
- Review boot logs

**Invalid Arguments:**
- Check syntax
- Verify argument names
- Review kernel version
- Check documentation

**Arguments Overridden:**
- Check device tree
- Review bootloader
- Check init scripts
- Verify boot image

#### Debugging

**View Current Arguments:**
```bash
cat /proc/cmdline
```

**Check Properties:**
```bash
getprop | grep boot
```

**Review Boot Logs:**
```bash
dmesg | grep -i "command line"
```

**Check Device Tree:**
```bash
cat /proc/device-tree/chosen/bootargs
```

## Key Takeaways

1. **Kernel boot arguments** are parameters passed to the kernel at boot time that configure kernel behavior and hardware settings.

2. **Boot arguments are passed** by the bootloader via boot image header, device tree, or ATAGs (legacy).

3. **Argument format** is space-separated key=value pairs, with boolean arguments as single words.

4. **Android-specific arguments** use the `androidboot.` prefix and are converted to system properties by init.

5. **Common arguments include** console configuration, memory settings, Android boot mode, SELinux state, and debugging options.

6. **Boot arguments can be viewed** from `/proc/cmdline` on a running system or extracted from boot images.

7. **Boot arguments are set** in boot image creation, device tree, or bootloader configuration.

8. **Understanding boot arguments** is essential for kernel configuration, debugging, hardware setup, and AOSP development.

## Related Topics

- **Building the kernel:** How boot arguments are included in boot images
- **Bootloader and Fastboot:** How bootloader passes arguments to kernel
- **Boot Process Overview:** How boot arguments affect boot sequence
- **Building boot.img, system.img manually:** How to set cmdline when creating boot images

