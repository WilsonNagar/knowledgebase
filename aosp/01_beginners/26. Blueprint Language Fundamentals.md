---
number: 26
title: Blueprint Language Fundamentals
slug: blueprint-language-fundamentals
level: beginner
tags:
  - aosp
  - blueprint
  - soong
  - android.bp
  - build
  - syntax
  - language
prerequisites:
  - soong-build-system
  - build-system-structure
estimated_minutes: 75
contributors: []
diagrams: []
examples: []
canonical_id: aosp-beginner-26
---

# Blueprint Language Fundamentals

## Overview

Blueprint is the declarative language used in Android.bp files to describe how Android modules are built. It's a simple, readable syntax that Soong parses to generate build rules. Understanding Blueprint is essential for writing Android.bp files, creating new modules, and working with the Soong build system. This guide provides a comprehensive overview of Blueprint language syntax, data types, module definitions, and best practices.

Think of Blueprint like a construction blueprint: just as an architect's blueprint describes how to build a structure using standardized symbols and notation, Blueprint language describes how to build Android modules using standardized syntax and declarations. It's declarative (describes what, not how) and simple (easy to read and write).

## Deep Explanation

### What is Blueprint Language?

Blueprint is a simple, declarative language designed specifically for describing Android build modules. It's used in Android.bp files that Soong parses to understand what needs to be built and how.

**Key Characteristics:**
- **Declarative:** Describes what to build, not how
- **Simple Syntax:** Easy to read and write
- **Type-Safe:** Soong validates types at parse time
- **Module-Based:** Each module is a self-contained unit

**Why Blueprint?**
- **Readability:** Much simpler than Make syntax
- **Maintainability:** Easier to understand and modify
- **Type Safety:** Catches errors early
- **Tooling:** Better tool support

**Blueprint vs Other Languages:**
- **Not a programming language:** No control flow, just declarations
- **Not JSON:** More flexible than JSON
- **Not YAML:** Simpler than YAML
- **Purpose-built:** Designed specifically for builds

### Blueprint Syntax Basics

#### Comments

**Single-line Comments:**
```blueprint
// This is a comment
cc_library {
    name: "mylib",
}
```

**Multi-line Comments:**
```blueprint
/*
 * This is a
 * multi-line comment
 */
```

#### Module Definitions

**Basic Structure:**
```blueprint
module_type {
    property1: "value1",
    property2: ["value2", "value3"],
    property3: true,
}
```

**Key Elements:**
- **Module Type:** `cc_library`, `android_app`, etc.
- **Properties:** Name-value pairs
- **Commas:** Separate properties (trailing comma optional)
- **Braces:** Enclose module definition

#### Property Syntax

**String Properties:**
```blueprint
name: "mylib",
```

**List Properties:**
```blueprint
srcs: ["file1.c", "file2.c"],
```

**Boolean Properties:**
```blueprint
vendor: true,
```

**Nested Modules:**
```blueprint
submodules: [
    {
        name: "sub1",
    },
    {
        name: "sub2",
    },
],
```

### Data Types

#### Strings

**Basic Strings:**
```blueprint
name: "mylib",
```

**String Lists:**
```blueprint
srcs: ["file1.c", "file2.c", "file3.c"],
```

**String Concatenation:**
```blueprint
// Not directly supported, use lists or variables
```

**String Variables:**
```blueprint
// Use in property values
name: "lib" + "mylib",  // Not valid syntax
// Use string literals directly
```

#### Booleans

**Boolean Values:**
```blueprint
vendor: true,
proprietary: false,
```

**Boolean Usage:**
- Enable/disable features
- Mark module properties
- Control build behavior

#### Lists

**List Syntax:**
```blueprint
srcs: [
    "file1.c",
    "file2.c",
    "file3.c",
],
```

**List Operations:**
- Append items
- Concatenate lists
- Filter lists (in some contexts)

**Empty Lists:**
```blueprint
srcs: [],
```

#### Maps (Objects)

**Map Syntax:**
```blueprint
properties: {
    key1: "value1",
    key2: "value2",
},
```

**Map Usage:**
- Nested configurations
- Complex properties
- Module-specific settings

### Module Types Overview

#### C/C++ Modules

**cc_library:**
```blueprint
cc_library {
    name: "mylib",
    srcs: ["file.c"],
}
```

**cc_binary:**
```blueprint
cc_binary {
    name: "mytool",
    srcs: ["main.c"],
}
```

#### Java Modules

**java_library:**
```blueprint
java_library {
    name: "mylib",
    srcs: ["file.java"],
}
```

**android_app:**
```blueprint
android_app {
    name: "MyApp",
    srcs: ["src/**/*.java"],
}
```

#### Other Module Types

**filegroup:**
```blueprint
filegroup {
    name: "myfiles",
    srcs: ["file1.txt", "file2.txt"],
}
```

**genrule:**
```blueprint
genrule {
    name: "generate",
    cmd: "command to run",
    out: ["output.file"],
}
```

### Common Properties

#### Source Files

**srcs:**
```blueprint
srcs: [
    "file1.c",
    "file2.c",
    "subdir/file3.c",
],
```

**Glob Patterns:**
```blueprint
srcs: ["src/**/*.java"],  // All Java files in src/
```

**Exclude Sources:**
```blueprint
exclude_srcs: ["file_to_exclude.c"],
```

#### Dependencies

**Shared Libraries:**
```blueprint
shared_libs: [
    "liblog",
    "libutils",
],
```

**Static Libraries:**
```blueprint
static_libs: [
    "libmystatic",
],
```

**Header Libraries:**
```blueprint
header_libs: [
    "libheaders",
],
```

**Whole Static Libraries:**
```blueprint
whole_static_libs: [
    "libwhole",
],
```

#### Compilation Flags

**C Flags:**
```blueprint
cflags: [
    "-Wall",
    "-Werror",
    "-O2",
],
```

**C++ Flags:**
```blueprint
cppflags: [
    "-std=c++11",
    "-fno-exceptions",
],
```

**Linker Flags:**
```blueprint
ldflags: [
    "-L/path/to/lib",
    "-lmylib",
],
```

#### Include Directories

**Include Dirs:**
```blueprint
include_dirs: [
    "include",
    "src",
],
```

**Export Include Dirs:**
```blueprint
export_include_dirs: [
    "include",  // Dependents can use these
],
```

### Module Visibility

#### Visibility Rules

**Default Visibility:**
```blueprint
// Module is visible to same directory and subdirectories
cc_library {
    name: "mylib",
}
```

**Public Visibility:**
```blueprint
cc_library {
    name: "mylib",
    visibility: [":__subpackages__"],  // All subpackages
}
```

**Specific Visibility:**
```blueprint
cc_library {
    name: "mylib",
    visibility: [
        "//packages/apps/MyApp",
        "//frameworks/base",
    ],
}
```

**Private Visibility:**
```blueprint
cc_library {
    name: "mylib",
    visibility: [":__subpackages__"],  // Only subpackages
}
```

### Variable References

#### Using Variables

**Property References:**
```blueprint
// Not directly supported in Blueprint
// Use string literals or module references
```

**Module References:**
```blueprint
// Reference other modules by name
shared_libs: ["libmylib"],  // References module named "libmylib"
```

### Conditional Properties

#### Variant-Specific Properties

**Architecture-Specific:**
```blueprint
cc_library {
    name: "mylib",
    srcs: ["common.c"],
    arch: {
        arm: {
            srcs: ["arm.c"],
        },
        x86: {
            srcs: ["x86.c"],
        },
    },
}
```

**Target-Specific:**
```blueprint
cc_library {
    name: "mylib",
    target: {
        android: {
            srcs: ["android.c"],
        },
        host: {
            srcs: ["host.c"],
        },
    },
}
```

### Advanced Features

#### File Groups

**Defining File Groups:**
```blueprint
filegroup {
    name: "myheaders",
    srcs: [
        "header1.h",
        "header2.h",
    ],
}
```

**Using File Groups:**
```blueprint
cc_library {
    name: "mylib",
    export_include_dirs: [":myheaders"],
}
```

#### Generated Sources

**Genrule:**
```blueprint
genrule {
    name: "generate_header",
    cmd: "echo '#define VERSION 1' > $(out)",
    out: ["version.h"],
}

cc_library {
    name: "mylib",
    generated_headers: [":generate_header"],
    srcs: ["file.c"],
}
```

#### Prebuilt Modules

**Prebuilt Library:**
```blueprint
cc_prebuilt_library {
    name: "libprebuilt",
    srcs: ["libprebuilt.so"],
    export_include_dirs: ["include"],
}
```

### Blueprint Best Practices

#### Code Organization

**File Structure:**
- One Android.bp per directory (usually)
- Group related modules
- Use clear naming
- Organize logically

**Module Naming:**
- Use descriptive names
- Follow conventions
- Avoid conflicts
- Be consistent

#### Property Organization

**Ordering:**
- `name` first (required)
- Then `srcs`
- Then dependencies
- Then flags
- Then other properties

**Example:**
```blueprint
cc_library {
    name: "mylib",
    srcs: ["file.c"],
    shared_libs: ["liblog"],
    cflags: ["-Wall"],
    visibility: [":__subpackages__"],
}
```

#### Dependency Management

**Best Practices:**
- Declare all dependencies
- Use correct types
- Avoid circular dependencies
- Keep minimal

**Common Patterns:**
```blueprint
cc_library {
    name: "mylib",
    shared_libs: ["liblog"],      // Runtime dependency
    static_libs: ["libstatic"],    // Link-time dependency
    header_libs: ["libheaders"],   // Header-only dependency
}
```

### Common Patterns

#### Library with Headers

```blueprint
cc_library {
    name: "mylib",
    srcs: ["src/**/*.cpp"],
    include_dirs: ["include"],
    export_include_dirs: ["include"],  // Export to dependents
    shared_libs: ["liblog"],
}
```

#### App with Resources

```blueprint
android_app {
    name: "MyApp",
    srcs: ["src/**/*.java"],
    resource_dirs: ["res"],
    manifest: "AndroidManifest.xml",
    static_libs: ["android-support-v4"],
}
```

#### Executable Tool

```blueprint
cc_binary {
    name: "mytool",
    srcs: ["main.c", "utils.c"],
    shared_libs: ["liblog", "libcutils"],
    cflags: ["-Wall"],
}
```

### Error Handling

#### Common Errors

**Syntax Errors:**
```blueprint
// Missing comma
cc_library {
    name: "mylib"
    srcs: ["file.c"],  // Error: missing comma
}
```

**Type Errors:**
```blueprint
// Wrong type
cc_library {
    name: ["mylib"],  // Error: name should be string, not list
}
```

**Missing Properties:**
```blueprint
// Missing required property
cc_library {
    srcs: ["file.c"],  // Error: name is required
}
```

#### Error Messages

**Soong provides:**
- Clear error messages
- File and line numbers
- Property name in error
- Suggested fixes

### Blueprint vs Android.mk

#### Syntax Comparison

**Android.mk:**
```makefile
LOCAL_PATH := $(call my-dir)
include $(CLEAR_VARS)
LOCAL_MODULE := mylib
LOCAL_SRC_FILES := file1.c file2.c
include $(BUILD_SHARED_LIBRARY)
```

**Android.bp (Blueprint):**
```blueprint
cc_library {
    name: "mylib",
    srcs: ["file1.c", "file2.c"],
}
```

**Blueprint Advantages:**
- Simpler syntax
- More readable
- Less boilerplate
- Type-safe

### Migration from Android.mk

#### Conversion Steps

**1. Identify Module Type:**
- `BUILD_SHARED_LIBRARY` → `cc_library`
- `BUILD_STATIC_LIBRARY` → `cc_library_static`
- `BUILD_EXECUTABLE` → `cc_binary`
- `BUILD_PACKAGE` → `android_app`

**2. Convert Properties:**
- `LOCAL_MODULE` → `name`
- `LOCAL_SRC_FILES` → `srcs`
- `LOCAL_SHARED_LIBRARIES` → `shared_libs`
- `LOCAL_STATIC_LIBRARIES` → `static_libs`

**3. Test Build:**
- Build with Soong
- Verify output
- Check dependencies
- Test functionality

### Blueprint Language Reference

#### Reserved Words

**Module Types:**
- `cc_library`, `cc_binary`, `java_library`, `android_app`, etc.

**Property Names:**
- `name`, `srcs`, `dependencies`, `visibility`, etc.

**Special Values:**
- `true`, `false`
- `__subpackages__`

#### Operators

**Assignment:**
```blueprint
property: "value",
```

**List:**
```blueprint
property: ["value1", "value2"],
```

**Map:**
```blueprint
property: {
    key: "value",
},
```

## Key Takeaways

1. **Blueprint is a simple, declarative language** used in Android.bp files to describe Android build modules.

2. **Blueprint syntax is straightforward** with modules, properties, and values, making it easy to read and write.

3. **Blueprint supports multiple data types** including strings, lists, booleans, and maps for flexible module definitions.

4. **Module types define what to build** (library, binary, app) while properties define how to build it.

5. **Blueprint provides type safety** with Soong validating types at parse time, catching errors early.

6. **Common properties** like `srcs`, `dependencies`, and `flags` are used across many module types.

7. **Visibility rules** control who can use modules, providing access control and encapsulation.

8. **Understanding Blueprint** is essential for writing Android.bp files and working with the Soong build system.

## Related Topics

- **Soong Build System:** The build system that parses Blueprint files
- **Understanding Android.bp Files:** Practical guide to writing Android.bp files
- **Build System Structure:** The overall build system architecture
- **Make-Based Build System:** The legacy system that Blueprint is replacing

